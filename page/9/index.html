<!DOCTYPE html>
<html lang="zh-cn">
<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="leek" />


    
     
        <meta name="google-site-verification" content="Vl02j4hnvtN2AJ3EfPjyvrHb191mbrnVtUlHgPUKBp0" />
    


<meta property="og:type" content="website">
<meta property="og:title" content="leek 自留地">
<meta property="og:url" content="https://imlike.cc/page/9/index.html">
<meta property="og:site_name" content="leek 自留地">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="leek">
<meta name="twitter:card" content="summary">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="leek 自留地" type="application/atom+xml">



    <link rel="shortcut icon" href="pics/g.jpg">



    <link href="//lf6-cdn-tos.bytecdntp.com/cdn/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//lf6-cdn-tos.bytecdntp.com/cdn/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//lf6-cdn-tos.bytecdntp.com/cdn/pace/1.0.2/pace.min.js"></script>
    <link href="//lf6-cdn-tos.bytecdntp.com/cdn/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">



    <!-- 注释 -->
    <!-- <style> .article { opacity: 0;} </style> -->


<link href="//lf6-cdn-tos.bytecdntp.com/cdn/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>leek 自留地</title>

<script src="//lf6-cdn-tos.bytecdntp.com/cdn/jquery/2.2.4/jquery.min.js"></script>
<script src="//lf6-cdn-tos.bytecdntp.com/cdn/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//lf6-cdn-tos.bytecdntp.com/cdn/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//lf6-cdn-tos.bytecdntp.com/cdn/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 5.2.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="https://pic.superbed.cn/item/5c9f2d213a213b04176522d4" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="true" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:s@yandex.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" rel="noopener" href="https://github.com/bigleek" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Google" target="_blank" rel="noopener" href="https://plus.google.com/bigleekcode" title="Google"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yelee/" rel="tag">Yelee</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yilia/" rel="tag">Yilia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/activiti/" rel="tag">activiti</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/alist/" rel="tag">alist</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/axios/" rel="tag">axios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/binary/" rel="tag">binary</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ceph/" rel="tag">ceph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/clickhouse/" rel="tag">clickhouse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloud/" rel="tag">cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/container/" rel="tag">container</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deepin/" rel="tag">deepin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/" rel="tag">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsraech/" rel="tag">elasticsraech</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es6/" rel="tag">es6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flyio/" rel="tag">flyio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gdal/" rel="tag">gdal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gnome/" rel="tag">gnome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo%E4%B8%BB%E9%A2%98/" rel="tag">hexo主题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/intellj/" rel="tag">intellj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdk/" rel="tag">jdk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jenkins/" rel="tag">jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kibana/" rel="tag">kibana</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kubernetes/" rel="tag">kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kuboard/" rel="tag">kuboard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nas/" rel="tag">nas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/no-ad/" rel="tag">no_ad</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/" rel="tag">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/onedrive/" rel="tag">onedrive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orientDb/" rel="tag">orientDb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/post/" rel="tag">post</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postgres/" rel="tag">postgres</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/put/" rel="tag">put</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/repost/" rel="tag">repost</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spotify/" rel="tag">spotify</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/" rel="tag">springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springcloud/" rel="tag">springcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sublime/" rel="tag">sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thunderbolt/" rel="tag">thunderbolt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vmware/" rel="tag">vmware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vpn/" rel="tag">vpn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue-cli/" rel="tag">vue-cli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webdav/" rel="tag">webdav</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wine/" rel="tag">wine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yandex/" rel="tag">yandex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zsh/" rel="tag">zsh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E6%92%AD/" rel="tag">云播</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" rel="tag">内网穿透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A0%E9%80%9F/" rel="tag">加速</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9D%9A%E6%9E%9C%E4%BA%91/" rel="tag">坚果云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%9F%E5%90%8D/" rel="tag">域名</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A9%E7%BF%BC%E4%BA%91/" rel="tag">天翼云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91/" rel="tag">开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%A8%E8%8D%90/" rel="tag">推荐</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%90%9C%E7%8B%97%E8%BE%93%E5%85%A5%E6%B3%95/" rel="tag">搜狗输入法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%90%AC%E5%AE%B6/" rel="tag">搬家</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" rel="tag">树莓派</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86/" rel="tag">知识管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%AB%99/" rel="tag">网站</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/" rel="tag">腾讯云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%86%E9%A2%91%E6%B5%81/" rel="tag">视频流</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B5%84%E6%BA%90/" rel="tag">资源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag">转载</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6/" rel="tag">软件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6%E9%85%8D%E7%BD%AE/" rel="tag">软件配置</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1/" rel="tag">邮件服务</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://imlike.cc/page.html">镜像网站导航</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://imcyc.cn/">Morty</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">平时零散的知识</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="https://pic.superbed.cn/item/5c9f2d213a213b04176522d4" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:s@yandex.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/bigleek" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Google" target="_blank" href="https://plus.google.com/bigleekcode" title="Google"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-http-rpc的区别和介绍" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/224b9f31.html" class="article-date">
      <time datetime="2022-06-30T06:39:45.000Z" itemprop="datePublished">2022-06-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/224b9f31.html">http-rpc的区别和介绍</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>参考内容 <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/41609070/answer/1030913797">既然有 HTTP 请求，为什么还要用 RPC 调用？ - 知乎</a></p>
<h2 id="http介绍"><a href="#http介绍" class="headerlink" title="http介绍"></a>http介绍</h2><p>​        说到http 其实开发过接口的都很少熟悉，目前最流行的是HTTPS，其实无论是OSI的<del>5层</del>七层还是TCP/IP五层模型，http都是属于上层封装偏向于应用的部分，主要是浏览器和一些客户端通信用的协议，通常请求会有特定请求头而且是长连接，占用服务器的连接资源，</p>
<p>​        通常情况下浏览器会存储cookie 在服务端会存储session来确定连接的情况，如果是restful风格的http请求是无状态的，服务器是不知道这次请求的数据。</p>
<p>
                              
                          
                    
              <!-- 
              
              <p>参考内容 <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/41609070/answer/1030913797">既然有 HTTP 请求，为什么还要用 RPC 调用？ - 知乎</a></p>
<h2 id="http介绍"><a href="#http介绍" class="headerlink" title="http介绍"></a>http介绍</h2><p>​        说到http 其实开发过接口的都很少熟悉，目前最流行的是HTTPS，其实无论是OSI的<del>5层</del>七层还是TCP/IP五层模型，http都是属于上层封装偏向于应用的部分，主要是浏览器和一些客户端通信用的协议，通常请求会有特定请求头而且是长连接，占用服务器的连接资源，</p>
<p>​        通常情况下浏览器会存储cookie 在服务端会存储session来确定连接的情况，如果是restful风格的http请求是无状态的，服务器是不知道这次请求的数据。</p>
<p>下面是附带的7层协议</p>
<p>第一层 物理层  网卡 网口</p>
<p>第二层  数据链路层 网关交换器</p>
<p>第三层 网络层  </p>
<p>第四层 传输层 tcp,udp</p>
<p>第五层 会话层  dns.smtp</p>
<p>第六层表示层 telnet,snmp</p>
<p>第七层 应用层 http,rtsp,imap</p>
<p>上面是我大脑能列出来的第一反应</p>
<p>​        对于HTTPS是结合了http+<strong>SSL/TLS</strong>的混合，传统的http是明文传输的在互联网中网关和每个转发节点都能知道里面的内容，但是如果在http上包裹一层ssl那么传输者只知道传给谁但是具体的内容是不清楚的，ssl的非对称加密的，网站的拥有方需要去申请免费提供的let entry ，发送的证书是分别为公钥和私钥，他们拿私钥加密，我们客户端拿到数据用公钥解析内容，同时需要注意</p>
<p>具体的内容在网上搜索具体的介绍</p>
<p>RPC介绍</p>
<p>​        为什么会需要rpc，主要是服务的解耦，当整个系统越来越复杂后处于维护和迭代的需要，通常会将服务组件拆分，单独提供，譬如单独的订单服务，查询服务，认证服务，搜索服务等，但是当一个请求需要涉及到几个服务的功能的时候就会遇到 A服务 需要B服务，C服务的数据或者行动后A服务才能执行后续内容。</p>
<p>​        此时需要RPC来调用别人的服务服务，这个过程同时还设计到分布式事务，我们目前只考虑数据的使用，但是在调用过程中由于不同语言，和调用方能是接受的语法等限制通常需要跨平台的库来实现比较有名的是 <a target="_blank" rel="noopener" href="https://dubbo.apache.org/zh/blog/2019/01/07/%E6%B5%85%E8%B0%88-rpc/">浅谈 RPC | Apache Dubbo</a>,<a target="_blank" rel="noopener" href="https://grpc.io/">gRPC</a> 等来实现。</p>
<p>​        </p>
<p><img src="https://segmentfault.com/img/remote/1460000037470064" alt="img"></p>
<p>对应目前</p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-浅谈文件传输共享协议(转载)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/bce5fd0b.html" class="article-date">
      <time datetime="2022-06-16T11:20:54.000Z" itemprop="datePublished">2022-06-16</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/bce5fd0b.html">浅谈文件传输/共享协议(转载)</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p><a target="_blank" rel="noopener" href="https://hellodk.cn/post/1051">浅谈文件传输/共享协议｜内网共享文件协议选择｜自建公网文件管理同步和共享方案推荐 - Allen Hua 的网络博客</a></p>
<h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h2><p>关于文件传输协议/文件共享协议，可以拿出来介绍的可以有很多，本文列举了一些通用的基础的发展较早的协议详细的介绍（当然了，没有深入的原理，咱也不会啊 :笑），一些较新的作了简单陈述，没有深究原理和实现。</p>
<p>本文主要分为三个部分</p>
<p>
                              
                          
                    
              <!-- 
              
              <p><a target="_blank" rel="noopener" href="https://hellodk.cn/post/1051">浅谈文件传输/共享协议｜内网共享文件协议选择｜自建公网文件管理同步和共享方案推荐 - Allen Hua 的网络博客</a></p>
<h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h2><p>关于文件传输协议/文件共享协议，可以拿出来介绍的可以有很多，本文列举了一些通用的基础的发展较早的协议详细的介绍（当然了，没有深入的原理，咱也不会啊 :笑），一些较新的作了简单陈述，没有深究原理和实现。</p>
<p>本文主要分为三个部分</p>
<ol>
<li>基础的文件传输/共享协议，更加推荐在内网使用的，不允许也不推荐暴露到公网。使用建议 <a target="_blank" rel="noopener" href="https://hellodk.cn/post/1051#cl-21">点我</a></li>
<li>个人公网文件管理方案</li>
<li>实践: 在内网自建一个 seafile server, 并通过 frp 暴露在公网 serving，实现内外网都可以上传、下载、同步、分享。如何食用？<a target="_blank" rel="noopener" href="https://hellodk.cn/post/1051#cl-23">点我</a></li>
</ol>
<h2 id="2-总览"><a href="#2-总览" class="headerlink" title="2. 总览"></a>2. 总览</h2><ol>
<li>SMB/CIFS/SAMBA</li>
<li>FTP/FTPS/TFTP</li>
<li>SCP/SFTP</li>
<li>WebDAV/WebDAVS</li>
<li>NFS</li>
<li>DLNA+UPnP</li>
<li>HTTP/HTTPS</li>
<li>rsync</li>
<li>AFP</li>
<li>MTP</li>
<li>others (列举了一些非常规的协议)</li>
</ol>
<hr>
<h2 id="3-正片"><a href="#3-正片" class="headerlink" title="3. 正片"></a>3. 正片</h2><h3 id="3-1-SMB-CIFS-SAMBA"><a href="#3-1-SMB-CIFS-SAMBA" class="headerlink" title="3.1 SMB/CIFS/SAMBA"></a>3.1 SMB/CIFS/SAMBA</h3><p>SMB(Server Message Block) 通信协议是微软和英特尔在 1987 年制定的协议，主要是作为 Microsoft 网络的通讯协议，它是当今世上网络文件系统协议两极之一的存在。</p>
<p>SMB 使用了 NetBIOS 的 API。另外，它是一个开放性的协议，允许了协议扩展，这使得它可以变得更大而且复杂；大约有 65 个最上层的作业，而每个作业都超过 120 个函数，甚至 Windows NT 自己也没有全部支持到，后来<del>著名的微软改名部门</del>又把 SMB 重新设计了一套新的实现: CIFS(Common Internet File System) 协议，并且加入了许多新的特色功能。</p>
<p>一开始微软设计的 SMB 不支持在 Linux 上运行，著名黑客、技术大牛安德鲁·垂鸠 (Andrew Tridgell) 通过逆向工程，于 1992 年在澳洲国立大学（ANU）开发了第一版的 Samba Unix 软件，实现了 SMB/CIFS 兼容协议，并命名为 <code>Samba</code>，通过该程序实现了 Windows 和 Linux 之间的文件共享。 Debian 上的软件包名称就是 <code>samba</code>，OpenWrt 中一般有 <code>samba36-server</code> 和 <code>samba4-server</code> (版本 4，性能更强，更新的一个版本)。</p>
<p>SMB 是 C/S (Client and Server) 类型协议，客户机可以访问服务器上的共享文件系统、打印机及其他资源。更进阶一点，通过设置 “NetBIOS over TCP/IP”，Samba 不但能与局域网络主机分享资源，还能与全世界的电脑分享资源，但一般很少这样使用。</p>
<p>SMB 的优点之一是兼容性特别好，在各平台都获得了广泛支持，包括 Windows、Linux、macOS、Android、iOS、iPadOS，甚至一些嵌入式系统比如 OpenWrt，挂载访问都很方便。另外 SMB 也是各种电视、电视盒子默认支持的协议，这些电视和盒子通过 SMB 访问服务器端的资源可以达到播放电影、音乐、访问图片和预览普通文件的目的。</p>
<p>另外 SMB 提供端到端加密、安全性高，配置选项丰富，支持 ACL(Access Control List) 并支持多种用户认证方式。</p>
<p>不过 SMB 的缺点也是最令极客们诟病的，是传输效率稍低，速度不太稳定，受机器网络和硬件资源波动较大。</p>
<p>简而言之，SMB 协议是在局域网上用于服务器文件访问和打印的协议。CIFS 可以看做是应用程序协议如文件传输协议和超文本传输协议的一个实现。</p>
<p>关于传输端口， SMB/CIFS 传输端口是 139 或 445，具体是 TCP port 139 over NetBIOS，TCP port 445 over IP。TCP 445 是基于 IP 的 SMB，这是较新的版本，可以在 IP 网络上正常使用 SMB，也就是公网使用 SMB。</p>
<p><em>ps: samba 最新稳定版是 version 4.x.x</em></p>
<h3 id="3-2-FTP-TFTP-FTPS"><a href="#3-2-FTP-TFTP-FTPS" class="headerlink" title="3.2 FTP/TFTP/FTPS"></a>3.2 FTP/TFTP/FTPS</h3><p>FTP(File Transfer Protocol) 我们都很熟悉，它是 TCP/IP 协议簇中的一员，是 1971 年发展起来的文件传输协议，作为标准网络协议出现它包含两个部分实现，一个是 FTP Server，一个是 FTP Client，其中 Server 用来存储文件，Client 供客户机使用以访问远程资源。</p>
<p>现在暴露在公网的 FTP 站点已经越来越少，找了半天只发现 GNU 的 FTP 站点 <a href="ftp://ftp.gnu.org/">ftp://ftp.gnu.org/</a> 目前还能匿名访问。Windows 可在 <code>Windows Explorer</code> 的 address bar 上直接键入地址然后回车即可以匿名身份访问。</p>
<p>默认情况下，FTP 使用 TCP 20 和 TCP 21 两个端口传输数据，TCP 20 用于数据传输，TCP 21 用于控制信息传输。而是否使用 20 端口传输数据与 FTP 传输模式有关，如果 FTP 主动模式，那么数据传输端口就是 20，如果采用的被动模式，那最终传输数据的端口由 FTP 的服务器和客户机协商决定。</p>
<p><strong>FTP 的两种数据传输模式: Standard(主动) 和 Passive(被动)。</strong></p>
<ol>
<li><p>Standard 模式</p>
<p>FTP 客户端首先和服务器的 TCP 21 建立连接并发送指令，客户端需要接收数据的时候在这个通道上发送 PORT 命令。 PORT 命令包含了客户端用什么端口接收数据。在传输数据的时候，服务器通过自己的 TCP 20 连接到客户端的指定端口发送数据。FTP Server 必须和 Client 建立一个新的连接用来传输数据。</p>
</li>
<li><p>Passive 模式</p>
<p>建立控制通道和 Standard 模式类似，但建立连接后发送的是 PASV 命令，服务端收到 PASV 命令后打开一个临时端口 tempPort (<code>1023 &lt; tempPort &lt; 65535</code>) 并且通知客户端在这个端口上传送数据，客户端连接 FTP 服务端的此端口，然后服务端将会通过此端口 serving.</p>
<p>很多防火墙在设置的时候都是不允许接受外部发起的连接的，所以许多位于防火墙后或内网的 FTP 服务器不支持 Passive 模式，因为客户端无法穿过防火墙打开 FTP 服务器的高端端口；而许多内网的客户端不能用 Standard 模式登陆 FTP 服务器，因为从服务器的 TCP 20 无法和内部网络的客户端建立一个新的连接，造成无法工作。</p>
</li>
</ol>
<p><strong>FTP 传输数据也有两种方式：ASCII 和 二进制。</strong></p>
<ol>
<li><p>ASCII 传输方式</p>
<p>假定用户正在拷贝的文件包含的简单 ASCII 码文本(plain text)，如果在远程机器上运行的不是 UNIX，当文件传输时 FTP 通常会自动地调整文件的内容以便于把文件解释成另外那台计算机存储文本文件的格式。</p>
<p>但是常常有一些“特殊”情况，用户正在传输的文件包含的不是文本文件，它们可能是可执行程序、电影、音乐、数据库或者压缩文件。在拷贝任何非文本文件之前，用 binary 命令告诉 FTP 逐字拷贝。</p>
</li>
<li><p>二进制传输方式</p>
<p>在二进制传输中，保存文件的位序，以便原始和拷贝的是逐位一一对应的。即使目的机器上包含位序列的文件是没意义的。例如，macintosh (早期的 macOS 叫法) 以二进制方式传送可执行文件到 Windows 系统，在对方系统上，此文件不能执行。</p>
</li>
</ol>
<p>时间已经来到了 2022 年，FTP 已经很少被应用在生产环境下，通过 http 传输文件的高效更能替代这个使用场景。它的优点不足以掩盖众多缺点，优点比如说能同时传输多个目录，自动备份等等，但是缺点众多，其他协议也支持它的优点，所以必然会被时代淘汰。</p>
<p>FTP 的缺点：数据传输模式不够合理，工作方式设计不合理，与防火墙工作不协调，安全认证策略不完善，相对而言整个传输过程效率也低下。此部分就不展开了，详情可见下面文章</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/ixidof/article/details/8119017">文件传输协议（FTP）的缺点</a></li>
<li><a target="_blank" rel="noopener" href="https://content.jianguoyun.com/28197.html">FTP文件传输的优势与不足对比分析</a></li>
</ul>
<p>通过上面的描述，可以感受到 FTP 的复杂性，1981 年在 RFC 783 中定义了一个简化的文件传输协议 TFTP(Trivial File Transfer Protocol)，称作简单文件传输协议，也称小型/琐碎文件传输协议。TFTP 比 FTP 简单得多，并且执行客户端和服务器进程之间的文件传输。但是，它不提供 FTP 所支持的用户身份验证和其他有用的功能。FTP 使用 TCP 时，TFTP 使用 UDP，这使得它成为了不可靠的文件传输协议。由于简单，透过少量存储器就能轻松实现，在计算机发展早期还是有用处的，例如从一台网络主机或服务器引导一个远程 X Window System 终端或其他的瘦客户端。由于小型文件传输协议缺少安全性，在公网传输非常危险，所以普遍仅仅用于私有网络。</p>
<p>对于 FTP 在安全上的不足，后面发展了 FTPS。</p>
<p>FTPS(FTP over SSL/TLS)，是一种安全的 FTP，添加了传输层安全（TLS）和安全套接层（SSL）的加密协议。尽管在数据传输方面加固了安全，但 FTP 的底层设计依然还是没有改变，所以直到现在应用也不够广泛。偶尔在内网中会有部署的 FTP 服务，但大家也更倾向于使用 samba, nfs, http, webdav 这些协议共享文件。</p>
<h3 id="3-3-SCP-SFTP"><a href="#3-3-SCP-SFTP" class="headerlink" title="3.3 SCP/SFTP"></a>3.3 SCP/SFTP</h3><p>SCP(Secure CoPy) 和 SFTP(Secure File Transfer Protocol) 都基于 SSH(Secure SHell) 协议，OpenSSH 是 SSH 协议的一个开源实现，一些嵌入式设备可以通过 dropbear 建立 ssh 连接，dropbear 也实现了 SSH 协议的基础功能。</p>
<p>SCP 用来进行远程文件复制，并且整个复制过程是加密的。数据传输使用 ssh tunnel，并且使用和 ssh 相同的认证方式，提供相同的安全保证。密码认证或密钥对 (key-pair)验证。</p>
<p>SFTP 与 FTP 有着几乎一样的语法和功能。SFTP 为 SSH 的一部分，是一种传输文件到服务器的安全方式。在 SSH 软件包中，已经包含了一个叫作 SFTP 的安全文件传输子系统，SFTP 本身没有单独的守护进程，它必须使用 sshd 守护进程（端口号默认是22）来完成相应的连接操作，所以从某种意义上来说，SFTP 并不像一个服务器程序，而更像是一个客户端程序。SFTP 同样是使用加密传输认证信息和传输的数据，所以，使用 SFTP 是安全的。但是，正由于这种传输方式使用了加密/解密技术，所以比起普通 FTP，开销大得多，传输效率低得多。如果用户对网络安全性要求更高，则可以使用 SFTP 代替 FTP。</p>
<p>目前最新的 OpenSSH 稳定版本是 9.0，<a target="_blank" rel="noopener" href="https://www.openssh.com/">OpenSSH 9.0 released April 8, 2022</a>，服务端配置文件 <code>/etc/ssh/sshd_config</code> 中有一行 sftp 配置就是配置这个文件传输子系统的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># override default of no subsystems</span><br><span class="line">Subsystem       sftp    &#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;sftp-server</span><br></pre></td></tr></table></figure>

<h4 id="SCP-和-SFTP-的比较"><a href="#SCP-和-SFTP-的比较" class="headerlink" title="SCP 和 SFTP 的比较"></a>SCP 和 SFTP 的比较</h4><p>两者都基于 SSH，但是传输效率和安全性上也有区别。</p>
<ul>
<li>SCP 不支持断点续传，一次 timeout 就得重来，而 SFTP 支持</li>
<li>SCP 单次传输不支持 4Gib 以上文件，SFTP 支持</li>
<li>SCP 不检查传输的数据包，效率更高但安全性更低</li>
</ul>
<p><strong>简单总结：SCP 适合小文件传输，速度更快。SFTP 适合更大文件，安全性更高的传输场景。</strong></p>
<p>另外上文所述的 FTPS 不应与基于 SSH 的 SCP 和 SFTP 混淆。</p>
<p>Windows 端经典强大的开源程序 <code>WinSCP</code> 就实现了 SSH 的 SCP 和 SFTP 功能，界面直观非常易于使用。</p>
<h3 id="3-4-WebDAV-WebDAVS"><a href="#3-4-WebDAV-WebDAVS" class="headerlink" title="3.4 WebDAV/WebDAVS"></a>3.4 WebDAV/WebDAVS</h3><p>WebDAV(WEb-Based Distributed Authoring and Versioning) 一种基于 HTTP 1.1 协议的通信协议。它扩展了 HTTP 1.1，在 GET、POST、HEAD、PUT、DELETE、PATCH 等 HTTP 标准方法以外添加了一些新的方法，使应用程序可对 Web Server 直接读写，并支持写文件锁定 (Locking) 及解锁 (Unlock)，还支持文件的版本控制。</p>
<p>简单而言，WebDAV 就是在服务器上划出一块存储空间，使用它扩展的一套 HTTP method 来管理文件，可以将磁盘映射到本地磁盘使用，对文件的每次改动都是一个 HTTP 请求。遗憾的是，目前只有用户名和密码的认证方式，安全性上有所欠缺。</p>
<p>WebDAV 为实现远程文件管理，向 HTTP/1.1 中追加了以下这些方法</p>
<ul>
<li>PROPFIND：获取属性</li>
<li>PROPPATCH：修改属性</li>
<li>MKCOL：创建集合</li>
<li>COPY：复制资源及属性</li>
<li>MOVE：移动资源</li>
<li>LOCK：资源加锁</li>
<li>UNLOCK：资源解锁</li>
</ul>
<p>HTTP status code 也随之扩展</p>
<ul>
<li>102 Processing：可正常处理请求， 但目前是处理中状态</li>
<li>207 Multi-Status：存在多种状态</li>
<li>422 Unprocessible Entity：格式正确， 内容有误</li>
<li>423 Locked：资源已被加锁</li>
<li>424 Failed Dependency：处理与某请求关联的请求失败， 因此不再维持依赖关系</li>
<li>507 Insufficient Storage：保存空间不足</li>
</ul>
<p>由于 WebDAV 是基于 HTTP 的，所以具有 HTTP 的所有优点，包括容易穿越防火墙、使用 HTTPS 来传输数据，因此在很多方面可以替代 FTP。通过 Nginx 或 Apache 或 Caddy 等 web server（也有其他实现，比如 Golang 实现的 webdav <a target="_blank" rel="noopener" href="https://github.com/hacdias/webdav">https://github.com/hacdias/webdav</a> ） 非常容易就能搭建一个 WebDAV 服务。</p>
<p>WebDAVS(WebDAV over SSL/TLS) 就是加了一层 SSL/TLS ，数据安全更能得到保障，不过一般的使用场景多是 WebDAV + 配合 SSL 的 web server 实现 http 流量的加密，这样反而开销更小。</p>
<h3 id="3-5-NFS"><a href="#3-5-NFS" class="headerlink" title="3.5 NFS"></a>3.5 NFS</h3><p>NFS(Network File System)，即网络文件系统，是 FreeBSD 支持的文件系统中的一种。NFS 允许一个系统在网络上与它人共享目录和文件。通过使用 NFS，用户和程序可以像访问本地文件一样访问远端系统上的文件。它由 Sun 公司（已被 Oracle 收购）开发，于 1984 年发布，最新版本 NFSv4.2 于 2016 年发布。NFS 基于开放网络运算远程过程调用（ONC RPC）协议：一个开放、标准的 RFC 协议，任何人或组织都可以依据标准实现它。</p>
<p>NFS 通常使用在 Unix 操作系统上（比如 Solaris、AIX 及 HP-UX）和其他类 Unix 操作系统（例如 Linux 及 FreeBSD），同时在 macOS 和 Windows 系统也提供了 NFS 实现。不过在 Windows 系统上挂载 NFS 共享目录时，由于 Windows 自带的 NFS 客户端长久以来不支持 UTF-8，会致中文文件和目录显示为乱码。有解决方法但有代价，请见 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/46254792">一个小设置，让Win10 NFS正常显示中文UTF-8</a></p>
<p>NFS 的优点是 kernel 直接支持，部署简单、运行稳定，协议简单、传输效率高。</p>
<p>NFS 的缺点是没有加密授权等功能，仅依靠 IP 地址或主机名来决定用户能否挂载共享目录，对具体目录和文件无法进行 ACL 控制（NFSv4 以前）。通常的做法是通过 Kerberos 对 NFS 进行认证及加密，不过部署配置比较麻烦。</p>
<h3 id="3-6-DLNA-UPnP"><a href="#3-6-DLNA-UPnP" class="headerlink" title="3.6 DLNA+UPnP"></a>3.6 DLNA+UPnP</h3><p>DLNA(Digital Living Network Alliance, 数字生活网络联盟)，其前身是 DHWG（Digital Home Working Group，数字家庭工作组），成立于 2003 年 6 月 24 日， 是由索尼、英特尔、微软等发起成立的一个非营利性的、合作性质的商业组织。</p>
<p>DLNA 旨在解决个人 PC，消费电器，移动设备在内的无线网络和有线网络的互联互通，使得数字媒体和内容服务的无限制的共享和增长成为可能。DLNA 的口号是 Enjoy your music, photos and videos, anywhere anytime。</p>
<p>DLNA 将其整个应用规定成 5 个功能组件。从下到上依次为：网络互连，网络协议，媒体传输，设备的发现控制和管理，媒体格式。</p>
<p><img src="https://pic3.zhimg.com/80/ac96a32309b15d9099b70bca2a204cd8_720w.jpg" alt="DLNA"></p>
<blockquote>
<p>DLNA 架构图 <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/22362647/answer/43637899">image source</a></p>
</blockquote>
<p>UPnP(Universal Plug and Play) 通用即插即用协议，官方的解释太过理论。微软的说法是</p>
<blockquote>
<p>通用即插即用 （UPnP） 是一种用于 PC 机和智能设备（或仪器）的常见对等网络连接的体系结构，尤其是在家庭中。UPnP 以 Internet 标准和技术（例如 TCP/IP、HTTP 和 XML）为基础，使这样的设备彼此可自动连接和协同工作，从而使网络（尤其是家庭网络）对更多的人成为可能。</p>
</blockquote>
<p>实际上，普通用户理解 UPnP 可以理解为基于 TCP/IP 上的自动端口映射，一般路由器在 NAT 的工作模式下可以打开此功能，自动处理局域网内设备中的各个软件的 UPnP 请求。</p>
<p>DLNA 可以高效的访问服务器中的各种类型资源，由 DLNA 服务器帮用户索引好离线文件。比如图片，音乐专辑，电影，电视剧集，适合多媒体的场景使用。</p>
<h3 id="3-7-HTTP-HTTPS"><a href="#3-7-HTTP-HTTPS" class="headerlink" title="3.7 HTTP/HTTPS"></a>3.7 HTTP/HTTPS</h3><p>HTTP(HyperText Transfer Protocol)即超文本传输协议，我们都不陌生了，通过 http 共享文件可以很简单，比如使用 nginx 标准模块 <code>Auto Index</code> 可以很快创建一个可以共享的文件服务器，效率也非常之高。</p>
<p>比如在 nginx 创建一个共享本地文件夹的配置文件 <code>/etc/nginx/sites-enabled/files-sharing.conf</code> ，内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line"> </span><br><span class="line">    listen 82;</span><br><span class="line">    server_name 192.168.10.10;</span><br><span class="line">    charset gbk,utf-8;</span><br><span class="line"> </span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">        root &#x2F;home&#x2F;xxx&#x2F;nginx-static-files&#x2F;; </span><br><span class="line">        index index.html index.htm;</span><br><span class="line">        autoindex on;</span><br><span class="line">        autoindex_exact_size on;</span><br><span class="line">        autoindex_localtime on;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>访问 <a target="_blank" rel="noopener" href="http://192.168.10.10:82/">http://192.168.10.10:82</a> (a fake address) 后的效果</p>
<p><img src="https://image.940304.xyz/i/2022/06/16/62aabb96789e4.png" alt="20220616131149"></p>
<p>HTTPS(HTTP over SSL/TLS)，加密后的 http 流量，目前正是主流 web 交互的方式。</p>
<h3 id="3-8-rsync"><a href="#3-8-rsync" class="headerlink" title="3.8 rsync"></a>3.8 rsync</h3><p>rsync 全称 remote synchronize，即”远程同步”，是 Liunx/Unix 下的一个远程数据同步工具。它可通过 LAN/WAN 快速同步多台主机间的文件和目录，并适当利用 rsync 算法（差分编码）以减少数据的传输，即可做到增量传输/备份。严格来说，rsync 算不上底层的文件传输/共享协议，但是本文为了介绍的尽量全面还是提一下。</p>
<p>在常驻模式（daemon mode）下，rsync 默认监听 TCP 端口 873，以原生 rsync 传输协议或者透过远程 shell 如 RSH 或者 SSH 提供文件。SSH 模式下，rsync 客户端执行程序必须同时在本地和远程机器上安装。</p>
<p>rsync 首度发布于 1996 年 6 月 19 日。原始作者为安德鲁·垂鸠（Andrew Tridgell）<em>（很巧的是，又是这个大神）</em>与保罗·麦可拉斯（Paul Mackerras）。</p>
<p>rsync 现在应用广泛，使用起来也非常方便易用，效率也高，最初设计就是替代 SCP 的。既能在本地用于数据拷贝、移动（可用来替代 Linux <code>cp</code> 和 <code>mv</code> 命令），也能做增量备份存储。通过 SSH 实现远程复制也非常好用。</p>
<p>关于 rsync 的基础用法和高级用法可以看看阮一峰的 <a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2020/08/rsync.html">rsync 用法教程</a> , 写得易懂且全面。</p>
<p>其实类似于 rsync 的工具，还有 <code>rclone</code>、<code>robocopy</code>、<code>freefilesync</code> 等，这里就不做过多介绍了。</p>
<h3 id="3-9-AFP"><a href="#3-9-AFP" class="headerlink" title="3.9 AFP"></a>3.9 AFP</h3><p>AFP(Apple Filing Protocol)，是一种专门为 MAC OS X(现名: macOS) 系统提供文件共享服务的协议，通过开源的 Netatalk 实现 AFP 共享。主要应用是苹果笔记本的 Time Machine 时间机器系统备份，macOS 物理接口是 type-c，并有微软的雷电 Thunderbolt 授权，协议就是 AFP 。但是这东西不够完善，复杂使用场景下都有 bug，现在连苹果自己都很少用。</p>
<h3 id="3-10-MTP"><a href="#3-10-MTP" class="headerlink" title="3.10 MTP"></a>3.10 MTP</h3><p>MTP(Media Transfer Protocol) 媒体传输协议，是基于 PTP(Picture Transfer Protocol) 协议的扩展，主要用于传输媒体文件，其中有价值的应用就是同步 DRM 文件的 license。</p>
<p>MTP 既可以实现在 USB 协议上，也可以实现在 TCP/IP 协议上，它属于上层的应用协议，而不关心底层传输协议。目前大部分设备的应用都是基于 USB 协议。在 Android 设备上应用广泛，使用 USB A cable 连接 Windows PC 和 Android 设备，默认的文件传输协议就是 MTP，但除此之外，内网文件的传输很少应用到此协议。</p>
<h3 id="3-11-others"><a href="#3-11-others" class="headerlink" title="3.11 others"></a>3.11 others</h3><p>我把他们归为一类，不够通用，具有一定的专用性，主要是为企业服务的。</p>
<h4 id="AS2-AS3-AS4"><a href="#AS2-AS3-AS4" class="headerlink" title="AS2/AS3/AS4"></a>AS2/AS3/AS4</h4><p>AS2(Applicability Statement 2)，下同。</p>
<p>AS2，AS3 和 AS4 都是用来发送和保护关键文件传输的流行协议。</p>
<p>AS2 用于在因特网上安全可靠地传输敏感数据。AS2 利用数字证书和加密标准来保护在系统、网络和位置之间传输的关键信息。AS2 消息可以通过安全的 SSL 隧道进行压缩、签名、加密和发送。</p>
<p>AS3 是一个标准，几乎可以用来传输任何文件类型。它通过数字签名和数据加密为数据传输提供了一层安全性。它最初是为了传输数据文件而创建的，如 XML 和 EDI 商业对企业数据的文件。与 AS2 不同，AS2 是一种定义的传输协议，AS3 是一种消息标准，它侧重于在从服务器发送到服务器时应该如何格式化消息。一旦 AS3 消息被合成，它就可以通过任何其他协议(FTP、SFTP、HTTPS 等)传输。只要双方能够访问已放置消息的位置。</p>
<p>AS4 是一种协议，允许企业与其合作伙伴安全地交换数据。它建立在最初由 AS2 设置的基础上，但与 Web 服务一起工作，并提供改进的交付通知。作为企业对企业的标准，AS4 有助于使在互联网上进行文件交换变得安全和简单。</p>
<blockquote>
<p>see also <a target="_blank" rel="noopener" href="https://www.goanywhere.com/blog/whats-the-difference-between-as2-as3-and-as4">What’s the Difference Between AS2, AS3, and AS4?</a></p>
</blockquote>
<h4 id="OFTP（Odette-文件传输协议）"><a href="#OFTP（Odette-文件传输协议）" class="headerlink" title="OFTP（Odette 文件传输协议）"></a>OFTP（Odette 文件传输协议）</h4><p>OFTP(Odette FTP)，另一种专为 EDI 设计的文件传输协议 OFTP。OFTP 在欧洲应用非常普遍。OFTP 和 AS2 本质上都是安全的，甚至支持电子交付收据，使它们非常适合 B2B 交易。</p>
<h4 id="AFTP"><a href="#AFTP" class="headerlink" title="AFTP"></a>AFTP</h4><p>AFTP(Accelerated FTP)，是 JSCAPE 开发的一种文件传输协议（中文：加速文件传输协议），旨在进行 WAN 环境下的文件传输，尤其是远距离下的文件传输，但很容易受到延迟和数据包丢失等不良网络条件的影响，从而导致吞吐量大幅下降。AFTP 是一种 TCP-UDP 混合体，它使文件传输几乎不受这些网络条件的影响，理想情况下能比 FTP 传输快 100 倍。属于企业级应用协议。</p>
<h4 id="raysync"><a href="#raysync" class="headerlink" title="raysync"></a>raysync</h4><p>镭速文件传输协议 FTP 加速产品是专为企业定制开发的一款完全替代现有文件传输协议 FTP 的高效传输软件，能够在现有结构的基础上实现文件的高速传输，使用镭速文件传输协议 FTP 加速后，文件传输协议 FTP 传输速度可提升 10-100 倍。</p>
<p>这是国产深圳的一个公司的商业化产品。</p>
<h4 id="PeSIT"><a href="#PeSIT" class="headerlink" title="PeSIT"></a>PeSIT</h4><p>PeSIT, short for Protocol d’Echanges pour un Systeme Interbancaire de Telecompensation (Protocol for data Exchange within the French Systems for Interbank Tele-clearance) 协议是一种端到端文件传输协议，由法国银行间电信系统经济利益集团 (GSIT) 开发。它在北美应用较少，主要用于满足欧洲银行标准，以及向欧洲银行和从欧洲银行转移通信。</p>
<blockquote>
<p>see also <a target="_blank" rel="noopener" href="https://www.goanywhere.com/blog/what-is-pesit">What is PeSIT?</a></p>
</blockquote>
<h3 id="内网文件共享选择协议建议"><a href="#内网文件共享选择协议建议" class="headerlink" title="内网文件共享选择协议建议"></a>内网文件共享选择协议建议</h3><p><img src="https://image.940304.xyz/i/2022/06/16/62aad5af2f7a7.png" alt="20220616150310"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://www.92nas.com/forum.php?mod=viewthread&tid=352">image source</a></p>
</blockquote>
<ul>
<li><strong>samba 对于大多数人绝对是最优最优的选择，适配日常使用的所有平台，没有各种乱码问题，兼容性极佳。目前的 samba3 samba4 性能也不错</strong></li>
<li><strong>对于 Linux 用户可以优选 NFS，效能比起 samba 还是高</strong></li>
<li><strong>平常使用 Linux 传送一些小文件可以直接使用 scp 命令行，或者使用 WinSCP 这些工具（或者更推荐使用 rsync）</strong></li>
<li><strong>如果是内网磁盘想要暴露到公网，推荐 WebDAV + nginx + SSL，可以方便的将家里的磁盘暴露到公网(不过强烈建议使用 strong strong password)</strong></li>
<li><strong>DLNA 这种，偶尔使用多媒体还行，但如果是重度用户建议搭建 Plex、Emby、Jellyfin 服务端</strong> （诶我怎么歪题了）</li>
<li><strong>其实内网的文件共享需求和 nas 上文件共享需求不谋而合</strong></li>
<li><strong>FTP, SFTP 不是很推荐</strong></li>
<li><strong>HTTP 配合 nginx 搭建一个存储文件的静态 public 站点还是不错的</strong></li>
</ul>
<p>引用一段 V2EX 网友的评论 来自帖子 <a target="_blank" rel="noopener" href="https://www.v2ex.com/t/818478">https://www.v2ex.com/t/818478</a></p>
<blockquote>
<p>奉劝一句，别瞎折腾。最完善的远程文件访问协议就是 SMB 。macOS 下 Finder 中协议语法为“SMB://”。在群晖、威联通中打开 SMB 协议访问即可。<br>别玩苹果自身的 AFP ，macOS 间互访都有 bug ，苹果默认都不用这个，默认用的是 SMB （我家里有 3 台苹果电脑，6 台不同的 NAS 设备，足够验证这个）。群晖启用 AFP 也有 bug ，反倒是威联通的 AFP 比较完善。<br>也别冲 WebDAV ，这个居然自身没搞定文件名编码方案（当然我猜测实际上应该是搞定了，我说的没搞定是默认配置下没搞定，估计需要用户各种场景测试然后通过命令行什么的指定编码方案）。我的一些小姐姐影片 NAS 间同步后文件名就变了。<br>FTP 这些完全是闹着玩的，首次配置好能用，过一段时间登录就有问题。<br>截至今日，世界上使用最广的操作系统依然是 windows ，至今依然是 windows 自己的远程文件访问协议其他厂商支持 /测试的最完善，那就是 SMB （ Samba ）。其他的各种协议，不同操作系统中要么不自带需要安装第三方软件，即使带了默认可能也没启用需要用户自己启用甚至配置。考虑到家用环境的复杂性，iOS 设备、安卓设备、电视、windows 、macos 、NAS 、甚至可能还有监控摄像头存储，这些不同操作系统要同时支持 /验证某个文件互访协议，想想都能明白有多麻烦。</p>
</blockquote>
<p><strong>结合我自身的各种协议的使用经验，我的整体评价也是，samba 保你用户体验，一般情况下 samba 就够了，需要公网映射就加上 WebDAV。</strong></p>
<h2 id="4-个人公网文件管理方案"><a href="#4-个人公网文件管理方案" class="headerlink" title="4. 个人公网文件管理方案"></a>4. 个人公网文件管理方案</h2><p>我们可以用各种大公司的云产品，比如百度云盘，阿里云盘，夸克网盘等等，这些是面向普通用户的产品。还有一些面向开发者、企业的云产品等等不在本文讨论范围。我们想要知道的是普通用户如何建立起属于自己的公网网盘。我搜集了一些开源产品。见下表</p>
<table>
<thead>
<tr>
<th align="left">名称</th>
<th align="center">开源仓库</th>
<th align="left">优缺点</th>
</tr>
</thead>
<tbody><tr>
<td align="left">NextCloud (其前身是 OwnCloud)</td>
<td align="center"><a target="_blank" rel="noopener" href="https://github.com/nextcloud">https://github.com/nextcloud</a></td>
<td align="left">- 功能极其强大，具备丰富的 extensions - 后端核心程序使用 php 开发，效率并不算优</td>
</tr>
<tr>
<td align="left">Seafile</td>
<td align="center"><a target="_blank" rel="noopener" href="https://github.com/haiwen/seafile">https://github.com/haiwen/seafile</a></td>
<td align="left">- 功能稍微单一，但是后端核心程序使用 C 语言编写，文件传输高效</td>
</tr>
<tr>
<td align="left">Cloudreve</td>
<td align="center"><a target="_blank" rel="noopener" href="https://github.com/cloudreve/Cloudreve">https://github.com/cloudreve/Cloudreve</a></td>
<td align="left">- Material-UI 个人认为简洁美观 - 支持本机、从机、七牛、阿里云 OSS、腾讯云 COS、又拍云、OneDrive (包括世纪互联版) 作为存储端 - 后端原本是 php 编写，而后使用了 Golang 重构</td>
</tr>
<tr>
<td align="left">ZFile</td>
<td align="center"><a target="_blank" rel="noopener" href="https://github.com/haiwen/seafile">https://github.com/haiwen/seafile</a></td>
<td align="left">- 基于 Java 的在线网盘程序，支持对接 S3、OneDrive、SharePoint、又拍云、本地存储、FTP 等存储源，支持在线浏览图片、播放音视频，文本文件等文件类型</td>
</tr>
<tr>
<td align="left">KodExplorer(可道云)</td>
<td align="center"><a target="_blank" rel="noopener" href="https://github.com/kalcaddle/KodExplorer">https://github.com/kalcaddle/KodExplorer</a></td>
<td align="left">- 类似于群晖桌面式 ui，适合对于计算机操作不熟悉的用户使用 - 他们发布了新产品 kodbox <a target="_blank" rel="noopener" href="https://github.com/kalcaddle/kodbox">https://github.com/kalcaddle/kodbox</a></td>
</tr>
</tbody></table>
<p>我目前几乎是 <em>我全都要.gif</em>，但是最终留下了 <code>Seafile</code> 和 <code>Nextcloud</code> 和 <code>Cloudreve</code> 三款产品。</p>
<p>下文我将介绍在局域网搭建一个 Seafile Server，然后通过一台具备公网 IP 的机器将其服务暴露到公网 serving.</p>
<h2 id="5-自建-Seafile-Server-并使用-frp-暴露到公网"><a href="#5-自建-Seafile-Server-并使用-frp-暴露到公网" class="headerlink" title="5. 自建 Seafile Server 并使用 frp 暴露到公网"></a>5. 自建 Seafile Server 并使用 frp 暴露到公网</h2><p>我简而言之。</p>
<h3 id="5-1-使用-docker-compose-安装-Seafile-Server"><a href="#5-1-使用-docker-compose-安装-Seafile-Server" class="headerlink" title="5.1 使用 docker-compose 安装 Seafile Server"></a>5.1 使用 docker-compose 安装 Seafile Server</h3><p>compose file 参考官网的 <a target="_blank" rel="noopener" href="https://docs.seafile.com/d/cb1d3f97106847abbf31/files/?p=/docker/docker-compose.yml">https://docs.seafile.com/d/cb1d3f97106847abbf31/files/?p=/docker/docker-compose.yml</a></p>
<p>也可以参考 <a target="_blank" rel="noopener" href="https://cloud.seafile.com/published/seafile-manual-cn/docker/%E7%94%A8Docker%E9%83%A8%E7%BD%B2Seafile.md">https://cloud.seafile.com/published/seafile-manual-cn/docker/%E7%94%A8Docker%E9%83%A8%E7%BD%B2Seafile.md</a></p>
<p>创建 <code>/your/path/seafile-compose.yml</code>，内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">version: &#39;2.0&#39;</span><br><span class="line">services:</span><br><span class="line">  db:</span><br><span class="line">    image: mariadb:10.5</span><br><span class="line">    container_name: seafile-mysql</span><br><span class="line">    environment:</span><br><span class="line">      - MYSQL_ROOT_PASSWORD&#x3D;123456 # Requested, set the root&#39;s password of MySQL service.</span><br><span class="line">      - MYSQL_LOG_CONSOLE&#x3D;true</span><br><span class="line">    volumes:</span><br><span class="line">      - .&#x2F;seafile-mysql&#x2F;db:&#x2F;var&#x2F;lib&#x2F;mysql  # Requested, specifies the path to MySQL data persistent store.</span><br><span class="line">    networks:</span><br><span class="line">      - seafile-net</span><br><span class="line"> </span><br><span class="line">  memcached:</span><br><span class="line">    image: memcached:1.6</span><br><span class="line">    container_name: seafile-memcached</span><br><span class="line">    entrypoint: memcached -m 256</span><br><span class="line">    networks:</span><br><span class="line">      - seafile-net</span><br><span class="line"> </span><br><span class="line">  seafile:</span><br><span class="line">    image: seafileltd&#x2F;seafile-mc:latest</span><br><span class="line">    container_name: seafile</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;8088:80&quot;</span><br><span class="line">#      - &quot;443:443&quot;  # If https is enabled, cancel the comment.</span><br><span class="line">    volumes:</span><br><span class="line">      - .&#x2F;seafile-data:&#x2F;shared   # Requested, specifies the path to Seafile data persistent store.</span><br><span class="line">    environment:</span><br><span class="line">      - DB_HOST&#x3D;db</span><br><span class="line">      - DB_ROOT_PASSWD&#x3D;123456  # Requested, the value shuold be root&#39;s password of MySQL service.</span><br><span class="line">      - TIME_ZONE&#x3D;Asia&#x2F;Shanghai # Optional, default is UTC. Should be uncomment and set to your local time zone.</span><br><span class="line">      - SEAFILE_ADMIN_EMAIL&#x3D;email@example.com # Specifies Seafile admin user, default is &#39;me@example.com&#39;.</span><br><span class="line">      - SEAFILE_ADMIN_PASSWORD&#x3D;123456     # Specifies Seafile admin password, default is &#39;asecret&#39;.</span><br><span class="line">      - SEAFILE_SERVER_LETSENCRYPT&#x3D;false   # Whether use letsencrypt to generate cert.</span><br><span class="line">      - SEAFILE_SERVER_HOSTNAME&#x3D;seafile.example.com # Specifies your host name.</span><br><span class="line">    depends_on:</span><br><span class="line">      - db</span><br><span class="line">      - memcached</span><br><span class="line">    networks:</span><br><span class="line">      - seafile-net</span><br><span class="line"> </span><br><span class="line">networks:</span><br><span class="line">  seafile-net:</span><br><span class="line"># 启动一个 docker stack, 建立三个容器</span><br><span class="line"># docker-compose -f .&#x2F;seafile-compose.yml up -d</span><br></pre></td></tr></table></figure>

<p>默认 WebDAV 是关闭的，我们将它打开</p>
<p><code>docker exec -it seafile bash</code> 进入容器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 下面这是在容器中</span><br><span class="line"> </span><br><span class="line"># vim &#x2F;shared&#x2F;seafile&#x2F;conf&#x2F;seafdav.conf</span><br><span class="line"> </span><br><span class="line"># 将 [WEBDAV] enabled 由 false 改成 true</span><br><span class="line"> </span><br><span class="line"># 然后重启 seafile 服务</span><br><span class="line"> </span><br><span class="line"># cd &#x2F;opt&#x2F;seafile&#x2F;seafile-server-9.0.4 #读者操作的时候 latest 镜像版本应该比这个更新</span><br><span class="line"> </span><br><span class="line"># .&#x2F;seafile.sh restart</span><br><span class="line"> </span><br><span class="line">Stopping seafile server ...</span><br><span class="line">Starting seafile server, please wait ...</span><br><span class="line">** Message: 20:02:59.972: seafile-controller.c(621): No seafevents.</span><br><span class="line"> </span><br><span class="line">Seafile server started</span><br><span class="line"> </span><br><span class="line">Done.</span><br></pre></td></tr></table></figure>

<p>Seafile Server 基本就部署好了。</p>
<h3 id="5-2-在公网机器上安装-frps"><a href="#5-2-在公网机器上安装-frps" class="headerlink" title="5.2 在公网机器上安装 frps"></a>5.2 在公网机器上安装 frps</h3><p>FRP 是一个非常优秀的内网穿透程序，GitHub 链接: <a target="_blank" rel="noopener" href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a> ，其在 GitHub 上拥有 57.2k 个 star（截止 2022-06-15）。很多用户家里的网络 NAT 类型都是 Symmetric 对称型，我们一般称之为 NAT type 4，是一种最难穿透的类型。要想 nat 穿越成功，如果用户没法提升 nat 类型（最高 nat 1，叫做 FullCone 全锥形），那就必须要使用一台公网服务器中转，但这其实也是一种最高效的方式（花钱就行）。</p>
<p>如何搭建 frps 这一部分互联网上已经有太多教程了，我简单综述一下。</p>
<ol>
<li>frp 是 go 写的，搭建 frp 环境需要一台具备公网的 VPS 或者国内叫轻量应用服务器，云服务器之类的</li>
<li>在公网机器上运行 frps（binary, Linux 可执行文件），需配合 <code>frps.ini</code> 配置文件</li>
<li>在内网机器（Seafile Server 所在机器）运行 frpc，需配合 <code>frpc.ini</code> 配置文件</li>
</ol>
<p>比如拉取 frp x86_64 0.39.0 版本的源程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># wget -O &#x2F;home&#x2F;xxx&#x2F;temp&#x2F;frp_0.39.0_linux_arm64.tar.gz https:&#x2F;&#x2F;github.com&#x2F;fatedier&#x2F;frp&#x2F;releases&#x2F;download&#x2F;v0.39.0&#x2F;frp_0.39.0_linux_arm64.tar.gz</span><br></pre></td></tr></table></figure>

<p>配置一下 <code>/usr/local/frp/frps.ini</code> 配置文件，以下所有端口都使用了 12345 代替</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># [common] is integral section</span><br><span class="line">[common]</span><br><span class="line"># A literal address or host name for IPv6 must be enclosed</span><br><span class="line"># in square brackets, as in &quot;[::1]:80&quot;, &quot;[ipv6-host]:http&quot; or &quot;[ipv6-host%zone]:80&quot;</span><br><span class="line">bind_addr &#x3D; 0.0.0.0</span><br><span class="line">bind_port &#x3D; 12345</span><br><span class="line"># udp port used for kcp protocol, it can be same with &#39;bind_port&#39;</span><br><span class="line"># if not set, kcp is disabled in frps</span><br><span class="line">kcp_bind_port &#x3D; 12345</span><br><span class="line"># bind udp port</span><br><span class="line">bind_udp_port &#x3D; 12345</span><br><span class="line"># if you want to configure or reload frps by dashboard, dashboard_port must be set</span><br><span class="line">dashboard_port &#x3D; 12345</span><br><span class="line"># dashboard assets directory(only for debug mode)</span><br><span class="line">dashboard_user &#x3D; YOUR_USERNAME</span><br><span class="line">dashboard_pwd &#x3D; YOUR_PASSWORD</span><br><span class="line"># assets_dir &#x3D; .&#x2F;static</span><br><span class="line">vhost_http_port &#x3D; 12345</span><br><span class="line">vhost_https_port &#x3D; 12345</span><br><span class="line"># console or real logFile path like .&#x2F;frps.log</span><br><span class="line">log_file &#x3D; &#x2F;var&#x2F;log&#x2F;frp&#x2F;frps.log</span><br><span class="line"># debug, info, warn, error</span><br><span class="line">log_level &#x3D; info</span><br><span class="line">log_max_days &#x3D; 3</span><br><span class="line"># auth token</span><br><span class="line">token &#x3D; A_STRONG_PASSWORD</span><br><span class="line"># only allow frpc to bind ports you list, if you set nothing, there won&#39;t be any limit</span><br><span class="line">#allow_ports &#x3D; 1-65535</span><br><span class="line"># pool_count in each proxy will change to max_pool_count if they exceed the maximum value</span><br><span class="line">max_pool_count &#x3D; 50</span><br><span class="line"># if tcp stream multiplexing is used, default is true</span><br><span class="line">tcp_mux &#x3D; true</span><br></pre></td></tr></table></figure>

<p>Systemd 是 Linux 系统工具，用来启动守护进程，现已成为大多数发行版的标准配置。我们也用 systemd 管理 frps 和 frpc。创建文件 <code>/lib/systemd/system/frps.service</code> 内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description&#x3D; Frps Service Daemon</span><br><span class="line">After&#x3D;network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;simple</span><br><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;local&#x2F;frp&#x2F;frps -c &#x2F;usr&#x2F;local&#x2F;frp&#x2F;frps.ini</span><br><span class="line">KillSignal&#x3D;SIGQUIT</span><br><span class="line">TimeoutStopSec&#x3D;5</span><br><span class="line">KillMode&#x3D;process</span><br><span class="line">PrivateTmp&#x3D;true</span><br><span class="line">StandardOutput&#x3D;syslog</span><br><span class="line">StandardError&#x3D;inherit</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure>

<p>启用开机自启</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># systemctl enable frps</span><br></pre></td></tr></table></figure>

<p>启动程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># systemctl start frps</span><br></pre></td></tr></table></figure>

<h3 id="5-3-在内网机器上安装-frpc"><a href="#5-3-在内网机器上安装-frpc" class="headerlink" title="5.3 在内网机器上安装 frpc"></a>5.3 在内网机器上安装 frpc</h3><p>和 5.2 类似，我们需要 <code>frpc</code> 可执行程序和 <code>frpc.ini</code> 配置文件。</p>
<p>创建配置文件 <code>/etc/frp/frpc.ini</code>，内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">log_file &#x3D; &#x2F;tmp&#x2F;frpc.log</span><br><span class="line">log_level &#x3D; info</span><br><span class="line">log_max_days &#x3D; 3</span><br><span class="line">login_fail_exit &#x3D; false</span><br><span class="line">protocol &#x3D; tcp</span><br><span class="line">server_addr &#x3D; example.com</span><br><span class="line">server_port &#x3D; 12345</span><br><span class="line">tcp_mux &#x3D; true</span><br><span class="line">token &#x3D; A_STRONG_PASSWORD</span><br><span class="line">user &#x3D; YOUR_USERNAME</span><br><span class="line"></span><br><span class="line">[second-n1-seafile]</span><br><span class="line">type &#x3D; http</span><br><span class="line">custom_domains &#x3D; seafile.example.com</span><br><span class="line">local_ip &#x3D; x.x.x.x</span><br><span class="line">local_port &#x3D; 8088</span><br><span class="line">remote_port &#x3D; 12345</span><br><span class="line">use_compression &#x3D; true</span><br><span class="line">use_encryption &#x3D; true</span><br></pre></td></tr></table></figure>

<p>frpc 这边也使用 systemd 管理程序。创建 <code>/lib/systemd/system/frpc.service</code>，内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description&#x3D;FRPC Client Daemon</span><br><span class="line">After&#x3D;network.target</span><br><span class="line">Wants&#x3D;network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;simple</span><br><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;bin&#x2F;frpc -c &#x2F;etc&#x2F;frp&#x2F;frpc.ini</span><br><span class="line">Restart&#x3D;always</span><br><span class="line">RestartSec&#x3D;20s</span><br><span class="line">User&#x3D;xxx</span><br><span class="line">Group&#x3D;xxx</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure>

<p>设置开机自启</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># systemctl enable frpc</span><br></pre></td></tr></table></figure>

<p>启动 frpc 程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># systemctl start frpc</span><br></pre></td></tr></table></figure>

<h3 id="5-4-其他事项"><a href="#5-4-其他事项" class="headerlink" title="5.4 其他事项"></a>5.4 其他事项</h3><p>域名相关的东西我就不说了。</p>
<p>配置的时候注意可执行文件、配置文件的权限，和文件拥有者和所在组。</p>
<p>还有防火墙。除了 Linux distro 自身安装的各种防火墙程序之外，类似良心云这种厂商在虚拟化的应用服务器之外还有一层硬件级别的防火墙，如果配置后发现不能访问可以优先往这些方面排查。</p>
<p>下面我们在 VPS 上使用 nginx 反代 seafile 服务，并使用 SSL/TLS 加密（在最外层套 SSL）。得先准备好申请好的证书和私钥。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 比如 nginx 配置中的证书和私钥形式如下</span><br><span class="line"> </span><br><span class="line">ssl_certificate    &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;example.com&#x2F;fullchain.pem;</span><br><span class="line">ssl_certificate_key    &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;example.com&#x2F;privkey.pem;</span><br></pre></td></tr></table></figure>

<p>创建 nginx 配置文件 <code>/etc/nginx/sites-enabled/seafile-home.conf</code> 内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  seafile.example.com;</span><br><span class="line">        rewrite ^ https:&#x2F;&#x2F;$http_host$request_uri? permanent;    # Forced redirect from HTTP to HTTPS</span><br><span class="line">        server_tokens off;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">        listen 443 ssl http2;</span><br><span class="line">        ssl_certificate    &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;example.com&#x2F;fullchain.pem;</span><br><span class="line">        ssl_certificate_key    &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;example.com&#x2F;privkey.pem;</span><br><span class="line">        server_name seafile.example.com;</span><br><span class="line">        server_tokens off;</span><br><span class="line"> </span><br><span class="line">        # HSTS for protection against man-in-the-middle-attacks</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age&#x3D;31536000; includeSubDomains&quot;;</span><br><span class="line"> </span><br><span class="line">        ssl_protocols TLSv1.2 TLSv1.3;</span><br><span class="line">        ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class="line">        ssl_prefer_server_ciphers off;</span><br><span class="line"> </span><br><span class="line">        ssl_session_timeout 5m;</span><br><span class="line"> </span><br><span class="line">        location &#x2F; &#123;</span><br><span class="line">                proxy_pass         http:&#x2F;&#x2F;127.0.0.1:12345;</span><br><span class="line">                proxy_set_header   X-Real-IP $remote_addr;</span><br><span class="line">                proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">                proxy_set_header   X-Forwarded-Host $server_name;</span><br><span class="line">                proxy_set_header   X-Forwarded-Proto https;</span><br><span class="line">                proxy_set_header   Host $host:$server_port;</span><br><span class="line"> </span><br><span class="line">                access_log      &#x2F;var&#x2F;log&#x2F;nginx&#x2F;seahub.access.log;</span><br><span class="line">                error_log       &#x2F;var&#x2F;log&#x2F;nginx&#x2F;seahub.error.log;</span><br><span class="line"> </span><br><span class="line">                proxy_read_timeout  1200s;</span><br><span class="line"> </span><br><span class="line">                client_max_body_size 0;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>检查 nginx 语法并重载 nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nginx -t &amp;&amp; nginx -s reload</span><br></pre></td></tr></table></figure>

<p>然后就可以通过 <a target="_blank" rel="noopener" href="https://seafile.example.com/">https://seafile.example.com</a> 访问属于自己的 seafile 服务。</p>
<hr>
<p><img src="https://hellodk.cn/usr/uploads/spot_loading.gif" alt="20220616144938"></p>
<blockquote>
<p>进入后台管理页面，可以随意切换公网和内网访问，大部分时候还是使用公网的域名访问配置</p>
</blockquote>
<p><img src="https://hellodk.cn/usr/uploads/spot_loading.gif" alt="20220616144704"></p>
<blockquote>
<p>跑到了 100MiB/s，但是没有截到图 🤣</p>
</blockquote>
<p><img src="https://hellodk.cn/usr/uploads/spot_loading.gif" alt="20220616145227"></p>
<blockquote>
<p>切换到内网，打开浏览器上传的速度，受限于机器性能，比如我的 Phicomm N1 最多只能跑到 50MiB/s</p>
</blockquote>
<p>全文完。</p>
<h2 id="6-引用与致谢"><a href="#6-引用与致谢" class="headerlink" title="6. 引用与致谢"></a>6. 引用与致谢</h2><ul>
<li>各个协议的 wikipedia 简体中文页面</li>
<li>各个开源项目</li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/411161467">NFS、FTP、SMB、WebDav、DLNA协议，傻傻分不清？</a></li>
<li><a target="_blank" rel="noopener" href="https://post.smzdm.com/p/ar6k932q/">SMB、FTP、WebDAV协议，傻傻分不清？5000字教程，教你快速上手</a></li>
<li><a target="_blank" rel="noopener" href="https://www.lategege.com/?p=466">nas各种共享访问协议的使用</a></li>
<li><a target="_blank" rel="noopener" href="https://www.raysync.cn/news/post-id-864">13 种适用于企业的文件传输协议</a></li>
</ul>
<p>end.</p>
<p>打赏: <img src="https://img.gejiba.com/images/6e24e0daffd9f056c2488ba1810b0711.png" alt="微信收款二维码">微信, <img src="https://img.gejiba.com/images/3f53c114d523608679ec81d24e4c2a3a.jpg" alt="支付宝收款二维码">支付宝</p>
<p>标签: <a target="_blank" rel="noopener" href="https://hellodk.cn/tag/Linux/">Linux</a>, <a target="_blank" rel="noopener" href="https://hellodk.cn/tag/%E7%BD%91%E7%BB%9C/">网络</a></p>
<p>本作品采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可。</p>
<h3 id="添加新评论"><a href="#添加新评论" class="headerlink" title="添加新评论"></a>添加新评论</h3><p>OωO表情</p>
<p><img src="https://hellodk.cn/action/captcha" alt="captcha"><br><strong>请输入验证码：</strong> </p>
<p>提交评论</p>
<ul>
<li>上一篇: <a target="_blank" rel="noopener" href="https://hellodk.cn/post/1048">解决 webdav 连接 seafile 无法重命名文件等操作造成的 SeafDAV: MOVE returns 502 Bad Gateway 错误</a></li>
<li>下一篇: 没有了</li>
</ul>
<p>Copyright © 2017 - 2022 by hellodk.cn | Proudly Powered by <a target="_blank" rel="noopener" href="http://www.typecho.org/">Typecho</a> &amp; <a target="_blank" rel="noopener" href="https://www.offodd.com/17.html">Initial </a>&amp; <a target="_blank" rel="noopener" href="https://hellodk.cn/">❤.</a></p>
<p><a target="_blank" rel="noopener" href="https://hellodk.cn/archives">Archives | </a><a target="_blank" rel="noopener" href="https://hellodk.cn/sitemap.xml">SiteMap | </a><a target="_blank" rel="noopener" href="https://hellodk.cn/about">About</a></p>
<p>Site has been running for 3 year(s) 71 days 11 hours.</p>
<p>小破站总访问量才 792276 次，要加油鸭！</p>
<p>页面加载用时: 524 ms</p>
<ul>
<li></li>
<li></li>
</ul>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-硬件相关知识" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/814126a1.html" class="article-date">
      <time datetime="2022-06-15T13:58:19.000Z" itemprop="datePublished">2022-06-15</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/814126a1.html">计算机硬件相关知识</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>主板 上有各种芯片 南桥,北桥,接口芯片连接总线</p>
<p>CPU 频率,核心,架构</p>
<p>GPU 专用矢量渲染,并行能力强,算力丰富</p>
<p>
                              
                          
                    
              <!-- 
              
              <p>主板 上有各种芯片 南桥,北桥,接口芯片连接总线</p>
<p>CPU 频率,核心,架构</p>
<p>GPU 专用矢量渲染,并行能力强,算力丰富</p>
<p>目前显卡 消费端就是 gtx,gnx 生产端 tesla</p>
<table>
<thead>
<tr>
<th><strong>通用并行运算</strong></th>
<th><strong>显示的api</strong></th>
</tr>
</thead>
<tbody><tr>
<td>cude</td>
<td>directx</td>
</tr>
<tr>
<td>opencl</td>
<td>opengl()</td>
</tr>
<tr>
<td></td>
<td>vulkan逐渐替代</td>
</tr>
<tr>
<td></td>
<td>webgl(浏览器基于opengl 封装的api 包括cesuim 等很多js 三维基于这个 来进一步封装和集成)</td>
</tr>
</tbody></table>
<p>实时画面渲染 可能是GPU集群来实现 一方面是处理速度网络是有延时的</p>
<p>主板上多GPU功能主要需要使用NVIDIA上面的SLI来实现目前pci-e 主板来实现目前ue4官方并不支持多GPU</p>
<p>对应运行gpu算力的部分 一般是用 NVIDIA-smi来实现集中接口调用 类似于 opencl</p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-gdal镜像集成和dockerfile使用" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/59cba8fc.html" class="article-date">
      <time datetime="2022-06-13T07:01:28.000Z" itemprop="datePublished">2022-06-13</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/59cba8fc.html">gdal镜像集成和dockerfile使用</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><h2 id="gdal介绍"><a href="#gdal介绍" class="headerlink" title="gdal介绍"></a>gdal介绍</h2><p>gdal的一个用c++语言编写的库，用于处理地理信息相关的数据包括转换，识别数据，格式化数据以及解析</p>
<p>同时提供第三方语言的SDK包括python，java上述需要编译后使用 java是需要使用jni接口调用实现方法在window平台是DLL文件，在linux平台是so文件，最后需要使用和初始化服务。</p>
<h3 id="gdal命令使用"><a href="#gdal命令使用" class="headerlink" title="gdal命令使用"></a>gdal命令使用</h3><p>1、ogrinfo</p>
<p>
                              
                          
                    
              <!-- 
              
              <h2 id="gdal介绍"><a href="#gdal介绍" class="headerlink" title="gdal介绍"></a>gdal介绍</h2><p>gdal的一个用c++语言编写的库，用于处理地理信息相关的数据包括转换，识别数据，格式化数据以及解析</p>
<p>同时提供第三方语言的SDK包括python，java上述需要编译后使用 java是需要使用jni接口调用实现方法在window平台是DLL文件，在linux平台是so文件，最后需要使用和初始化服务。</p>
<h3 id="gdal命令使用"><a href="#gdal命令使用" class="headerlink" title="gdal命令使用"></a>gdal命令使用</h3><p>1、ogrinfo</p>
<p>orginfo –version</p>
<p>ogrinfo –help</p>
<p>2、ogr2ogr</p>
<blockquote>
<ul>
<li>ogr2ogr postgis转shp 并执行SQL</li>
</ul>
<p>ogr2ogr -f  “ESRI Shapefile” file1.shp    PG:”host=’192.168.7.11’ port=’5432’ dbname=’postgres’ user=’postgres’ password=’1111’” -sql “select * from like_fff_xztc”   -dialect PostgreSQL</p>
<ul>
<li>ogr2ogr postgis转化为shp文件且指定SQL执行</li>
</ul>
<p>ogr2ogr -f  “ESRI Shapefile” /app/tmp/result_like_fff_xztc/result_like_fff_xztc.shp PG:”host=’192.168.7.11’ port=’5432’ dbname=’postgres’ user=’postgres’ password=’1111’” -sql “select fid,objectid,bsm,dlmc,qsdwmc,zldwmc,f_xzqhmc,f_year,f_month,partitionno,se_anno_cad_data,tbdlmj,ysdm,dlbm,qsxz,qsdwdm,zldwdm,xzgdlx,zldj,f_xzqhdm,f_diccode,f_fileid,tbbh,shape_length,shape_area,st_transForm(geom,4490) as geom  from like_fff_xztc where ST_Intersects(geom,st_transform(st_geomFromText(‘MULTIPOLYGON(((112.973570327973 30.634569982416,112.973501343979 30.6344597898424,112.973423613701 30.6344687491655)))’,4490),4490))” -dialect PostgreSQL  –config SHAPE_ENCODING ‘UTF-8’</p>
<ul>
<li>ogr2ogr shp导入shp 命令</li>
</ul>
<p>ogr2ogr   -f  “PostgreSQL” PG:”host=’192.168.7.11’ port=’5432’ dbname=’test’ user=’postgres’ password=’1111’” C:\Users\Administrator\Desktop\ceshi\old\Water_region.shp -progress  -nlt PROMOTE_TO_MULTI -lco GEOMETRY_NAME=geom -lco FID=fid  -overwrite -nln ‘like_test_update’  -unsetFieldWidth  –config SHAPE_ENCODING ‘utf-8’</p>
<ul>
<li>ogr2ogr mdb导入shp命令</li>
</ul>
<p>ogr2ogr -f “PostgreSQL” PG:”host=’192.168.7.11’ port=’5432’ dbname=’test_new_app’ user=’postgres’ password=’1111’” /app/laohekou.mdb  -progress  -nlt PROMOTE_TO_MULTI -lco GEOMETRY_NAME=geom -lco FID=fid  -overwrite -nln ‘test_mdb_001’</p>
<ul>
<li>ogr2ogr shp转入postgis</li>
</ul>
<p>ogr2ogr -f “PostgreSQL” PG:”host=xxx user=xxx password=xxx dbname=cxxxhina”  -nlt GEOMETRY 省级行政区.shp</p>
</blockquote>
<p>3、</p>
<h2 id="官方gdal的dockerfile简介"><a href="#官方gdal的dockerfile简介" class="headerlink" title="官方gdal的dockerfile简介"></a>官方gdal的dockerfile简介</h2><p><a target="_blank" rel="noopener" href="https://github.com/OSGeo/gdal/tree/01490692487cb436bb4b10740cd2aabb403531fe/docker"><a target="_blank" rel="noopener" href="https://github.com/OSGeo/gdal/tree/master/docker">gdal/docker at master · OSGeo/gdal</a></a></p>
<blockquote>
<h1 id="Alpine-based"><a href="#Alpine-based" class="headerlink" title="Alpine based"></a>Alpine based</h1><p>Alpine version:</p>
<ul>
<li>3.15 for 3.5</li>
<li>3.16 for GDAL 3.6dev</li>
</ul>
<h2 id="Small-osgeo-gdal-alpine-small-latest"><a href="#Small-osgeo-gdal-alpine-small-latest" class="headerlink" title="Small: osgeo/gdal:alpine-small-latest"></a>Small: <code>osgeo/gdal:alpine-small-latest</code></h2><ul>
<li>Image size: ~ 59 MB</li>
<li>Raster drivers: ultrasmall + built-in + SQLite-based ones + network-based ones</li>
<li>Vector drivers: ultrasmall + built-in + most XML-based ones + network-based ones + PostgreSQL</li>
<li>Using internal libtiff and libgeotiff</li>
<li>External libraries enabled: ultrasmall + libexpat, libpq, libssl</li>
<li><em>No</em> GDAL Python</li>
<li>Base PROJ grid package (<a target="_blank" rel="noopener" href="http://download.osgeo.org/proj/proj-datumgrid-1.8.zip">http://download.osgeo.org/proj/proj-datumgrid-1.8.zip</a>)</li>
<li>Overall licensing terms of the GDAL build: permissive (MIT, BSD style, Apache, etc..)</li>
</ul>
<p>See <a target="_blank" rel="noopener" href="https://github.com/OSGeo/gdal/blob/master/docker/alpine-small/Dockerfile">alpine-small/Dockerfile</a></p>
<h2 id="Normal-osgeo-gdal-alpine-normal-latest"><a href="#Normal-osgeo-gdal-alpine-normal-latest" class="headerlink" title="Normal: osgeo/gdal:alpine-normal-latest"></a>Normal: <code>osgeo/gdal:alpine-normal-latest</code></h2><ul>
<li>Image size: ~ 277 MB</li>
<li>Raster drivers: small + netCDF, HDF5, BAG</li>
<li>Vector drivers: small + Spatialite, XLS</li>
<li>Using internal libtiff and libgeotiff</li>
<li>External libraries enabled: small + libgeos, libhdf5, libhdf5, libkea, libnetcdf, libfreexl, libspatialite, libxml2, libpoppler, openexr, libheif, libdeflate, libparquet</li>
<li>GDAL Python</li>
<li>Base PROJ grid package (<a target="_blank" rel="noopener" href="http://download.osgeo.org/proj/proj-datumgrid-1.8.zip">http://download.osgeo.org/proj/proj-datumgrid-1.8.zip</a>)</li>
<li>Overall licensing terms of the GDAL build: copy-left (GPL) + LGPL + permissive</li>
</ul>
<p>See <a target="_blank" rel="noopener" href="https://github.com/OSGeo/gdal/blob/master/docker/alpine-normal/Dockerfile">alpine-normal/Dockerfile</a></p>
<h1 id="Ubuntu-based"><a href="#Ubuntu-based" class="headerlink" title="Ubuntu based"></a>Ubuntu based</h1><p>Ubuntu version:</p>
<ul>
<li>20.04 for GDAL 3.4 and 3.5</li>
<li>22.04 for GDAL 3.6dev</li>
</ul>
<h2 id="Small-osgeo-gdal-ubuntu-small-latest"><a href="#Small-osgeo-gdal-ubuntu-small-latest" class="headerlink" title="Small: osgeo/gdal:ubuntu-small-latest"></a>Small: <code>osgeo/gdal:ubuntu-small-latest</code></h2><ul>
<li>Image size: ~ 385 MB</li>
<li>Raster drivers: all built-in + JPEG + PNG + JP2OpenJPEG + WEBP +SQLite-based ones + network-based ones</li>
<li>Vector drivers: all built-in + XML based ones + SQLite-based ones + network-based ones + PostgreSQL</li>
<li>Using internal libtiff and libgeotiff</li>
<li>External libraries enabled: libsqlite3, libproj, libcurl, libjpeg, libpng, libwebp, libzstd, libexpat, libxerces-c, libpq, libssl, libgeos, libspatialite</li>
<li>GDAL Python (Python 3.8 for Ubuntu 20.04, Python 3.10 for Ubuntu 22.04)</li>
<li>Base PROJ grid package (<a target="_blank" rel="noopener" href="http://download.osgeo.org/proj/proj-datumgrid-1.8.zip">http://download.osgeo.org/proj/proj-datumgrid-1.8.zip</a>)</li>
<li>Overall licensing terms of the GDAL build: LGPL + permissive (MIT, BSD style, Apache, etc..)</li>
</ul>
<p>See <a target="_blank" rel="noopener" href="https://github.com/OSGeo/gdal/blob/master/docker/ubuntu-small/Dockerfile">ubuntu-small/Dockerfile</a></p>
<h2 id="Full-osgeo-gdal-ubuntu-full-latest-aliased-to-osgeo-gdal"><a href="#Full-osgeo-gdal-ubuntu-full-latest-aliased-to-osgeo-gdal" class="headerlink" title="Full: osgeo/gdal:ubuntu-full-latest (aliased to osgeo/gdal)"></a>Full: <code>osgeo/gdal:ubuntu-full-latest</code> (aliased to <code>osgeo/gdal</code>)</h2><ul>
<li>Image size: ~ 1.48 GB</li>
<li>Raster drivers: all based on almost all possible free and open-source dependencies</li>
<li>Vector drivers: all based on almost all possible free and open-source dependencies</li>
<li>Using internal libtiff and libgeotiff</li>
<li>External libraries enabled: small + libnetcdf, libhdf4, libhdf5, libtiledb, libkea, mongocxx 3.4, libspatialite, unixodbc, libxml2, libcfitsio, libmysqlclient, libkml, libpoppler, pdfium, openexr, libheif, libdeflate, libparquet</li>
<li>GDAL Python (Python 3.8 for Ubuntu 20.04, Python 3.10 for Ubuntu 22.04)</li>
<li><em>All</em> PROJ grid packages (equivalent of latest of proj-data-X.zip from <a target="_blank" rel="noopener" href="http://download.osgeo.org/proj/">http://download.osgeo.org/proj/</a> at time of generation, &gt; 500 MB)</li>
<li>Overall licensing terms of the GDAL build: copy-left (GPL) + LGPL + permissive</li>
</ul>
</blockquote>
<p>点击进入后可以看到介绍，目前分别在两个linux发行版本上进行镜像文件创建，分别是Ubuntu，和alpine</p>
<p>alpine是精简的服务目前不包括第三方的拓展目前在linux上不支持pgeo（改数据源可以读取mdb和其他格式数据的支持）</p>
<p>ubuntu是完整版是提供全量的服务，支持pgeo</p>
<p>介绍</p>
<p>linux下面读取微软的软件word，Excel，PPT是有平台和驱动，但是像access这种个人数据库需要ODBC这个开源平台来读取这类数据，gdal在linux平台通过ODBC接口来读取access个人数据库，同时对数据解析，我们需要利用这个解析工具来读取数据被我们java读取，或者通过ogr2ogr命令来转换数据</p>
<p>ODBC</p>
<p>是linux平台的数据的解析</p>
<p>ogrinfo 能识别</p>
<p>odbcinst -j  表示odbc正确安装</p>
<h2 id="方法一osgeo-gdal-ubuntu-full基础上安装-unixODBC-mdbtools"><a href="#方法一osgeo-gdal-ubuntu-full基础上安装-unixODBC-mdbtools" class="headerlink" title="方法一osgeo/gdal:ubuntu-full基础上安装(unixODBC,mdbtools)"></a>方法一osgeo/gdal:ubuntu-full基础上安装(unixODBC,mdbtools)</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">FROM</span>  osgeo/gdal:ubuntu-full-<span class="number">3.0</span>.<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> cp  /etc/apt/sources.list  /etc/apt/sources.list.bak</span></span><br><span class="line"><span class="comment"># RUN echo  &#x27;deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse \ndeb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse \ndeb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse \ndeb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse \ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse \ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse \ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse \ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse \ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse\n&#x27; &gt; /etc/apt/sources.list</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update &amp;&amp; cat /etc/apt/sources.list &amp;&amp; apt-get  -y --fix-missing --no-install-recommends install  gcc make g++  bison flex gawk unixodbc-dev libgdal-java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> ./unixODBC-2.3.11   /usr/unixODBC-2.3.11</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> ./mdbtools-1.0.0   /usr/mdbtools-1.0.0</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> chmod -R 777 /usr/unixODBC-2.3.11/ &amp;&amp; chmod -R 777 /usr/mdbtools-1.0.0</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash">   <span class="built_in">cd</span> /usr/unixODBC-2.3.11/ &amp;&amp; ./configure --prefix=/usr/unixODBC-2.3.11 --includedir=/usr/include --libdir=/usr/lib --bindir=/usr/bin --sysconfdir=/etc</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash">  <span class="built_in">cd</span> /usr/unixODBC-2.3.11/ &amp;&amp; make</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash">  <span class="built_in">cd</span> /usr/unixODBC-2.3.11/ &amp;&amp; make install</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash">  <span class="built_in">cd</span>  /usr/mdbtools-1.0.0 &amp;&amp; ./configure --with-unixodbc=/usr/unixODBC-2.3.11</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">cd</span>  /usr/mdbtools-1.0.0 &amp;&amp; make</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">cd</span>  /usr/mdbtools-1.0.0 &amp;&amp; make install</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RUN echo &quot;export LD_LIBRARY_PATH_LIKE=/usr/local/lib&quot; &gt;&gt; /etc/profile &amp;&amp; source /etc/profile</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> ./odbcinst.ini  /etc</span></span><br><span class="line"><span class="keyword">ENV</span> LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib</span><br><span class="line"><span class="keyword">RUN</span><span class="bash">  cp /usr/share/java/gdal.jar  /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/</span></span><br><span class="line"><span class="comment"># 指定时区</span></span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="comment"># 设定工作目录</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash">  config /app/config</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash">  ./shp2pg.py /app/py/shp2pg.py	</span></span><br><span class="line"><span class="comment"># 声明端口</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">11002</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> uts-stg.jar /app/uts-stg.jar</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class="string">&quot;-Djava.library.path=/usr/lib/jni&quot;</span>, <span class="string">&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005 &quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;/app/uts-stg.jar&quot;</span>]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-gdal使用和环境初始化在Windows和linux下的介绍" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/54871149.html" class="article-date">
      <time datetime="2022-05-14T05:06:11.000Z" itemprop="datePublished">2022-05-14</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/54871149.html">gdal使用和环境初始化在Windows和linux下的介绍</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>gdal是用c语言编写的服务能解析地理信息服务中的各种解析服务</p>
<p>在Windows中可以使用别人编译打包好的服务，里面以后各种依赖的DLL和jar包，可以提供个java调用，同时也支持其他语言。</p>
<p>我下载的版本<a target="_blank" rel="noopener" href="https://www.gisinternals.com/query.html?content=filelist&file=release-1911-x64-gdal-3-0-4-mapserver-7-4-3.zip">release-1911-x64-gdal-3-0-4-mapserver-7-4-3.zip</a></p>
<p>
                              
                          
                    
              <!-- 
              
              <p>gdal是用c语言编写的服务能解析地理信息服务中的各种解析服务</p>
<p>在Windows中可以使用别人编译打包好的服务，里面以后各种依赖的DLL和jar包，可以提供个java调用，同时也支持其他语言。</p>
<p>我下载的版本<a target="_blank" rel="noopener" href="https://www.gisinternals.com/query.html?content=filelist&file=release-1911-x64-gdal-3-0-4-mapserver-7-4-3.zip">release-1911-x64-gdal-3-0-4-mapserver-7-4-3.zip</a></p>
<p>1.配置gdal的环境</p>
<p><a target="_blank" rel="noopener" href="https://gis.stackexchange.com/questions/228190/gdal-java-bindings-gdal-2-0-0-in-eclipse">GDAL Java bindings GDAL 2.0.0 in Eclipse - Geographic Information Systems Stack Exchange</a></p>
<p>否则会包下列错误:</p>
<p><strong>UnsatisfiedLinkError: E:\jdk\jdk-12.0.2\bin\gdalalljni.dll: Can’t find dependent libraries</strong></p>
<p>如果是默认安装的路径在C:\Program Files (x86)\GDAL\ 下需要修改</p>
<table>
<thead>
<tr>
<th>创建路径</th>
<th>变量的名称</th>
<th>路径</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>CREATE</td>
<td>GDAL_DATA</td>
<td>C:\gdal\bin\gdal-data</td>
<td>必须</td>
</tr>
<tr>
<td>CREATE</td>
<td>GDAL_DRIVER_PATH</td>
<td>C:\gdal\bin\gdal\plugins</td>
<td>必须</td>
</tr>
<tr>
<td>APPEND</td>
<td>PATH</td>
<td>C:\gdal\bin</td>
<td>必须</td>
</tr>
<tr>
<td>APPEND</td>
<td>PATH</td>
<td>C:\gdal\bin\gdal\apps</td>
<td>可选</td>
</tr>
</tbody></table>
<p>同时将压缩包内</p>
<p>配置完成是命令行输入 gdalinfo –version看是否能正常调用</p>
<p>如果出现ogr_MSSQLSpatial.dl加载不了的情况不用理会,在github上貌似Windows系统的集成问题如果觉得看着难受可以 直接重命名  ogr_MSSQLSpatial.dll.bak</p>
<p>参考文章: <a target="_blank" rel="noopener" href="https://blog.csdn.net/l2931050/article/details/124688681">Gdal环境配置（Windows系统）_gdal配置环境变量_魔希达的博客-CSDN博客</a></p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!-- 
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gdal/" rel="tag">gdal</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>
    </div>
 -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-springsecurity入门介绍" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/329899c5.html" class="article-date">
      <time datetime="2022-05-01T06:53:48.000Z" itemprop="datePublished">2022-05-01</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/329899c5.html">springsecurity入门介绍</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6934503341380599822">Spring Security系列之一 简单介绍和实战 - 掘金</a></p>
<p><a target="_blank" rel="noopener" href="https://www.1024sou.com/article/56472.html">20210902#_【项目实践】一文带你搞定Spring Security + JWT - 1024搜-程序员专属的搜索引擎</a></p>
<p><a target="_blank" rel="noopener" href="https://www.springcloud.cc/spring-session.html">Spring Session 中文文档 参考手册 中文版</a></p>
<p>
                              
                          
                    
              <!-- 
              
              <p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6934503341380599822">Spring Security系列之一 简单介绍和实战 - 掘金</a></p>
<p><a target="_blank" rel="noopener" href="https://www.1024sou.com/article/56472.html">20210902#_【项目实践】一文带你搞定Spring Security + JWT - 1024搜-程序员专属的搜索引擎</a></p>
<p><a target="_blank" rel="noopener" href="https://www.springcloud.cc/spring-session.html">Spring Session 中文文档 参考手册 中文版</a></p>
<p>springsecurity和shiro都是权限和认证的框架，目前公司有基于springsecurity开发集成包，目前使用结合使用过程梳理一下springsecurity的特性和注意事项和集成的要点</p>
<p>目前引入的springsecurity的</p>
<p>springsecurity -outh 2.2.2.6 和需要和session打交道的session-core和session-data-redis2.4.1</p>
<p>利用session-redis来存储session</p>
<p>Web系统中登录认证（Authentication）的核心就是<strong>凭证</strong>机制，无论是<code>Session</code>还是<code>JWT</code>，都是在用户成功登录时返回给用户一个凭证，后续用户访问接口需携带凭证来标明自己的身份。后端会对需要进行认证的接口进行安全判断，若凭证没问题则代表已登录就放行接口，若凭证有问题则直接拒绝请求。这个安全判断<strong>都是放在过滤器里统一处理的</strong>：</p>
<p>一般需要实现 </p>
<h3 id="需要实现UserDetails"><a href="#需要实现UserDetails" class="headerlink" title="需要实现UserDetails"></a>需要实现UserDetails</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AuthUser extends User UserDetails, CredentialsContainer</span><br></pre></td></tr></table></figure>

<h3 id="实现loadUserByUsername"><a href="#实现loadUserByUsername" class="headerlink" title="实现loadUserByUsername"></a>实现loadUserByUsername</h3><p>org.springframework.security.core.userdetails.UserDetailsService.loadUserByUsername</p>
<h3 id="PasswordEncoder-密码的认证"><a href="#PasswordEncoder-密码的认证" class="headerlink" title="PasswordEncoder 密码的认证"></a><strong>PasswordEncoder</strong> 密码的认证</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">public PasswordEncoder passwordEncoder() &#123;</span><br><span class="line">    &#x2F;&#x2F; 这里我们使用bcrypt加密算法，安全性比较高</span><br><span class="line">    return new BCryptPasswordEncoder();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="继承WebSecurityConfigurerAdapter"><a href="#继承WebSecurityConfigurerAdapter" class="headerlink" title="继承WebSecurityConfigurerAdapter"></a>继承WebSecurityConfigurerAdapter</h3><p>org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter</p>
<blockquote>
<p>由 authenticationManager() 的默认实现用来尝试获取 AuthenticationManager。如果被覆盖，应该使用 AuthenticationManagerBuilder 来指定 AuthenticationManager。<br>authenticationManagerBean() 方法可用于将生成的 AuthenticationManager 公开为 Bean。 userDetailsServiceBean() 可用于公开使用 AuthenticationManagerBuilder 作为 Bean 创建的最后填充的 UserDetailsService。 UserDetailsService 也将自动填充到 HttpSecurity.getSharedObject(Class) 以与其他 SecurityContextConfigurer （即 RememberMeConfigurer ）一起使用<br>例如，以下配置可用于在内存中注册身份验证，以公开内存中的 UserDetailsService：<br>UserDetailsService:<br>       @Override<br>       protected void configure(AuthenticationManagerBuilder auth) {<br>           auth<br>           // enable in memory based authentication with a user named<br>           // “user” and “admin”<br>           .inMemoryAuthentication().withUser(“user”).password(“password”).roles(“USER”).and()<br>                   .withUser(“admin”).password(“password”).roles(“USER”, “ADMIN”);<br>       }</p>
<pre><code>   // Expose the UserDetailsService as a Bean
   @Bean
   @Override
   public UserDetailsService userDetailsServiceBean() throws Exception &#123;
       return super.userDetailsServiceBean();
   &#125;</code></pre>
</blockquote>
<p>目前使用的方式设置认证的方式和控制那些需要被权限管理</p>
<h3 id="继承SecurityMetadataSource"><a href="#继承SecurityMetadataSource" class="headerlink" title="继承SecurityMetadataSource"></a>继承SecurityMetadataSource</h3><p>org.springframework.security.access.SecurityMetadataSource</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">实现动态的权限验证，当然要先要获取对应的资源，然后再将他们对应哪些角色可以访问的关系表示出来</span><br></pre></td></tr></table></figure>
               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-spring知识回顾" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/d8ed5f9d.html" class="article-date">
      <time datetime="2022-05-01T03:53:25.000Z" itemprop="datePublished">2022-05-01</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/d8ed5f9d.html">spring知识回顾</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>spring的利用的面向切面编程（AOP），动态代理（反射）和filter，intercept，</p>
<p>ApplicationContent</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Qualifier</span><br><span class="line">Roucese</span><br><span class="line">Autowired</span><br></pre></td></tr></table></figure>
<p>
                              
                          
                    
              <!-- 
              
              <p>spring的利用的面向切面编程（AOP），动态代理（反射）和filter，intercept，</p>
<p>ApplicationContent</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Qualifier</span><br><span class="line">Roucese</span><br><span class="line">Autowired</span><br></pre></td></tr></table></figure>

<h2 id="拦截器利用了反射对请求进行自定义的操作可以访问action上下文和栈的对象，保证数据"><a href="#拦截器利用了反射对请求进行自定义的操作可以访问action上下文和栈的对象，保证数据" class="headerlink" title="拦截器利用了反射对请求进行自定义的操作可以访问action上下文和栈的对象，保证数据"></a>拦截器利用了反射对请求进行自定义的操作可以访问action上下文和栈的对象，保证数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Interceptor 前置&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Interceptor 处理中&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Interceptor 后置&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="过滤器利用原始servlet来进行操作主要可用于鉴权和"><a href="#过滤器利用原始servlet来进行操作主要可用于鉴权和" class="headerlink" title="过滤器利用原始servlet来进行操作主要可用于鉴权和"></a>过滤器利用原始servlet来进行操作主要可用于鉴权和</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Filter 前置&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Filter 处理中&quot;</span>);</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Filter 后置&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Aspect</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Pointcut(&quot;@annotation(com.HasAuth)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pointCut</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;pointCut()&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint point)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Object[] args = point.getArgs();</span><br><span class="line">       <span class="comment">/* if (StringUtil.IsEmpty(args[0])) &#123;</span></span><br><span class="line"><span class="comment">            args[0] = &quot;default&quot;;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        <span class="keyword">return</span> point.proceed(args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//标注该方法体为后置通知，当目标方法执行成功后执行该方法体  </span></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;within(com.abchina.irms..*) &amp;&amp; @annotation(rl)&quot;)</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLogSuccess</span><span class="params">(JoinPoint jp, rmpfLog rl)</span></span>&#123;  </span><br><span class="line">        Object[] parames = jp.getArgs();<span class="comment">//获取目标方法体参数  </span></span><br><span class="line">        String params = parseParames(parames); <span class="comment">//解析目标方法体的参数  </span></span><br><span class="line">        String className = jp.getTarget().getClass().toString();<span class="comment">//获取目标类名  </span></span><br><span class="line">        className = className.substring(className.indexOf(<span class="string">&quot;com&quot;</span>));  </span><br><span class="line">        String signature = jp.getSignature().toString();<span class="comment">//获取目标方法签名  </span></span><br><span class="line">        String methodName = signature.substring(signature.lastIndexOf(<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>, signature.indexOf(<span class="string">&quot;(&quot;</span>));  </span><br><span class="line">        String modelName = getModelName(className); <span class="comment">//根据类名获取所属的模块  </span></span><br><span class="line">          </span><br><span class="line">      ...</span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//标注该方法体为异常通知，当目标方法出现异常时，执行该方法体  </span></span><br><span class="line">    <span class="meta">@AfterThrowing(pointcut=&quot;within(com.abchina.irms..*) &amp;&amp; @annotation(rl)&quot;, throwing=&quot;ex&quot;)</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLog</span><span class="params">(JoinPoint jp, rmpfLog rl, BusinessException ex)</span></span>&#123;  </span><br><span class="line">       ...</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="不加载特定的bean"><a href="#不加载特定的bean" class="headerlink" title="不加载特定的bean"></a>不加载特定的bean</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="meta">@EnableSpringConfigured</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &#123;&quot;com.example&quot;&#125;, </span></span><br><span class="line"><span class="meta">               excludeFilters=&#123;@ComponentScan.Filter(type = FilterType.REGEX, pattern = &quot;org.xxx.yyy.*&quot;),</span></span><br><span class="line"><span class="meta">  @ComponentScan.Filter(type=FilterType.ASSIGNABLE_TYPE, value=Foo.class)&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySpringConfiguration</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>







<h2 id="stream-自定义function"><a href="#stream-自定义function" class="headerlink" title="stream  自定义function"></a>stream  自定义function</h2>
               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-这些科技将在2022年改变你的生活内容（华尔街日报转载）" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/a683129.html" class="article-date">
      <time datetime="2022-04-16T13:45:36.000Z" itemprop="datePublished">2022-04-16</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/a683129.html">这些科技将在2022年改变你的生活内容（华尔街日报转载）</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>Facebook公司更名？全球芯片荒？数字艺术品卖出天价？没有哪个水晶球準确预测了2021年的科技业景象。这也正是这项一年一度的活动有意思和令人兴奋的地方之一——我们团队每年都会集思广益，对接下来一年科技圈会发生些什么进行预测。可就算我们对当前趋势作了最为详尽的分析，以及请来行业专家和占卜工具加持，也依然无法精确预测未来。</p>
<p>有一点可以确定的是，2022年将充满新技术带来的惊喜（参见：混合现实和家用机器人），人们将继续讨论科技对世界带来的影响（参见：社交媒体和可持续性），同时还会有许多意想不到的事情发生，因为最近时常会有一些令你大呼意外的时刻。</p>
<p>以下是我们对2022年科技行业的预测：</p>
<p>
                              
                          
                    
              <!-- 
              
              <p>Facebook公司更名？全球芯片荒？数字艺术品卖出天价？没有哪个水晶球準确预测了2021年的科技业景象。这也正是这项一年一度的活动有意思和令人兴奋的地方之一——我们团队每年都会集思广益，对接下来一年科技圈会发生些什么进行预测。可就算我们对当前趋势作了最为详尽的分析，以及请来行业专家和占卜工具加持，也依然无法精确预测未来。</p>
<p>有一点可以确定的是，2022年将充满新技术带来的惊喜（参见：混合现实和家用机器人），人们将继续讨论科技对世界带来的影响（参见：社交媒体和可持续性），同时还会有许多意想不到的事情发生，因为最近时常会有一些令你大呼意外的时刻。</p>
<p>以下是我们对2022年科技行业的预测：</p>
<h2 id="电动车价格更亲民"><a href="#电动车价格更亲民" class="headerlink" title="电动车价格更亲民"></a>电动车价格更亲民</h2><p>人们购买电动车时选择为数不多的局面成为过去。到2022年底时，可供美国消费者挑选的电动车车型将超过100款。而且，许多即将面世的车型要比一两年前的那些价格更亲民。</p>
<p>电动车在美国乘用车保有量中的佔比仍不到3%，研究显示，若想让更多人选择电动车，价格是一大关键因素。（另一个关键因素是基础设施。美国目前的公共快速充电桩数量远远达不到专家估计的需求量。）</p>
<p>为企业提供咨询服务的Guidehouse公司首席研究分析师斯科特·谢帕德（Scott Shepard）指出，从全球范围看，2015年至2020年间，尽管电动车的平均续航里程增加了45%，但平均定价下降了30%。他预计2022年这一趋势将得以延续，届时至少还有四款价格在4万美元以下的电动车登陆美国。</p>
<p>福特F-150「闪电」电动皮卡（Ford F-150 Lightning，制造商建议零售价39,974美元起）的表现或许可以给我们一点启发。该公司在接到近20万辆F-150「闪电」的订单后，不得不关闭了预购服务；福特最新的业绩报告显示，有75%的买家是头一次购买福特品牌的汽车。</p>
<p>与此同时，日产汽车（Nissan）将早年投放市场的聆风（Leaf）电动车的起售价从32,620美元大幅下调至28,375美元。聆风降价后（以及购车时享受7,500美元的稅收抵免后）在同档次的汽车中，价格会低于2022年款本田思域（Honda Civic）燃油掀背车。除此之外，还有许多电动汽车车型的起售价都在4万美元以下，如雪佛兰（Chevrolet）、现代（Hyundai）、起亚（Kia）、马自达（Mazda）、Mini和大众（Volkswagen）的一些车型，它们有的已经上市，有的不久便会投放市场。</p>
<h2 id="可持续性继续受关注"><a href="#可持续性继续受关注" class="headerlink" title="可持续性继续受关注"></a>可持续性继续受关注</h2><p>微软（Microsoft）利用回收的海洋塑胶垃圾做了一款鼠标。苹果（Apple）的最新款iPhone和iPad都含有回收材料。亚马逊（Amazon）的新款Echo智能喇叭的显示屏同样用到了回收塑胶，而且在待机状态下十分节能。2021年每一场重要的科技主题演讲中，都会包含应对气候变化的环节，2022年这一现象只会有增无减。</p>
<p>可以说，科技业留下的碳足迹比航空业更大，眼下科技公司正在努力改变这一现状，实现可持续发展。无论是从手机、平板还是电脑的设计中，都可以看到它们这方面的努力。</p>
<p>可持续性还意味着，你的同一部电子设备可以用得更久。加州大学洛杉矶分校（University of California, Los Angeles）管理学教授马加利·德尔马斯（Magali Delmas）说，「真正的问题在于科技业研发的产品使用壽命太短，而且很难维修，接着就被扔进垃圾填埋场。」</p>
<p>电子设备制造商也在尝试解决这一问题。苹果将在2022年初推出一项自助维修计划，按照该计划，用户和独立技术人员可以利用正版苹果零部件自主维修设备，这也是倡导「维修权」的人士一直以来都在游说的一项举措。戴尔公司（Dell）近日展示了概念性笔记本电脑Luna，它使用的螺丝更少，而且没有风扇，从而最大限度地提高了可维修性。</p>
<h2 id="社交媒体加大力度保护未成年人"><a href="#社交媒体加大力度保护未成年人" class="headerlink" title="社交媒体加大力度保护未成年人"></a>社交媒体加大力度保护未成年人</h2><p>2021年我们意识到，社交媒体类应用程式——尤其是Instagram和TikTok——在阻止年轻用户观看不良内容以及防止他们沉迷方面做得不够。2022年我们会看到，美国国会议员和社交媒体公司将加大对儿童的保护力度。</p>
<p>针对目前主要由算法驱动的内容展示方式，Instagram已承诺在2022年初推出替代方案。按照现有方式，用户基本无法控制自己可以看到哪些内容。Instagram负责人亚当·莫塞里（Adam Mosseri）在12月向美国参议院一个下属委员会表示，该公司2022年将推出更多针对青少年的家长控制功能，包括从3月开始，允许家长设定时间限制。</p>
<p>TikTok则表示，它已开始调整算法，这样人们看到的内容中就不会充斥著大量有关紊乱饮食、抑郁症和其他涉及不良话题的影片。该公司发言人说，它将继续依据用户年龄对功能作出限制，同时也会为家长提供工具。</p>
<p>然而，由于不相信这些企业会自己做出必要的改变，议员们跨党派合作，著手制定新的法律。马萨诸塞州民主党参议员埃德·马基（Ed Markey）和路易斯安那州共和党参议员比尔·卡西迪（Bill Cassidy）提出了新版本的《儿童和青少年网络私隐保护法》（Children and Teens’ Online Privacy Protection Act, 简称：Coppa 2.0），提议将目前的私隐保护对象扩大到13至15岁的用户，同时禁止针对儿童的个性化广告，等等。康涅狄格州民主党参议员理查德·布卢门塔尔（Richard Blumenthal）和田纳西州共和党参议员玛莎·布莱克本（Marsha Blackburn）也在推动立法，要求提高社交媒体算法的透明度。</p>
<h2 id="芯片！芯片！"><a href="#芯片！芯片！" class="headerlink" title="芯片！芯片！"></a>芯片！芯片！</h2><p>从2020年初开始，全球随处可见的疫情「封锁令」使得人们对许多搭载微芯片的东西有了更大的需求——与外界联系需要的智能手机、居家办公和学习需要的笔记本电脑和台式电脑，以及代替公共交通工具的私家车。</p>
<p>受此影响，2020年及2021年整个上半年，人们对芯片的需求达到了前所未有的程度。有迹象显示，芯片需求已开始回落。作为全球最大的智能手机市场，中国2021年第三季度智能手机销量较上年同期下滑9%。（不过苹果表示iPhone的需求依然强劲，预计公司2021年利润将创下纪录新高。）</p>
<p>没有人确切知道芯片供应何时才能完全满足需求，一些分析师说，这可能要等到2023年，届时从亚利桑那州到北京，将有更多的芯片制造产能投产。但鉴於人们对电子设备的需求将终于得以满足，加之过去18个月内芯片制造商一直开足马力生产，供不应求局面结束的日子或许指日可待。</p>
<p>二手芯片制造设备交易公司SDI Fabsurplus的斯蒂芬·豪伊（Stephen Howe）说，回首2000年时，芯片厂经营者曾预计，芯片需求将一直旺盛，高增长态势也将持续。「可你瞧，到了2000年6月，整个市场经历了断崖式下跌，我敢肯定，这一幕还会重演。」他说。</p>
<h2 id="机器人在哪儿，哪儿就是家"><a href="#机器人在哪儿，哪儿就是家" class="headerlink" title="机器人在哪儿，哪儿就是家"></a>机器人在哪儿，哪儿就是家</h2><p>能照顾孩子、能洗碗，还能疏通马桶的全能型家用机器人在2022年还不会出现，但比立式智能喇叭、扫地机器人再能干一点的家用机器人会在今年走进人们的视野——而且它或许还会提供陪伴功能。</p>
<p>亚马逊基於智能喇叭Alexa打造的家用机器人Astro可以利用传感器在家中自由移动。它不仅具备了Alexa的基本功能（如播放音乐、回答问题等），还带有监控功能，当你不在家时，可以通过自带摄像头替你「看家」。如果一位年长亲人的家中有Astro，你还可以通过「Alexa Together」功能与亲人远程互动。</p>
<p>亚马逊负责设备与服务业务的副总裁大卫·林普（David Limp）说，Astro代表着向「环境智能」（AMI）的转变 ，有了这种技术，我们的电脑将退至幕后，让我们「在现实世界中互动，而不是把头埋在手机里。」</p>
<p>亚马逊从2021年12月开始，向一小批受邀测试者递送了这款售价1,000美元的机器人。林普说，提出测试申请的人数比他当初的预期高出了许多倍，目前公司正在努力增加2022年的库存。</p>
<p>此外，老年伴侣机器人ElliQ等类似设备正在65岁及以上的独居老人中接受测试。厂商计划2022年扩展ElliQ的功能，增加管家服务，让用户可以通过ElliQ订购食品杂货等。</p>
<h2 id="「混合现实」成为现实"><a href="#「混合现实」成为现实" class="headerlink" title="「混合现实」成为现实"></a>「混合现实」成为现实</h2><p>我们知道，过去大约五年来，有些人一直在说虚拟现实（VR）将改变我们的生活。但我们向你保证，2022年VR技术将取得重大进展，增强现实（AR）也会带来更好的体验。（记住，VR是把你带入一个虚拟世界，AR是在现实世界中加入数位化元素，二者合称混合现实，即Mixed Reality，但我们不会将其简称为MR。）</p>
<p>Meta（即过去的Facebook）计划发布一款头戴式设备，其功能比目前的Quest 2更先进，价格也更贵。设备中的新传感器和改进后的光学元件会让虚拟世界中的你与在现实中有更高的相似度（项目代号「坎布里亚计划」（Project Cambria））。你的一颦一笑也会体现在虚拟场景中。另外，这款头显能够显示你所处的真实空间，但会加入一些数位化功能——比如在真实的桌子上方投射出一张巨大的虚拟萤幕。这些都是Meta构建元宇宙目标中的一砖一瓦——在这个虚拟世界中，我们可以工作、购物、閒逛，还可以做很多事情。</p>
<p>在这场「元宇宙」竞赛中，不会只有Meta一名选手。有报导称，苹果可能会在2022年晚些时候推出一款混合现实头戴式设备。据天风国际证券（TF International Securities）研究苹果公司的分析师郭明錤说，这款头显将搭载苹果自己的芯片（就像苹果MacBook里的芯片），而且同时具有VR和AR功能。苹果发言人拒绝置评。</p>
<h2 id="不拘於手腕之上的健康传感器"><a href="#不拘於手腕之上的健康传感器" class="headerlink" title="不拘於手腕之上的健康传感器"></a>不拘於手腕之上的健康传感器</h2><p>近十年来，健康追踪器一直都是戴在我们的手腕上，如今它们开始挣脱这种束缚。智能戒指Oura虽然没有显示器，但它配备了迷你传感器，可以监测心率、血氧水平和皮肤温度。Whoop卖的是文胸、紧身裤等服装，但追踪器被巧妙地置于这些服饰中。Google（Google）的Nest Hub智能屏不带摄像头，它利用雷达来监测使用者的睡眠情况。除此之外，Sleep Number、Eight Sleep等公司的智能床垫也可以记录睡眠状态。</p>
<p>Oura首席产品官克里斯·贝赫勒（Chris Becherer）说，「这不涉及什么新技术，也不是什么新型传感器。」他还说，硬件制造商正在寻找更多方法来简化追踪方式。</p>
<p>下一个重要的健康设备可能是你的耳塞。据《华尔街日报》（Wall Street Journal）报导，苹果正在研究利用AirPods来读取体温和监测身体姿势的可行性。据熟悉这些计划的人告诉我们的同事，这类耳塞会从耳朵内部测量佩戴者的核心体温，并依靠运动传感器来监测用户是否驼背。《华尔街日报》报导，苹果还在研发有助於检测抑郁症的iPhone功能。</p>
<h2 id="更亮的显示屏"><a href="#更亮的显示屏" class="headerlink" title="更亮的显示屏"></a>更亮的显示屏</h2><p>如果你发现，你的手机或是智能手表的显示屏比笔记本电脑、电视或是汽车仪表盘的显示屏更亮，对比度也要更高，那么你就已经见证了显示屏技术近年来最大的进化式飞跃之一。</p>
<p>自iPhone X之后，苹果的高端iPhone一直都在使用有机发光二极管（OLED）萤幕，这种技术与液晶显示屏（LCD）的区別在于其中的每个像素可以独立发光，而无需另外的光源。使用OLED的好处是，不仅显示屏可以做得更薄（甚至可以折叠），而且对比度和能效也更高。</p>
<p>三星（Samsung）在手机上应用OLED的时间更早——这家韩国电子产品巨头是OLED技术的先驱之一。以往你可能见过一些OLED电视，但它们的价格异常昂贵。现在，这项技术的制造成本正变得越来越低。2021年，配备OLED显示屏的笔记本电脑开始出现，2022年将有更多类似机型面世。对平板电脑和电视来说也是如此。</p>
<p>微发光二极管（MicroLED）是另一种先进的显示屏技术，有朝一日或许会走进寻常百姓家，成为更多人负担得起的「OLED继任者」。三星已利用这些微小的自发光像素研制出了影片墙，但成本却是天文数字。在2022年1月举行的国际消费电子展CES上，智能眼镜生产商Vuzix计划展示带有微型MicroLED立体显示屏的智能眼镜， 可适用于工作场合的AR场景。</p>
<h2 id="密码登录渐行渐远"><a href="#密码登录渐行渐远" class="headerlink" title="密码登录渐行渐远"></a>密码登录渐行渐远</h2><p>密码有时会成为「雷区」。它们会被人猜中，或是被盗。於是为了防止骇客入侵，我们用上了密码管理软体，利用它们为每一种服务创造独一无二的随机密码。此时此刻，我们当中有许多人甚至都不知道自己的密码！谢天谢地，不需要以密码登录的服务正变得越来越多。</p>
<p>例如，你可以通过往电子邮箱里发送一个特殊链接来登录《华尔街日报》的网站（WSJ.com）。登录工作协同平台Slack和支付平台PayPal也可以采取同样的方式。支付系统Shopify和订座软体Resy会向你的手机发送验证码。微软最近允许用户跳过密码，转而通过应用程式Microsoft Authenticator生成的验证码进行身份验证，这串代码类似通过手机或电子邮箱发送的安全密钥或是验证码。</p>
<p>致力於保护用户身份的科技公司Transmit Security通过一项研究发现，如果一项服务可以用生物特征识別方式来验证身份，那么消费者订购的概率会增加44%；而如果有密码之外的其他登录方式，消费者订购的概率会增加35%。「2022年不会标志著密码时代的终结，但在密码走向消亡的过程中，我们会看到一些具有转折意义的事件。」行业组织FIDO Alliance执行董事安德鲁·希基亚（Andrew Shikiar）说，该组织提倡通过安全密钥、人脸识別、指纹或语音密码来验证身份。</p>
<h2 id="网络提速"><a href="#网络提速" class="headerlink" title="网络提速"></a>网络提速</h2><p>再见，3G。感谢你为老版本的Kindle电子阅读器以及奶奶的翻盖手机提供了联网功能。2022年，美国运营商将淘汰老旧的第三代蜂窝网络，为超高速的第五代移动通信（5G）腾出更多空间。没错，这意味着那些3G设备很快就会变成一堆废铁。（美国电话电报公司AT&amp;T的3G服务结束日期为2022年2月，T-Mobile和Verizon分別为7月和12月。）</p>
<p>这些电信公司计划在未来一年扩大网络。T-Mobile说，到2022年年底时，它的服务将再覆盖5,000万美国人。享受5G服务的不仅只有手机。移动运营商正在固话运营商无法提供宽带的地方，利用5G网络提供家用互联网服务。2021年9月，T-Mobile将业务扩展到佛罗里达州和北卡罗来纳州的一些城市，Verizon则将加州佛里蒙特（Fremont）和纽约州尼亚加拉瀑布城（Niagara Falls）纳入了自己的5G家用网络。</p>
<p>不管是家用网络还是移动端网络，我们的网速都很有可能变得更快，尽管这当中也会有一些「减速带」。美国总统拜登（Biden）的基建法案已於2021年11月获得通过，虽然其中包括了用于扩大农村地区宽带接入的650亿美元资金，但各州若想拿到这笔钱，还需经过漫长的申请过程。此外，AT&amp;T和Verizon近日在铺设5G网络的过程中也遇到了阻碍，因为美国航空管理局（Federal Aviation Administration，简称FAA）担心驾驶舱安全系统可能受到干扰。</p>
<h2 id="加密货币不再小众"><a href="#加密货币不再小众" class="headerlink" title="加密货币不再小众"></a>加密货币不再小众</h2><p>当人们谈论加密货币和非同质化代币（NFT）时，你表面上点头附和，其实心里在想，关于去中心化网络和区块链的种种讨论都会是过眼云烟。抱歉，你想错了。事实上在2022年，你已在使用的应用程式、服务和游戏中会出现购买、出售和转账数字货币及代币的工具，如此一来，你或许已经置身其间了。</p>
<p>目前，PayPal的应用程式Venmo和支付公司Block（前身为Square）旗下Cash App都提供了便捷的加密货币购买及转账方式。Cash App最近还新增了一项简易功能，可以通过借记卡向任意美国用户提供比特币。越来越多的购物场所也将开始接受你最喜爱的加密货币。眼下，特斯拉（Tesla）的某些特定商品就可以接受狗狗币支付。</p>
<p>你会加入像DeSo这样由区块链技术支撑的去中心化社交媒体网站吗？也许不会，但现有的社交媒体应用程式可能会开始拥抱这个世界。Instagram负责人莫塞里说，Instagram正在「积极探索NFT，以及我们如何才能让更广泛的受众更容易接触到它们。」</p>
<h2 id="无人机送货"><a href="#无人机送货" class="headerlink" title="无人机送货"></a>无人机送货</h2><p>今年你可能会头一次收到由无人机投送的包裹，不过这取决於你所在的区域。</p>
<p>以色列初创公司Flytrex在北卡罗来纳州运营有三个配送站，它刚刚获得FAA批准，可以在方圆1英里（约1.6公里）左右的范围内利用无人机送货。该公司说，获得此项授权后，它可以为包括沃尔玛（Walmart）在内的多家零售商，面向1万多户家庭提供送货服务。Google母公司Alphabet Inc.旗下Wing Aviation去年10月表示，它正在对无人机送货进行测试，预计2022年将在人口稠密的城市地区——达拉斯-沃斯堡（Dallas-Ft. Worth）——首次推出商用无人机送货服务。</p>
<p>与此同时，未来一年中，综合医疗服务提供商与产品生产商嘉德诺（Cardinal Health）将通过一种特殊的无人机——Zipline制造的小型固定翼飞机——向北卡罗来纳州坎纳波利斯（Kannapolis）一处配送中心方圆10英里（约16公里）内的药店提供补给。Zipline说，它还在沃尔玛总部所在地阿肯色州本顿维尔（Bentonville）为该公司提供送货上门服务。</p>
<p>根据FAA的规定，所有这些无人机将继续由人类操控。</p>
<p>随着FAA发放的许可越来越多，加之亚马逊、联合包裹速递服务公司（UPS）及其他十余家公司的无人机也都跃跃欲试，2022年可能会有更多企业竞相跟进。</p>
<p>英文原文：<a target="_blank" rel="noopener" href="https://www.wsj.com/articles/tech-that-will-change-your-life-in-2022-11640613604?mod=flipboard">Tech That Will Change Your Life in 2022</a></p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://theinitium.com/article/20220116-wsj-tech-that-will-change-your-life-in-2022/">https://theinitium.com/article/20220116-wsj-tech-that-will-change-your-life-in-2022/</a></p>
<p>端传媒：<a target="_blank" rel="noopener" href="https://theinitium.com/misc/about/">https://theinitium.com/misc/about/</a></p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!-- 
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/repost/" rel="tag">repost</a></li></ul>
    </div>
 -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-pgsql调优转载" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/3990369431.html" class="article-date">
      <time datetime="2022-04-13T07:11:42.000Z" itemprop="datePublished">2022-04-13</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/3990369431.html">pgsql调优转载</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>2022-4-13 更新—————-</p>
<p><img src="../img/image-20220413200329988.png" alt="image-20220413200329988"></p>
<p>select * from pg_tables where tablename like ‘pg_temp%’;</p>
<p>
                              
                          
                    
              <!-- 
              
              <p>2022-4-13 更新—————-</p>
<p><img src="../img/image-20220413200329988.png" alt="image-20220413200329988"></p>
<p>select * from pg_tables where tablename like ‘pg_temp%’;</p>
<p>不会有对应的表</p>
<p>select * from pg_namespace where nspname like ‘pg%temp%’;</p>
<p>但是会床创建临时的scheme</p>
<p>持续更新 —————————–</p>
<p><a target="_blank" rel="noopener" href="http://postgres.cn/docs/10/monitoring-stats.html#PG-STAT-ALL-TABLES-VIEW">官方文档</a></p>
<p>根据进程可以查询命令执行的时间和效率</p>
<ul>
<li>查询耗时</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT procpid, START, now() - START AS lap, current_query  FROM ( SELECT backendid, pg_stat_get_backend_pid (S.backendid) AS procpid,</span><br><span class="line">pg_stat_get_backend_activity_start (S.backendid) AS START,pg_stat_get_backend_activity (S.backendid) AS current_query  FROM (SELECT</span><br><span class="line">pg_stat_get_backend_idset () AS backendid) AS S) AS S WHERE current_query &lt;&gt; &#39;&lt;IDLE&gt;&#39;  and procpid&#x3D;58762  ORDER BY lap DESC;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询连接 查询进程</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM pg_stat_activity  where pid&#x3D;&#x3D;?? and  query &#x3D;?? and </span><br></pre></td></tr></table></figure>

<ul>
<li>pg_stat_statements</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">修改postgresql.conf的shared_preload_libraries增加pg_stat_statements来载入</span><br><span class="line"></span><br><span class="line">③执行SQL启动插件：create extension pg_stat_statements;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>重置计数器（可选操作）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select pg_stat_reset();</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select pg_stat_statements_reset();</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用命令查看最耗时的SQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from pg_stat_statements order by total_time desc limit 5;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询读取Buffer次数最多的SQL，buffer次数多，可能是因为没有索引，也同时导致了cpu高。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from pg_stat_statements order by shared_blks_hit+shared_blks_read desc limit 5;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>获取后面的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">select to_char(trigger_start_time,&#39;YYYY-MM-DD 00:00:00&#39;)</span><br><span class="line">        as timePoint,sum(trigger_count) as totalCount from network_attack</span><br><span class="line">        where</span><br><span class="line">        trigger_start_time &gt;&#x3D; to_timestamp($1,&#39;yyyy-MM-dd hh24:mi:ss&#39;)</span><br><span class="line">        and trigger_start_time &lt;  to_timestamp($2,&#39;yyyy-MM-dd hh24:mi:ss&#39;)</span><br><span class="line">        group by timePoint</span><br><span class="line">        order by timePoint desc</span><br><span class="line">relid    oid    一个表的 OID</span><br><span class="line">schemaname    name    这个表所在的模式的名称</span><br><span class="line">relname    name    这个表的名称</span><br><span class="line">seq_scan    bigint    在这个表上发起的顺序扫描的次数</span><br><span class="line">seq_tup_read    bigint    被顺序扫描取得的活着的行的数量</span><br><span class="line">idx_scan    bigint    在这个表上发起的索引扫描的次数</span><br><span class="line">idx_tup_fetch    bigint    被索引扫描取得的活着的行的数量</span><br><span class="line">n_tup_ins    bigint    被插入的行数</span><br><span class="line">n_tup_upd    bigint    被更新的行数（包括 HOT 更新的行）</span><br><span class="line">n_tup_del    bigint    被删除的行数</span><br><span class="line">n_tup_hot_upd    bigint    被更新的 HOT 行数（即不要求独立索引更新的行更新）</span><br><span class="line">n_live_tup    bigint    活着的行的估计数量</span><br><span class="line">n_dead_tup    bigint    死亡行的估计数量</span><br><span class="line">n_mod_since_analyze    bigint    从这个表最后一次被分析后备修改的行的估计数量</span><br><span class="line">last_vacuum    timestamp with time zone    上次这个表被手动清理的时间（不统计VACUUM FULL）</span><br><span class="line">last_autovacuum    timestamp with time zone    上次这个表被自动清理守护进程清理的时间</span><br><span class="line">last_analyze    timestamp with time zone    上次这个表被手动分析的时间</span><br><span class="line">last_autoanalyze    timestamp with time zone    上次这个表被自动清理守护进程分析的时间</span><br><span class="line">vacuum_count    bigint    这个表已被手工清理的次数（不统计VACUUM FULL）</span><br><span class="line">autovacuum_count    bigint    这个表已被自动清理守护进程清理的次数</span><br><span class="line">analyze_count    bigint    这个表已被手工分析的次数</span><br><span class="line">autoanalyze_count    bigint    这个表已被自动清理守护进程分析的次数</span><br></pre></td></tr></table></figure>

<p>seq_tup_read 远大于 idx_tup_fetch 说明索引建的有问题</p>
<p>n_tup_upd 说明有频繁更新的动作</p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-maven 从pom.xml 下载jar包" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/1868978831.html" class="article-date">
      <time datetime="2022-04-12T05:12:35.000Z" itemprop="datePublished">2022-04-12</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/1868978831.html">maven 从pom.xml 下载jar包</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>打包会有问题</p>
<p>root  lib-A</p>
<p>当前是需要直接打root的jar包，但是lib包下面有直接引用的本地jar并不在maven仓库当中使用如下</p>
<p>
                              
                          
                    
              <!-- 
              
              <p>打包会有问题</p>
<p>root  lib-A</p>
<p>当前是需要直接打root的jar包，但是lib包下面有直接引用的本地jar并不在maven仓库当中使用如下</p>
<p>格式如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.shentong<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pinyinAnalyzer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>system<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">systemPath</span>&gt;</span>$&#123;pom.basedir&#125;/src/main/resources/lib/pinyinAnalyzer4.3.1.jar<span class="tag">&lt;/<span class="name">systemPath</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>打包中如果有测试代码编译不通过的可用参考添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">testFailureIgnore</span>&gt;</span>true<span class="tag">&lt;/<span class="name">testFailureIgnore</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我后面发现打的jar包lib文件夹下面的确是有lib-A项目，但是啊就是跑的后面一旦涉及引用lib-A下面的本地第三方jar就说类找不到网上有人给出如下解决方案</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">includeSystemScope</span>&gt;</span>true<span class="tag">&lt;/<span class="name">includeSystemScope</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我分别在lib-A和root项目下添加了，神奇的事发生了，打包的后服务可以运行，但是lib-A下面的controller全都没有，对应的请求都是404，人都快裂开了</p>
<p>只能排除法先注释root下发现不行，后面注释lib-A下居然成功了，真TMD邪门</p>
<p>补充maven install 包含外部jar的打包情况——-</p>
<p>参考链接</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5597099/maven-add-jars-through-systempath-system-but-not-added-to-war-or-anywhere-else/5597277">java - Maven add jars through systemPath/system but not added to war or anywhere else - Stack Overflow</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/lyd135364/article/details/90664373">Maven package 时出现should not point at files within the project directory_隐0士的博客-CSDN博客</a></li>
</ul>
<p>在maven的pom文件中引用本地的jar</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.belerweb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pinyin4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;scope&gt;system&lt;/scope&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;systemPath&gt;$&#123;project.basedir&#125;/src/main/resources/lib/pinyin4j-2.5.0.jar&lt;/systemPath&gt;--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">systemPath</span>&gt;</span>$&#123;pom.basedir&#125;/src/main/resources/lib/pinyin4j-2.5.1.jar<span class="tag">&lt;/<span class="name">systemPath</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是打包时会报错</p>
<blockquote>
<p>should not point at files within the project directory dependencies.dependency.systemPath</p>
</blockquote>
<p>在stackoverflow上有两种方式</p>
<p>第一种是pom中添加jar所在文件夹的仓库</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">id</span>&gt;</span>localrepository<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">url</span>&gt;</span>file://$&#123;project.basedir&#125;/src/main/resources/lib<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是在打包的时候还是会出问题</p>
<p>第二种使用plugin来实现</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-install-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">phase</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                     <span class="comment">&lt;!-- &lt;goals&gt;</span></span><br><span class="line"><span class="comment">                          &lt;goal&gt;copy-dependencies&lt;/goal&gt;</span></span><br><span class="line"><span class="comment">                      &lt;/goals&gt;--&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.belerweb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pinyin4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;pom.basedir&#125;/src/main/resources/lib/pinyinAnalyzer4.3.1.jar<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>tips 下面的两种尝试过失败也列出来</p>
<ol>
<li><p>使用configuration复制来自于网络和正确的配置有出入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">id</span>&gt;</span>pinyin4j<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">phase</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;pom.basedir&#125;/src/main/resources/lib/pinyin4j-2.5.0.jar<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">repositoryLayout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">repositoryLayout</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.belerweb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pinyin4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">generatePom</span>&gt;</span>true<span class="tag">&lt;/<span class="name">generatePom</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                             <span class="tag">&lt;<span class="name">goal</span>&gt;</span>pinyin4j<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                         <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li><p>使用<phase>clean</phase></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">id</span>&gt;</span>pinyinAnalyzer<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">phase</span>&gt;</span>clean<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;pom.basedir&#125;/src/main/resources/lib/pinyinAnalyzer4.3.1.jar<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">repositoryLayout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">repositoryLayout</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.shentong<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pinyinAnalyzer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">generatePom</span>&gt;</span>true<span class="tag">&lt;/<span class="name">generatePom</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                             <span class="tag">&lt;<span class="name">goal</span>&gt;</span>install-file<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                         <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="3">
<li><p>使用phase&gt;init&lt;/phase</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">id</span>&gt;</span>pinyinAnalyzer<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">phase</span>&gt;</span>init<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;pom.basedir&#125;/src/main/resources/lib/pinyinAnalyzer4.3.1.jar<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">repositoryLayout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">repositoryLayout</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.shentong<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pinyinAnalyzer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">generatePom</span>&gt;</span>true<span class="tag">&lt;/<span class="name">generatePom</span>&gt;</span></span><br><span class="line">                   hconfiguration&gt;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                             <span class="tag">&lt;<span class="name">goal</span>&gt;</span>install-file<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                         <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br></pre></td></tr></table></figure>













</li>
</ol>
<p> 之前一直用IntelliJ IDEA 的直接下载jar包,但是这次一直下载不下来指定版本jar包,看本地的代码库localRepository本地没有,看本地部署的maven中心,所以使用了<a target="_blank" rel="noopener" href="https://blog.csdn.net/u011561335/article/details/80322960">参考地址</a></p>
<ol>
<li>创建pom.xml 文件</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>Spider<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Spider<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>使用mvn命令 下载后在本地仓库看到, 然后在IntelliJ IDEA刷新</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn dependency:copy-dependencies</span><br></pre></td></tr></table></figure>


               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!-- 
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/maven/" rel="tag">maven</a></li></ul>
    </div>
 -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/8/"> 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/10/">下一页 </a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2025 leek
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by leek <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//lf6-cdn-tos.bytecdntp.com/cdn/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-144246563-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
             tags: ".article-tag a", 
             categories: ".article-category a, a.tag-list-link", 
            
            
            
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "(つェ⊂) 我藏好了哦~ " + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "(*´∇｀*) 被你发现啦~ " + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>