<!DOCTYPE html>
<html lang="zh-cn">
<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="leek" />


    
     
        <meta name="google-site-verification" content="Vl02j4hnvtN2AJ3EfPjyvrHb191mbrnVtUlHgPUKBp0" />
    


<meta property="og:type" content="website">
<meta property="og:title" content="leek 自留地">
<meta property="og:url" content="https://imlike.cc/page/14/index.html">
<meta property="og:site_name" content="leek 自留地">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="leek">
<meta name="twitter:card" content="summary">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="leek 自留地" type="application/atom+xml">



    <link rel="shortcut icon" href="pics/g.jpg">



    <link href="//lf6-cdn-tos.bytecdntp.com/cdn/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//lf6-cdn-tos.bytecdntp.com/cdn/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//lf6-cdn-tos.bytecdntp.com/cdn/pace/1.0.2/pace.min.js"></script>
    <link href="//lf6-cdn-tos.bytecdntp.com/cdn/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">



    <!-- 注释 -->
    <!-- <style> .article { opacity: 0;} </style> -->


<link href="//lf6-cdn-tos.bytecdntp.com/cdn/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>leek 自留地</title>

<script src="//lf6-cdn-tos.bytecdntp.com/cdn/jquery/2.2.4/jquery.min.js"></script>
<script src="//lf6-cdn-tos.bytecdntp.com/cdn/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//lf6-cdn-tos.bytecdntp.com/cdn/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//lf6-cdn-tos.bytecdntp.com/cdn/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 5.2.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="https://pic.superbed.cn/item/5c9f2d213a213b04176522d4" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="true" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:s@yandex.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" rel="noopener" href="https://github.com/bigleek" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Google" target="_blank" rel="noopener" href="https://plus.google.com/bigleekcode" title="Google"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yelee/" rel="tag">Yelee</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yilia/" rel="tag">Yilia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/activiti/" rel="tag">activiti</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/alist/" rel="tag">alist</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/axios/" rel="tag">axios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/binary/" rel="tag">binary</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ceph/" rel="tag">ceph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/clickhouse/" rel="tag">clickhouse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloud/" rel="tag">cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/container/" rel="tag">container</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deepin/" rel="tag">deepin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/" rel="tag">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsraech/" rel="tag">elasticsraech</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es6/" rel="tag">es6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flyio/" rel="tag">flyio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gdal/" rel="tag">gdal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gnome/" rel="tag">gnome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo%E4%B8%BB%E9%A2%98/" rel="tag">hexo主题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/intellj/" rel="tag">intellj</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdk/" rel="tag">jdk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jenkins/" rel="tag">jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kibana/" rel="tag">kibana</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kubernetes/" rel="tag">kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kuboard/" rel="tag">kuboard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nas/" rel="tag">nas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/no-ad/" rel="tag">no_ad</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/" rel="tag">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/onedrive/" rel="tag">onedrive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/orientDb/" rel="tag">orientDb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/post/" rel="tag">post</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postgres/" rel="tag">postgres</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/put/" rel="tag">put</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/repost/" rel="tag">repost</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spotify/" rel="tag">spotify</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/" rel="tag">springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springcloud/" rel="tag">springcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sublime/" rel="tag">sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thunderbolt/" rel="tag">thunderbolt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vmware/" rel="tag">vmware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vpn/" rel="tag">vpn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue-cli/" rel="tag">vue-cli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webdav/" rel="tag">webdav</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wine/" rel="tag">wine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yandex/" rel="tag">yandex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zsh/" rel="tag">zsh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E6%92%AD/" rel="tag">云播</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" rel="tag">内网穿透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A0%E9%80%9F/" rel="tag">加速</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9D%9A%E6%9E%9C%E4%BA%91/" rel="tag">坚果云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%9F%E5%90%8D/" rel="tag">域名</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A9%E7%BF%BC%E4%BA%91/" rel="tag">天翼云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91/" rel="tag">开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%A8%E8%8D%90/" rel="tag">推荐</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%90%9C%E7%8B%97%E8%BE%93%E5%85%A5%E6%B3%95/" rel="tag">搜狗输入法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%90%AC%E5%AE%B6/" rel="tag">搬家</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" rel="tag">树莓派</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86/" rel="tag">知识管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%AB%99/" rel="tag">网站</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/" rel="tag">腾讯云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%86%E9%A2%91%E6%B5%81/" rel="tag">视频流</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B5%84%E6%BA%90/" rel="tag">资源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag">转载</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6/" rel="tag">软件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6%E9%85%8D%E7%BD%AE/" rel="tag">软件配置</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1/" rel="tag">邮件服务</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://imlike.cc/page.html">镜像网站导航</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://imcyc.cn/">Morty</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">平时零散的知识</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="https://pic.superbed.cn/item/5c9f2d213a213b04176522d4" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:s@yandex.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/bigleek" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Google" target="_blank" href="https://plus.google.com/bigleekcode" title="Google"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-ue4-pack-android" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/54f728db.html" class="article-date">
      <time datetime="2021-07-07T08:15:57.000Z" itemprop="datePublished">2021-07-07</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/54f728db.html">ue4安卓打包</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><h2 id="ue4安卓预制环境"><a href="#ue4安卓预制环境" class="headerlink" title="ue4安卓预制环境"></a>ue4安卓预制环境</h2><p>硬件要求</p>
<h3 id="支持的最低GPU"><a href="#支持的最低GPU" class="headerlink" title="支持的最低GPU"></a>支持的最低GPU</h3><p>自4.25版起，以下GPU满足ES3.1的上述要求：</p>
<ul>
<p>
                              
                          
                    
              <!-- 
              
              <h2 id="ue4安卓预制环境"><a href="#ue4安卓预制环境" class="headerlink" title="ue4安卓预制环境"></a>ue4安卓预制环境</h2><p>硬件要求</p>
<h3 id="支持的最低GPU"><a href="#支持的最低GPU" class="headerlink" title="支持的最低GPU"></a>支持的最低GPU</h3><p>自4.25版起，以下GPU满足ES3.1的上述要求：</p>
<ul>
<li>Adreno 4xx</li>
<li>Mali T6xx和更高版本</li>
<li>Mali G71和更高版本</li>
<li>PowerVR Rogue G6100</li>
</ul>
<p>下载安装安装开发SDK</p>
<p><a target="_blank" rel="noopener" href="https://developer.nvidia.com/codeworks-android-archive">https://developer.nvidia.com/codeworks-android-archive</a></p>
<p>选择 CodeWorks-1R7-windows_b166.exe 版本来实现</p>
<p><img src="../img/image-20210707111300230.png" alt="image-20210707111300230"></p>
<p>创建好的服务</p>
<p><img src="../img/image-20210707103723169.png" alt="image-20210707103723169"></p>
<p>配置安卓服务</p>
<p><img src="../img/image-20210707103812966.png" alt="image-20210707103812966"></p>
<p>设置层级为安卓</p>
<p><img src="../img/image-20210707103855145.png" alt="image-20210707103855145"></p>
<p>安装安卓sdk</p>
<p><img src="../img/image-20210707124854167.png" alt="image-20210707124854167"></p>
<p>ERROR: Android toolchain NDK r15c not supported; please use NDK r21 to NDK r23 (NDK r21b recommended)</p>
<p>UATHelper: Packaging (Android (ETC2)): &gt; Task :app:compileDebugJavaWithJavac FAILED<br>UATHelper: Packaging (Android (ETC2)): The following annotation processors are not incremental: compiler-1.1.1.jar (android.arch.lifecycle:compiler:1.1.1).<br>UATHelper: Packaging (Android (ETC2)): Make sure all annotation processors are incremental to improve your build speed.<br>UATHelper: Packaging (Android (ETC2)): Z:\app\src\main\java\com\epicgames\ue4\GameActivity.java:3531: ����: �Ҳ�������<br>UATHelper: Packaging (Android (ETC2)):             powerManager.addThermalStatusListener(getMainExecutor(), new PowerManager.OnThermalStatusChangedListener() {<br>UATHelper: Packaging (Android (ETC2)): 32 actionable tasks: 3 executed, 29 up-to-date<br>UATHelper: Packaging (Android (ETC2)):                                                                                      ^<br>UATHelper: Packaging (Android (ETC2)):   ����:   �� OnThermalStatusChangedListener<br>UATHelper: Packaging (Android (ETC2)):   λ��: �� PowerManager<br>UATHelper: Packaging (Android (ETC2)): ע: ĳЩ�����ļ�ʹ�û򸲸����ѹ�ʱ�� API��<br>UATHelper: Packaging (Android (ETC2)): ע: �й���ϸ��Ϣ, ��ʹ�� -Xlint:deprecation ���±��롣<br>UATHelper: Packaging (Android (ETC2)): 1 ������<br>UATHelper: Packaging (Android (ETC2)): FAILURE: Build failed with an exception.<br>UATHelper: Packaging (Android (ETC2)): * What went wrong:<br>UATHelper: Packaging (Android (ETC2)): Execution failed for task ‘:app:compileDebugJavaWithJavac’.<br>UATHelper: Packaging (Android (ETC2)): &gt; Compilation failed; see the compiler error output for details.<br>UATHelper: Packaging (Android (ETC2)): * Try:<br>UATHelper: Packaging (Android (ETC2)): Run with –stacktrace option to get the stack trace. Run with –info or –debug option to get more log output. Run with –scan to get full insights.<br>UATHelper: Packaging (Android (ETC2)): * Get more help at <a target="_blank" rel="noopener" href="https://help.gradle.org/">https://help.gradle.org</a><br>UATHelper: Packaging (Android (ETC2)): BUILD FAILED in 8s</p>
<p>需要安装Android_studio同时安装sdk</p>
<p><img src="../img/image-20210707161238758.png" alt="image-20210707161238758"></p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-sublime-shortcut" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/29702c78.html" class="article-date">
      <time datetime="2021-07-04T01:24:36.000Z" itemprop="datePublished">2021-07-04</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/29702c78.html">sublime_shortcut</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>link: <a target="_blank" rel="noopener" href="https://blog.csdn.net/lol_IP/article/details/82416020">https://blog.csdn.net/lol_IP/article/details/82416020</a><br>第一步：选中全部内容</p>
<p>ctrl+A<br>第二步：进入待操作状态</p>
<p>ctrl+shift+L<br>第三步：通过←和→控制光标的位置</p>
<p>
                              
                          
                    
              <!-- 
              
              <p>link: <a target="_blank" rel="noopener" href="https://blog.csdn.net/lol_IP/article/details/82416020">https://blog.csdn.net/lol_IP/article/details/82416020</a><br>第一步：选中全部内容</p>
<p>ctrl+A<br>第二步：进入待操作状态</p>
<p>ctrl+shift+L<br>第三步：通过←和→控制光标的位置</p>
<p>第四步：在光标处添加内容</p>
<p>注：也可以只对多行进行操作，对多行进行操作只需在第一步选择相应的行就可以了</p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python-download-offline-html" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/1a58ae58.html" class="article-date">
      <time datetime="2021-06-23T14:29:34.000Z" itemprop="datePublished">2021-06-23</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/1a58ae58.html">python下载离线的网页以 gitbook上的某个页面</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>先上代码 本代码有参考</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/gorquanwu/article/details/81739589">https://blog.csdn.net/gorquanwu/article/details/81739589</a> 这篇文章去实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># author: leek</span></span><br><span class="line"><span class="comment"># date：2021-6-23</span></span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup <span class="keyword">as</span> bs</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    用来爬取网站网页  gitbook 页面 离线下载到本地</span></span><br><span class="line"><span class="string">    实现功能：url深度抓取，保存每个页面的css、html、js等文件</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深度爬取当前页面子网站子网站</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_urls</span>(<span class="params">url, baseurl, urls</span>):</span></span><br><span class="line">    <span class="keyword">with</span> request.urlopen(url) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="comment"># link = bs(data).find_all(&#x27;a&#x27;)</span></span><br><span class="line">        link = bs(data).find(<span class="string">&quot;nav&quot;</span>).find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> link:</span><br><span class="line">            suffix = i.get(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">            <span class="comment"># 设置排除写入的子连接</span></span><br><span class="line">            <span class="keyword">if</span> suffix == <span class="string">&#x27;#&#x27;</span> <span class="keyword">or</span> suffix == <span class="string">&#x27;#carousel-example-generic&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;javascript:void(0)&#x27;</span> <span class="keyword">in</span> suffix:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 构建urls</span></span><br><span class="line">                childurl = baseurl +<span class="string">&quot;/&quot;</span>+ suffix</span><br><span class="line">                <span class="keyword">if</span> childurl <span class="keyword">not</span> <span class="keyword">in</span> urls:</span><br><span class="line">                    urls.append(childurl)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取每个页面代码以及获取页面上的css，js，img路径</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_source</span>(<span class="params">url, path</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> request.urlopen(url) <span class="keyword">as</span> f:</span><br><span class="line">            html_source = f.read().decode()</span><br><span class="line">            <span class="comment"># 添加时间截以区分文件夹名字</span></span><br><span class="line">            timeStr = <span class="built_in">str</span>(<span class="built_in">int</span>(time.time()))</span><br><span class="line">            pattertitile = <span class="string">&#x27;&lt;title&gt;(.*?)&lt;/title&gt;&#x27;</span></span><br><span class="line">            patternimg = <span class="string">&#x27;&lt;img src=&quot;(.*?)&quot;&#x27;</span></span><br><span class="line">            titleStr = re.<span class="built_in">compile</span>(pattertitile, re.S).findall(html_source)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;|&#x27;</span> <span class="keyword">in</span> titleStr:</span><br><span class="line">                title = (titleStr.split(<span class="string">&quot;|&quot;</span>)[<span class="number">1</span>]).split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>] + timeStr</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                title = titleStr + timeStr</span><br><span class="line"></span><br><span class="line">            path11 = path + <span class="string">&#x27;/&#x27;</span> + title</span><br><span class="line">            arrayurl= url.split(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">            htmlFile = path</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="built_in">len</span>(arrayurl)):</span><br><span class="line">                htmlFile  +=(<span class="string">&quot;/&quot;</span>+arrayurl[x])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 获取css，js，img地址</span></span><br><span class="line">            imgHref = re.<span class="built_in">compile</span>(patternimg, re.S).findall(html_source)</span><br><span class="line">            <span class="comment"># 创建文件路径下的父节点</span></span><br><span class="line">            os.makedirs(os.path.abspath(htmlFile + os.path.sep + <span class="string">&quot;..&quot;</span>), exist_ok=<span class="literal">True</span>)</span><br><span class="line">            <span class="comment"># 读取并保存html</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(htmlFile, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(html_source)</span><br><span class="line">            print(htmlFile+ <span class="string">&quot;文件保存成功&quot;</span>)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(url + <span class="string">&quot;保存html文件时报错&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存js文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_css_js</span>(<span class="params">path</span>):</span></span><br><span class="line">        url = <span class="string">&quot;http://sdk.g-bim.cn&quot;</span></span><br><span class="line">        filename = path</span><br><span class="line">        <span class="keyword">with</span> request.urlopen(url) <span class="keyword">as</span> total_html:</span><br><span class="line">            html_source = total_html.read().decode()</span><br><span class="line">            jsHref = re.<span class="built_in">compile</span>(<span class="string">&#x27;&lt;script src=&quot;(.*?)&quot;&#x27;</span>, re.S).findall(html_source)</span><br><span class="line">            cssHref = re.<span class="built_in">compile</span>( <span class="string">&#x27;&lt;link rel=&quot;stylesheet&quot; href=&quot;(.*?)&quot;&#x27;</span>, re.S).findall(html_source)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> jsHref :</span><br><span class="line">               <span class="keyword">try</span>:</span><br><span class="line">                   <span class="keyword">with</span> request.urlopen(url+<span class="string">&quot;/&quot;</span>+j) <span class="keyword">as</span> ww:</span><br><span class="line">                       js_source = ww.read().decode()</span><br><span class="line">                       <span class="comment"># filename =(path+&#x27;\\&#x27;+ j).replace(&#x27;/&#x27;,&#x27;\\&#x27;) os.getcwd()</span></span><br><span class="line">                       filename =path+j</span><br><span class="line">                       os.makedirs(os.path.abspath(filename+os.path.sep+<span class="string">&quot;..&quot;</span>), exist_ok=<span class="literal">True</span>)</span><br><span class="line">                       <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                           f.write(js_source)</span><br><span class="line">                       print(j.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; js文件保存成功&quot;</span>)</span><br><span class="line">                       time.sleep(<span class="number">1</span>)</span><br><span class="line">               <span class="keyword">except</span>:</span><br><span class="line">                   print(<span class="string">&quot;该&quot;</span> + j.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; js文件无法下载&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> cssHref:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">with</span> request.urlopen(url+<span class="string">&quot;/&quot;</span>+k) <span class="keyword">as</span> vv:</span><br><span class="line">                        filename = path+ k</span><br><span class="line">                        js_source = vv.read().decode()</span><br><span class="line">                        os.makedirs(os.path.abspath(filename + os.path.sep + <span class="string">&quot;..&quot;</span>), exist_ok=<span class="literal">True</span>)</span><br><span class="line">                        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                            f.write(js_source)</span><br><span class="line">                        print(k.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; js文件保存成功&quot;</span>)</span><br><span class="line">                        time.sleep(<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    print(<span class="string">&quot;该&quot;</span> + k.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; js文件无法下载&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存img文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_img</span>(<span class="params">href, path</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(href)):</span><br><span class="line">        url = <span class="string">&quot;http://sdk.g-bim.cn&quot;</span> + href[i]</span><br><span class="line">        filename = path + <span class="string">&#x27;\\&#x27;</span> + href[i].split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> request.urlopen(url) <span class="keyword">as</span> w:</span><br><span class="line">                img_source = w.read()</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(img_source)</span><br><span class="line">                print(href[i].split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; 图像文件保存成功&quot;</span>)</span><br><span class="line">                time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">&quot;该&quot;</span> + href[i].split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; 图像无法下载&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 抓取网址</span></span><br><span class="line">    url = <span class="string">&#x27;http://sdk.g-bim.cn&#x27;</span></span><br><span class="line">    <span class="comment"># 相对路径地址</span></span><br><span class="line">    baseurl = <span class="string">&#x27;http://sdk.g-bim.cn&#x27;</span></span><br><span class="line">    <span class="comment"># 文件保存位置</span></span><br><span class="line">    basedir = <span class="string">r&#x27;C:\Users\Administrator\Desktop\HTML_bak&#x27;</span></span><br><span class="line">    urls = []</span><br><span class="line">    <span class="comment"># 获取所有地址</span></span><br><span class="line">    get_urls(url, baseurl, urls)</span><br><span class="line">    <span class="comment"># save_css_js(r&#x27;../html_bak/&#x27;)</span></span><br><span class="line">    <span class="comment"># 获取代码</span></span><br><span class="line">    <span class="keyword">for</span> u <span class="keyword">in</span> urls:</span><br><span class="line">        get_source(u,<span class="string">r&#x27;../html_bak&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>
                              
                          
                    
              <!-- 
              
              <p>先上代码 本代码有参考</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/gorquanwu/article/details/81739589">https://blog.csdn.net/gorquanwu/article/details/81739589</a> 这篇文章去实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># author: leek</span></span><br><span class="line"><span class="comment"># date：2021-6-23</span></span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup <span class="keyword">as</span> bs</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    用来爬取网站网页  gitbook 页面 离线下载到本地</span></span><br><span class="line"><span class="string">    实现功能：url深度抓取，保存每个页面的css、html、js等文件</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深度爬取当前页面子网站子网站</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_urls</span>(<span class="params">url, baseurl, urls</span>):</span></span><br><span class="line">    <span class="keyword">with</span> request.urlopen(url) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="comment"># link = bs(data).find_all(&#x27;a&#x27;)</span></span><br><span class="line">        link = bs(data).find(<span class="string">&quot;nav&quot;</span>).find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> link:</span><br><span class="line">            suffix = i.get(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">            <span class="comment"># 设置排除写入的子连接</span></span><br><span class="line">            <span class="keyword">if</span> suffix == <span class="string">&#x27;#&#x27;</span> <span class="keyword">or</span> suffix == <span class="string">&#x27;#carousel-example-generic&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;javascript:void(0)&#x27;</span> <span class="keyword">in</span> suffix:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 构建urls</span></span><br><span class="line">                childurl = baseurl +<span class="string">&quot;/&quot;</span>+ suffix</span><br><span class="line">                <span class="keyword">if</span> childurl <span class="keyword">not</span> <span class="keyword">in</span> urls:</span><br><span class="line">                    urls.append(childurl)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取每个页面代码以及获取页面上的css，js，img路径</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_source</span>(<span class="params">url, path</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> request.urlopen(url) <span class="keyword">as</span> f:</span><br><span class="line">            html_source = f.read().decode()</span><br><span class="line">            <span class="comment"># 添加时间截以区分文件夹名字</span></span><br><span class="line">            timeStr = <span class="built_in">str</span>(<span class="built_in">int</span>(time.time()))</span><br><span class="line">            pattertitile = <span class="string">&#x27;&lt;title&gt;(.*?)&lt;/title&gt;&#x27;</span></span><br><span class="line">            patternimg = <span class="string">&#x27;&lt;img src=&quot;(.*?)&quot;&#x27;</span></span><br><span class="line">            titleStr = re.<span class="built_in">compile</span>(pattertitile, re.S).findall(html_source)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;|&#x27;</span> <span class="keyword">in</span> titleStr:</span><br><span class="line">                title = (titleStr.split(<span class="string">&quot;|&quot;</span>)[<span class="number">1</span>]).split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>] + timeStr</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                title = titleStr + timeStr</span><br><span class="line"></span><br><span class="line">            path11 = path + <span class="string">&#x27;/&#x27;</span> + title</span><br><span class="line">            arrayurl= url.split(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">            htmlFile = path</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="built_in">len</span>(arrayurl)):</span><br><span class="line">                htmlFile  +=(<span class="string">&quot;/&quot;</span>+arrayurl[x])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 获取css，js，img地址</span></span><br><span class="line">            imgHref = re.<span class="built_in">compile</span>(patternimg, re.S).findall(html_source)</span><br><span class="line">            <span class="comment"># 创建文件路径下的父节点</span></span><br><span class="line">            os.makedirs(os.path.abspath(htmlFile + os.path.sep + <span class="string">&quot;..&quot;</span>), exist_ok=<span class="literal">True</span>)</span><br><span class="line">            <span class="comment"># 读取并保存html</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(htmlFile, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(html_source)</span><br><span class="line">            print(htmlFile+ <span class="string">&quot;文件保存成功&quot;</span>)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(url + <span class="string">&quot;保存html文件时报错&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存js文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_css_js</span>(<span class="params">path</span>):</span></span><br><span class="line">        url = <span class="string">&quot;http://sdk.g-bim.cn&quot;</span></span><br><span class="line">        filename = path</span><br><span class="line">        <span class="keyword">with</span> request.urlopen(url) <span class="keyword">as</span> total_html:</span><br><span class="line">            html_source = total_html.read().decode()</span><br><span class="line">            jsHref = re.<span class="built_in">compile</span>(<span class="string">&#x27;&lt;script src=&quot;(.*?)&quot;&#x27;</span>, re.S).findall(html_source)</span><br><span class="line">            cssHref = re.<span class="built_in">compile</span>( <span class="string">&#x27;&lt;link rel=&quot;stylesheet&quot; href=&quot;(.*?)&quot;&#x27;</span>, re.S).findall(html_source)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> jsHref :</span><br><span class="line">               <span class="keyword">try</span>:</span><br><span class="line">                   <span class="keyword">with</span> request.urlopen(url+<span class="string">&quot;/&quot;</span>+j) <span class="keyword">as</span> ww:</span><br><span class="line">                       js_source = ww.read().decode()</span><br><span class="line">                       <span class="comment"># filename =(path+&#x27;\\&#x27;+ j).replace(&#x27;/&#x27;,&#x27;\\&#x27;) os.getcwd()</span></span><br><span class="line">                       filename =path+j</span><br><span class="line">                       os.makedirs(os.path.abspath(filename+os.path.sep+<span class="string">&quot;..&quot;</span>), exist_ok=<span class="literal">True</span>)</span><br><span class="line">                       <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                           f.write(js_source)</span><br><span class="line">                       print(j.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; js文件保存成功&quot;</span>)</span><br><span class="line">                       time.sleep(<span class="number">1</span>)</span><br><span class="line">               <span class="keyword">except</span>:</span><br><span class="line">                   print(<span class="string">&quot;该&quot;</span> + j.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; js文件无法下载&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> cssHref:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">with</span> request.urlopen(url+<span class="string">&quot;/&quot;</span>+k) <span class="keyword">as</span> vv:</span><br><span class="line">                        filename = path+ k</span><br><span class="line">                        js_source = vv.read().decode()</span><br><span class="line">                        os.makedirs(os.path.abspath(filename + os.path.sep + <span class="string">&quot;..&quot;</span>), exist_ok=<span class="literal">True</span>)</span><br><span class="line">                        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                            f.write(js_source)</span><br><span class="line">                        print(k.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; js文件保存成功&quot;</span>)</span><br><span class="line">                        time.sleep(<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    print(<span class="string">&quot;该&quot;</span> + k.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; js文件无法下载&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存img文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_img</span>(<span class="params">href, path</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(href)):</span><br><span class="line">        url = <span class="string">&quot;http://sdk.g-bim.cn&quot;</span> + href[i]</span><br><span class="line">        filename = path + <span class="string">&#x27;\\&#x27;</span> + href[i].split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> request.urlopen(url) <span class="keyword">as</span> w:</span><br><span class="line">                img_source = w.read()</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(img_source)</span><br><span class="line">                print(href[i].split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; 图像文件保存成功&quot;</span>)</span><br><span class="line">                time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">&quot;该&quot;</span> + href[i].split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">-1</span>] + <span class="string">&quot; 图像无法下载&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 抓取网址</span></span><br><span class="line">    url = <span class="string">&#x27;http://sdk.g-bim.cn&#x27;</span></span><br><span class="line">    <span class="comment"># 相对路径地址</span></span><br><span class="line">    baseurl = <span class="string">&#x27;http://sdk.g-bim.cn&#x27;</span></span><br><span class="line">    <span class="comment"># 文件保存位置</span></span><br><span class="line">    basedir = <span class="string">r&#x27;C:\Users\Administrator\Desktop\HTML_bak&#x27;</span></span><br><span class="line">    urls = []</span><br><span class="line">    <span class="comment"># 获取所有地址</span></span><br><span class="line">    get_urls(url, baseurl, urls)</span><br><span class="line">    <span class="comment"># save_css_js(r&#x27;../html_bak/&#x27;)</span></span><br><span class="line">    <span class="comment"># 获取代码</span></span><br><span class="line">    <span class="keyword">for</span> u <span class="keyword">in</span> urls:</span><br><span class="line">        get_source(u,<span class="string">r&#x27;../html_bak&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>期间有些问题</p>
<h3 id="读取文件是出现UnicodeDecodeError"><a href="#读取文件是出现UnicodeDecodeError" class="headerlink" title="读取文件是出现UnicodeDecodeError"></a>读取文件是出现UnicodeDecodeError</h3><p>UnicodeDecodeError: ‘gbk’ codec can’t decode byte 0x89 in position 14: illegal</p>
<p>open(‘order.log’,’r’, encoding=’UTF-8’) 尽量指定u8目前HTML的编码一般都是它避免乱码</p>
<h3 id="在python环境下window和Linux分隔符的区别"><a href="#在python环境下window和Linux分隔符的区别" class="headerlink" title="在python环境下window和Linux分隔符的区别"></a>在python环境下window和Linux分隔符的区别</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">path&#x3D;r&#39;..&#x2F;html_bak&#x2F;&#39;</span><br><span class="line"> with open(path, &#39;w&#39;, encoding&#x3D;&#39;UTF-8&#39;) as f:</span><br><span class="line"> </span><br><span class="line"> \\windows平台但是 加上r后 自动加 不用管全部用&#x2F;即可 在打开文件时会自动管理</span><br><span class="line"> https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_29831163&#x2F;article&#x2F;details&#x2F;106263729</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h3 id="读取指定文件路径下父文件夹如果不存在着直接新建"><a href="#读取指定文件路径下父文件夹如果不存在着直接新建" class="headerlink" title="读取指定文件路径下父文件夹如果不存在着直接新建"></a>读取指定文件路径下父文件夹如果不存在着直接新建</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.makedirs(os.path.abspath(filename+os.path.sep+&quot;..&quot;), exist_ok&#x3D;True)</span><br></pre></td></tr></table></figure>
               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-geomesa-input-error" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/null.html" class="article-date">
      <time datetime="2021-06-22T07:44:29.000Z" itemprop="datePublished">2021-06-22</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/null.html">geomesa-input-error</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>导入失败</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">ERROR java.lang.NoSuchMethodError: org.locationtech.jts.geom.Polygon.getExteriorRing()Lorg&#x2F;locationtech&#x2F;jts&#x2F;geom&#x2F;LineString;</span><br><span class="line">java.util.concurrent.ExecutionException: java.lang.NoSuchMethodError: org.locationtech.jts.geom.Polygon.getExteriorRing()Lorg&#x2F;locationtech&#x2F;jts&#x2F;geom&#x2F;LineString;</span><br><span class="line">	at java.util.concurrent.FutureTask.report(FutureTask.java:122)</span><br><span class="line">	at java.util.concurrent.FutureTask.get(FutureTask.java:192)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$$anonfun$runIngest$1.apply(LocalConverterIngest.scala:183)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$$anonfun$runIngest$1.apply(LocalConverterIngest.scala:183)</span><br><span class="line">	at scala.collection.immutable.List.foreach(List.scala:381)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest.runIngest(LocalConverterIngest.scala:183)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.AbstractConverterIngest.run(AbstractConverterIngest.scala:41)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.IngestCommand$$anonfun$execute$2.apply(IngestCommand.scala:106)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.IngestCommand$$anonfun$execute$2.apply(IngestCommand.scala:105)</span><br><span class="line">	at scala.Option.foreach(Option.scala:257)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.IngestCommand$class.execute(IngestCommand.scala:105)</span><br><span class="line">	at org.locationtech.geomesa.hbase.tools.HBaseRunner$$anon$2.execute(HBaseRunner.scala:32)</span><br><span class="line">	at org.locationtech.geomesa.tools.Runner$class.main(Runner.scala:30)</span><br><span class="line">	at org.locationtech.geomesa.hbase.tools.HBaseRunner$.main(HBaseRunner.scala:17)</span><br><span class="line">	at org.locationtech.geomesa.hbase.tools.HBaseRunner.main(HBaseRunner.scala)</span><br><span class="line">Caused by: java.lang.NoSuchMethodError: org.locationtech.jts.geom.Polygon.getExteriorRing()Lorg&#x2F;locationtech&#x2F;jts&#x2F;geom&#x2F;LineString;</span><br><span class="line">	at org.locationtech.geomesa.features.serialization.WkbSerialization$class.writePolygon(WkbSerialization.scala:121)</span><br><span class="line">	at org.locationtech.geomesa.features.serialization.WkbSerialization$class.serializeWkb(WkbSerialization.scala:45)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.serialization.KryoGeometrySerialization$.serializeWkb(KryoGeometrySerialization.scala:14)</span><br><span class="line">	at org.locationtech.geomesa.features.serialization.WkbSerialization$class.writeGeometryCollection(WkbSerialization.scala:176)</span><br><span class="line">	at org.locationtech.geomesa.features.serialization.WkbSerialization$class.serializeWkb(WkbSerialization.scala:48)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.serialization.KryoGeometrySerialization$.serializeWkb(KryoGeometrySerialization.scala:14)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.impl.KryoFeatureSerialization$KryoGeometryWkbWriter$.apply(KryoFeatureSerialization.scala:228)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.impl.KryoFeatureSerialization$class.writeFeature(KryoFeatureSerialization.scala:70)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.impl.KryoFeatureSerialization$class.serialize(KryoFeatureSerialization.scala:42)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.KryoFeatureSerializer$MutableActiveSerializer.serialize(KryoFeatureSerializer.scala:75)</span><br><span class="line">	at org.locationtech.geomesa.index.api.WritableFeature$FeatureLevelWritableFeature$$anonfun$values$1$$anonfun$apply$1.apply(WritableFeature.scala:154)</span><br><span class="line">	at org.locationtech.geomesa.index.api.WritableFeature$FeatureLevelWritableFeature$$anonfun$values$1$$anonfun$apply$1.apply(WritableFeature.scala:154)</span><br><span class="line">	at org.locationtech.geomesa.index.api.package$KeyValue.value$lzycompute(package.scala:184)</span><br><span class="line">	at org.locationtech.geomesa.index.api.package$KeyValue.value(package.scala:184)</span><br><span class="line">	at org.locationtech.geomesa.hbase.data.HBaseIndexAdapter$HBaseIndexWriter$$anonfun$write$1.apply(HBaseIndexAdapter.scala:614)</span><br><span class="line">	at org.locationtech.geomesa.hbase.data.HBaseIndexAdapter$HBaseIndexWriter$$anonfun$write$1.apply(HBaseIndexAdapter.scala:612)</span><br><span class="line">	at scala.collection.Iterator$class.foreach(Iterator.scala:742)</span><br><span class="line">	at scala.collection.AbstractIterator.foreach(Iterator.scala:1194)</span><br><span class="line">	at scala.collection.IterableLike$class.foreach(IterableLike.scala:72)</span><br><span class="line">	at scala.collection.AbstractIterable.foreach(Iterable.scala:54)</span><br><span class="line">	at org.locationtech.geomesa.hbase.data.HBaseIndexAdapter$HBaseIndexWriter.write(HBaseIndexAdapter.scala:612)</span><br><span class="line">	at org.locationtech.geomesa.index.api.IndexAdapter$BaseIndexWriter.write(IndexAdapter.scala:149)</span><br><span class="line">	at org.locationtech.geomesa.index.geotools.GeoMesaFeatureWriter$class.writeFeature(GeoMesaFeatureWriter.scala:52)</span><br><span class="line">	at org.locationtech.geomesa.index.geotools.GeoMesaFeatureWriter$TableFeatureWriter.writeFeature(GeoMesaFeatureWriter.scala:141)</span><br><span class="line">	at org.locationtech.geomesa.index.geotools.GeoMesaFeatureWriter$GeoMesaAppendFeatureWriter$class.write(GeoMesaFeatureWriter.scala:227)</span><br><span class="line">	at org.locationtech.geomesa.index.geotools.GeoMesaFeatureWriter$$anon$3.write(GeoMesaFeatureWriter.scala:108)</span><br><span class="line">	at org.locationtech.geomesa.utils.geotools.FeatureUtils$.write(FeatureUtils.scala:141)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4$$anonfun$apply$5$$anonfun$apply$6.apply(LocalConverterIngest.scala:117)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4$$anonfun$apply$5$$anonfun$apply$6.apply(LocalConverterIngest.scala:115)</span><br><span class="line">	at scala.collection.Iterator$class.foreach(Iterator.scala:742)</span><br><span class="line">	at org.locationtech.geomesa.utils.collection.CloseableIterator$FlatMapCloseableIterator.foreach(CloseableIterator.scala:133)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4$$anonfun$apply$5.apply(LocalConverterIngest.scala:115)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4$$anonfun$apply$5.apply(LocalConverterIngest.scala:109)</span><br><span class="line">	at org.locationtech.geomesa.utils.io.CloseablePool$CommonsPoolPool.borrow(CloseablePool.scala:68)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4.apply(LocalConverterIngest.scala:109)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4.apply(LocalConverterIngest.scala:108)</span><br><span class="line">	at org.locationtech.geomesa.utils.io.package$WithClose$.apply(package.scala:64)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2.apply(LocalConverterIngest.scala:108)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2.apply(LocalConverterIngest.scala:106)</span><br><span class="line">	at scala.collection.Iterator$class.foreach(Iterator.scala:742)</span><br><span class="line">	at org.locationtech.geomesa.utils.collection.CloseableIterator$CloseableSingleIterator.foreach(CloseableIterator.scala:86)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1.apply(LocalConverterIngest.scala:106)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1.apply(LocalConverterIngest.scala:105)</span><br><span class="line">	at org.locationtech.geomesa.utils.io.package$WithClose$.apply(package.scala:64)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1.apply(LocalConverterIngest.scala:105)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1.apply(LocalConverterIngest.scala:102)</span><br><span class="line">	at org.locationtech.geomesa.utils.io.CloseablePool$CommonsPoolPool.borrow(CloseablePool.scala:68)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1.run(LocalConverterIngest.scala:102)</span><br><span class="line">	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)</span><br><span class="line">	at java.util.concurrent.FutureTask.run(FutureTask.java:266)</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>
                              
                          
                    
              <!-- 
              
              <p>导入失败</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">ERROR java.lang.NoSuchMethodError: org.locationtech.jts.geom.Polygon.getExteriorRing()Lorg&#x2F;locationtech&#x2F;jts&#x2F;geom&#x2F;LineString;</span><br><span class="line">java.util.concurrent.ExecutionException: java.lang.NoSuchMethodError: org.locationtech.jts.geom.Polygon.getExteriorRing()Lorg&#x2F;locationtech&#x2F;jts&#x2F;geom&#x2F;LineString;</span><br><span class="line">	at java.util.concurrent.FutureTask.report(FutureTask.java:122)</span><br><span class="line">	at java.util.concurrent.FutureTask.get(FutureTask.java:192)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$$anonfun$runIngest$1.apply(LocalConverterIngest.scala:183)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$$anonfun$runIngest$1.apply(LocalConverterIngest.scala:183)</span><br><span class="line">	at scala.collection.immutable.List.foreach(List.scala:381)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest.runIngest(LocalConverterIngest.scala:183)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.AbstractConverterIngest.run(AbstractConverterIngest.scala:41)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.IngestCommand$$anonfun$execute$2.apply(IngestCommand.scala:106)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.IngestCommand$$anonfun$execute$2.apply(IngestCommand.scala:105)</span><br><span class="line">	at scala.Option.foreach(Option.scala:257)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.IngestCommand$class.execute(IngestCommand.scala:105)</span><br><span class="line">	at org.locationtech.geomesa.hbase.tools.HBaseRunner$$anon$2.execute(HBaseRunner.scala:32)</span><br><span class="line">	at org.locationtech.geomesa.tools.Runner$class.main(Runner.scala:30)</span><br><span class="line">	at org.locationtech.geomesa.hbase.tools.HBaseRunner$.main(HBaseRunner.scala:17)</span><br><span class="line">	at org.locationtech.geomesa.hbase.tools.HBaseRunner.main(HBaseRunner.scala)</span><br><span class="line">Caused by: java.lang.NoSuchMethodError: org.locationtech.jts.geom.Polygon.getExteriorRing()Lorg&#x2F;locationtech&#x2F;jts&#x2F;geom&#x2F;LineString;</span><br><span class="line">	at org.locationtech.geomesa.features.serialization.WkbSerialization$class.writePolygon(WkbSerialization.scala:121)</span><br><span class="line">	at org.locationtech.geomesa.features.serialization.WkbSerialization$class.serializeWkb(WkbSerialization.scala:45)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.serialization.KryoGeometrySerialization$.serializeWkb(KryoGeometrySerialization.scala:14)</span><br><span class="line">	at org.locationtech.geomesa.features.serialization.WkbSerialization$class.writeGeometryCollection(WkbSerialization.scala:176)</span><br><span class="line">	at org.locationtech.geomesa.features.serialization.WkbSerialization$class.serializeWkb(WkbSerialization.scala:48)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.serialization.KryoGeometrySerialization$.serializeWkb(KryoGeometrySerialization.scala:14)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.impl.KryoFeatureSerialization$KryoGeometryWkbWriter$.apply(KryoFeatureSerialization.scala:228)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.impl.KryoFeatureSerialization$class.writeFeature(KryoFeatureSerialization.scala:70)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.impl.KryoFeatureSerialization$class.serialize(KryoFeatureSerialization.scala:42)</span><br><span class="line">	at org.locationtech.geomesa.features.kryo.KryoFeatureSerializer$MutableActiveSerializer.serialize(KryoFeatureSerializer.scala:75)</span><br><span class="line">	at org.locationtech.geomesa.index.api.WritableFeature$FeatureLevelWritableFeature$$anonfun$values$1$$anonfun$apply$1.apply(WritableFeature.scala:154)</span><br><span class="line">	at org.locationtech.geomesa.index.api.WritableFeature$FeatureLevelWritableFeature$$anonfun$values$1$$anonfun$apply$1.apply(WritableFeature.scala:154)</span><br><span class="line">	at org.locationtech.geomesa.index.api.package$KeyValue.value$lzycompute(package.scala:184)</span><br><span class="line">	at org.locationtech.geomesa.index.api.package$KeyValue.value(package.scala:184)</span><br><span class="line">	at org.locationtech.geomesa.hbase.data.HBaseIndexAdapter$HBaseIndexWriter$$anonfun$write$1.apply(HBaseIndexAdapter.scala:614)</span><br><span class="line">	at org.locationtech.geomesa.hbase.data.HBaseIndexAdapter$HBaseIndexWriter$$anonfun$write$1.apply(HBaseIndexAdapter.scala:612)</span><br><span class="line">	at scala.collection.Iterator$class.foreach(Iterator.scala:742)</span><br><span class="line">	at scala.collection.AbstractIterator.foreach(Iterator.scala:1194)</span><br><span class="line">	at scala.collection.IterableLike$class.foreach(IterableLike.scala:72)</span><br><span class="line">	at scala.collection.AbstractIterable.foreach(Iterable.scala:54)</span><br><span class="line">	at org.locationtech.geomesa.hbase.data.HBaseIndexAdapter$HBaseIndexWriter.write(HBaseIndexAdapter.scala:612)</span><br><span class="line">	at org.locationtech.geomesa.index.api.IndexAdapter$BaseIndexWriter.write(IndexAdapter.scala:149)</span><br><span class="line">	at org.locationtech.geomesa.index.geotools.GeoMesaFeatureWriter$class.writeFeature(GeoMesaFeatureWriter.scala:52)</span><br><span class="line">	at org.locationtech.geomesa.index.geotools.GeoMesaFeatureWriter$TableFeatureWriter.writeFeature(GeoMesaFeatureWriter.scala:141)</span><br><span class="line">	at org.locationtech.geomesa.index.geotools.GeoMesaFeatureWriter$GeoMesaAppendFeatureWriter$class.write(GeoMesaFeatureWriter.scala:227)</span><br><span class="line">	at org.locationtech.geomesa.index.geotools.GeoMesaFeatureWriter$$anon$3.write(GeoMesaFeatureWriter.scala:108)</span><br><span class="line">	at org.locationtech.geomesa.utils.geotools.FeatureUtils$.write(FeatureUtils.scala:141)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4$$anonfun$apply$5$$anonfun$apply$6.apply(LocalConverterIngest.scala:117)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4$$anonfun$apply$5$$anonfun$apply$6.apply(LocalConverterIngest.scala:115)</span><br><span class="line">	at scala.collection.Iterator$class.foreach(Iterator.scala:742)</span><br><span class="line">	at org.locationtech.geomesa.utils.collection.CloseableIterator$FlatMapCloseableIterator.foreach(CloseableIterator.scala:133)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4$$anonfun$apply$5.apply(LocalConverterIngest.scala:115)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4$$anonfun$apply$5.apply(LocalConverterIngest.scala:109)</span><br><span class="line">	at org.locationtech.geomesa.utils.io.CloseablePool$CommonsPoolPool.borrow(CloseablePool.scala:68)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4.apply(LocalConverterIngest.scala:109)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2$$anonfun$apply$4.apply(LocalConverterIngest.scala:108)</span><br><span class="line">	at org.locationtech.geomesa.utils.io.package$WithClose$.apply(package.scala:64)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2.apply(LocalConverterIngest.scala:108)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1$$anonfun$apply$2.apply(LocalConverterIngest.scala:106)</span><br><span class="line">	at scala.collection.Iterator$class.foreach(Iterator.scala:742)</span><br><span class="line">	at org.locationtech.geomesa.utils.collection.CloseableIterator$CloseableSingleIterator.foreach(CloseableIterator.scala:86)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1.apply(LocalConverterIngest.scala:106)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1$$anonfun$apply$1.apply(LocalConverterIngest.scala:105)</span><br><span class="line">	at org.locationtech.geomesa.utils.io.package$WithClose$.apply(package.scala:64)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1.apply(LocalConverterIngest.scala:105)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1$$anonfun$run$1.apply(LocalConverterIngest.scala:102)</span><br><span class="line">	at org.locationtech.geomesa.utils.io.CloseablePool$CommonsPoolPool.borrow(CloseablePool.scala:68)</span><br><span class="line">	at org.locationtech.geomesa.tools.ingest.LocalConverterIngest$LocalIngestWorker$1.run(LocalConverterIngest.scala:102)</span><br><span class="line">	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)</span><br><span class="line">	at java.util.concurrent.FutureTask.run(FutureTask.java:266)</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>这个是由于 lib下面的几个包出现问题包括 jts ,geotool的包有问题 这边操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[root@node-kubeadm-250 geomesa-hbase_2.11-3.1.0]# bin&#x2F;geomesa-hbase ingest --catalog china --feature-name china_1 --input-format shp &quot;&#x2F;usr&#x2F;local&#x2F;geomesa&#x2F;china.shp&quot;</span><br><span class="line">INFO  No converter defined - will attempt to detect schema from input files</span><br><span class="line">INFO  Inferred converter:</span><br><span class="line">&#123;</span><br><span class="line">    &quot;fields&quot; : [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot; : &quot;the_geom&quot;,</span><br><span class="line">            &quot;transform&quot; : &quot;$1&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot; : &quot;adcode&quot;,</span><br><span class="line">            &quot;transform&quot; : &quot;$2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot; : &quot;name&quot;,</span><br><span class="line">            &quot;transform&quot; : &quot;$3&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot; : &quot;childrenNu&quot;,</span><br><span class="line">            &quot;transform&quot; : &quot;$4&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot; : &quot;level&quot;,</span><br><span class="line">            &quot;transform&quot; : &quot;$5&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot; : &quot;subFeature&quot;,</span><br><span class="line">            &quot;transform&quot; : &quot;$6&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot; : &quot;adchar&quot;,</span><br><span class="line">            &quot;transform&quot; : &quot;$7&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;id-field&quot; : &quot;$0&quot;,</span><br><span class="line">    &quot;options&quot; : &#123;</span><br><span class="line">        &quot;encoding&quot; : &quot;UTF-8&quot;,</span><br><span class="line">        &quot;error-mode&quot; : &quot;skip-bad-records&quot;,</span><br><span class="line">        &quot;parse-mode&quot; : &quot;incremental&quot;,</span><br><span class="line">        &quot;validators&quot; : [</span><br><span class="line">            &quot;index&quot;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;type&quot; : &quot;shp&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Use inferred converter (y&#x2F;n)? y</span><br><span class="line">Persist this converter for future use (y&#x2F;n)? y</span><br><span class="line">INFO  Added import in reference.conf and saved inferred converter to &#x2F;usr&#x2F;local&#x2F;geomesa&#x2F;geomesa-hbase_2.11-3.1.0&#x2F;conf&#x2F;china_1_4.conf</span><br><span class="line">INFO  In future commands, the converter may be invoked with &#39;--converter china_1&#39;</span><br><span class="line">INFO  Schema &#39;china_1&#39; exists</span><br><span class="line">INFO  Running ingestion in local mode</span><br><span class="line">INFO  Ingesting 1 file with 1 thread</span><br><span class="line">[&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] 100% complete 35 ingested 0 failed in 00:00:01</span><br><span class="line">INFO  Local ingestion complete in 00:00:02</span><br><span class="line">INFO  Ingested 35 features with no failures for file: &#x2F;usr&#x2F;local&#x2F;geomesa&#x2F;china.shp</span><br></pre></td></tr></table></figure>

<p>解决方法</p>
<p>在geotool中依赖jts这个类但是 </p>
<p>gt-main-23.3.jar 里面使用的是jts-17.jar</p>
<p>gt-main-23.0.jar 里面使用的是jts-16.jar</p>
<p>所以需要降级 使用gt-main-23.0.jar 否则会报错</p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-netty-use" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/6e6bd3bb.html" class="article-date">
      <time datetime="2021-06-14T03:16:40.000Z" itemprop="datePublished">2021-06-14</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/6e6bd3bb.html">netty的简单上手使用</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>使用netty来简单写个demo，熟悉语法和常见的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.netty&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;netty-all&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;4.1.49.Final&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>
                              
                          
                    
              <!-- 
              
              <p>使用netty来简单写个demo，熟悉语法和常见的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.netty&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;netty-all&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;4.1.49.Final&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>client:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITDragonAIOClient</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Integer PORT = <span class="number">8888</span>;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String IP_ADDRESS = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> AsynchronousSocketChannel asynSocketChannel ;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ITDragonAIOClient</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;  </span><br><span class="line">        asynSocketChannel = AsynchronousSocketChannel.open();  <span class="comment">// 打开通道  </span></span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connect</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        asynSocketChannel.connect(<span class="keyword">new</span> InetSocketAddress(IP_ADDRESS, PORT));  <span class="comment">// 创建连接 和NIO一样  </span></span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(String request)</span></span>&#123;  </span><br><span class="line">        <span class="keyword">try</span> &#123;  </span><br><span class="line">            asynSocketChannel.write(ByteBuffer.wrap(request.getBytes())).get();  </span><br><span class="line">            ByteBuffer byteBuffer = ByteBuffer.allocate(<span class="number">1024</span>);  </span><br><span class="line">            asynSocketChannel.read(byteBuffer).get();  </span><br><span class="line">            byteBuffer.flip();  </span><br><span class="line">            <span class="keyword">byte</span>[] respByte = <span class="keyword">new</span> <span class="keyword">byte</span>[byteBuffer.remaining()];  </span><br><span class="line">            byteBuffer.get(respByte); <span class="comment">// 将缓冲区的数据放入到 byte数组中  </span></span><br><span class="line">            System.out.println(<span class="keyword">new</span> String(respByte,<span class="string">&quot;utf-8&quot;</span>).trim());  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;  </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            ITDragonAIOClient myClient = <span class="keyword">new</span> ITDragonAIOClient();  </span><br><span class="line">            myClient.connect();  </span><br><span class="line">            <span class="keyword">new</span> Thread(myClient, <span class="string">&quot;myClient&quot;</span>).start(); </span><br><span class="line">            String []operators = &#123;<span class="string">&quot;+&quot;</span>,<span class="string">&quot;-&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">            Random random = <span class="keyword">new</span> Random(System.currentTimeMillis());  </span><br><span class="line">            String expression = random.nextInt(<span class="number">10</span>)+operators[random.nextInt(<span class="number">4</span>)]+(random.nextInt(<span class="number">10</span>)+<span class="number">1</span>);</span><br><span class="line">            myClient.write(expression);  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>server:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * AIO, 也叫 NIO2.0 是一种异步非阻塞的通信方式</span></span><br><span class="line"><span class="comment"> * AIO 引入了异步通道的概念 AsynchronousServerSocketChannel和AsynchronousSocketChannel 其read和write方法返回值类型是Future对象。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITDragonAIOServer</span> </span>&#123;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">private</span> ExecutorService executorService;          <span class="comment">// 线程池</span></span><br><span class="line">    <span class="keyword">private</span> AsynchronousChannelGroup threadGroup;      <span class="comment">// 通道组</span></span><br><span class="line">    <span class="keyword">public</span> AsynchronousServerSocketChannel asynServerSocketChannel;  <span class="comment">// 服务器通道 </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(Integer port)</span></span>&#123;  </span><br><span class="line">        <span class="keyword">try</span> &#123;  </span><br><span class="line">            <span class="comment">// 1.创建一个缓存池  </span></span><br><span class="line">            executorService = Executors.newCachedThreadPool();  </span><br><span class="line">            <span class="comment">// 2.创建通道组  </span></span><br><span class="line">            threadGroup = AsynchronousChannelGroup.withCachedThreadPool(executorService, <span class="number">1</span>);  </span><br><span class="line">            <span class="comment">// 3.创建服务器通道  </span></span><br><span class="line">            asynServerSocketChannel = AsynchronousServerSocketChannel.open(threadGroup);  </span><br><span class="line">            <span class="comment">// 4.进行绑定  </span></span><br><span class="line">            asynServerSocketChannel.bind(<span class="keyword">new</span> InetSocketAddress(port));  </span><br><span class="line">            System.out.println(<span class="string">&quot;server start , port : &quot;</span> + port);  </span><br><span class="line">            <span class="comment">// 5.等待客户端请求  </span></span><br><span class="line">            asynServerSocketChannel.accept(<span class="keyword">this</span>, <span class="keyword">new</span> ITDragonAIOServerHandler());  </span><br><span class="line">            <span class="comment">// 一直阻塞 不让服务器停止，真实环境是在tomcat下运行，所以不需要这行代码  </span></span><br><span class="line">            Thread.sleep(Integer.MAX_VALUE);  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;  </span><br><span class="line">        ITDragonAIOServer server = <span class="keyword">new</span> ITDragonAIOServer();  </span><br><span class="line">        server.start(<span class="number">8888</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>serverhandler:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ITDragonAIOServerHandler</span> <span class="keyword">implements</span> <span class="title">CompletionHandler</span>&lt;<span class="title">AsynchronousSocketChannel</span>, <span class="title">ITDragonAIOServer</span>&gt; </span>&#123;  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> Integer BUFFER_SIZE = <span class="number">1024</span>;  </span><br><span class="line">  <span class="meta">@Override</span>  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">completed</span><span class="params">(AsynchronousSocketChannel asynSocketChannel, ITDragonAIOServer attachment)</span> </span>&#123;  </span><br><span class="line">      <span class="comment">// 保证多个客户端都可以阻塞  </span></span><br><span class="line">      attachment.asynServerSocketChannel.accept(attachment, <span class="keyword">this</span>);  </span><br><span class="line">      read(asynSocketChannel);  </span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="comment">//读取数据  </span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">final</span> AsynchronousSocketChannel asynSocketChannel)</span> </span>&#123;  </span><br><span class="line">      ByteBuffer byteBuffer = ByteBuffer.allocate(BUFFER_SIZE);  </span><br><span class="line">      asynSocketChannel.read(byteBuffer, byteBuffer, <span class="keyword">new</span> CompletionHandler&lt;Integer, ByteBuffer&gt;() &#123;  </span><br><span class="line">          <span class="meta">@Override</span>  </span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">completed</span><span class="params">(Integer resultSize, ByteBuffer attachment)</span> </span>&#123;  </span><br><span class="line">              <span class="comment">//进行读取之后,重置标识位  </span></span><br><span class="line">              attachment.flip();  </span><br><span class="line">              <span class="comment">//获取读取的数据  </span></span><br><span class="line">              String resultData = <span class="keyword">new</span> String(attachment.array()).trim();  </span><br><span class="line">              System.out.println(<span class="string">&quot;Server -&gt; &quot;</span> + <span class="string">&quot;收到客户端的数据信息为:&quot;</span> + resultData);  </span><br><span class="line"><span class="comment">//              String response = resultData + &quot; = &quot; + CalculatorUtil.cal(resultData);</span></span><br><span class="line">              String response = resultData + <span class="string">&quot; = &quot;</span> ;</span><br><span class="line">              write(asynSocketChannel, response);</span><br><span class="line">          &#125;  </span><br><span class="line">          <span class="meta">@Override</span>  </span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">failed</span><span class="params">(Throwable exc, ByteBuffer attachment)</span> </span>&#123;  </span><br><span class="line">              exc.printStackTrace();  </span><br><span class="line">          &#125;  </span><br><span class="line">      &#125;);  </span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="comment">// 写入数据</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(AsynchronousSocketChannel asynSocketChannel, String response)</span> </span>&#123;  </span><br><span class="line">      <span class="keyword">try</span> &#123;  </span><br><span class="line">          <span class="comment">// 把数据写入到缓冲区中  </span></span><br><span class="line">          ByteBuffer buf = ByteBuffer.allocate(BUFFER_SIZE);  </span><br><span class="line">          buf.put(response.getBytes());  </span><br><span class="line">          buf.flip();  </span><br><span class="line">          <span class="comment">// 在从缓冲区写入到通道中  </span></span><br><span class="line">          asynSocketChannel.write(buf).get();  </span><br><span class="line">      &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </span><br><span class="line">          e.printStackTrace();  </span><br><span class="line">      &#125; <span class="keyword">catch</span> (ExecutionException e) &#123;  </span><br><span class="line">          e.printStackTrace();  </span><br><span class="line">      &#125;  </span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="meta">@Override</span>  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">failed</span><span class="params">(Throwable exc, ITDragonAIOServer attachment)</span> </span>&#123;  </span><br><span class="line">      exc.printStackTrace();  </span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>








               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-jd-script-use" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/8cefd92d.html" class="article-date">
      <time datetime="2021-06-11T01:17:51.000Z" itemprop="datePublished">2021-06-11</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/8cefd92d.html">使用青龙并添加jd的脚本</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>找到一个jd_script 主要是京东的脚本可以操作，在加入 </p>
<p>fetchMetadata: sill mapToRegistry uri <a target="_blank" rel="noopener" href="https://registry.npm.taobao.org/got">https://registry.npm.taobao.org/got</a></p>
<p>JS_TOOL执行 jd panelon后执行如果报错 缺 /root/jd/config</p>
<p>
                              
                          
                    
              <!-- 
              
              <p>找到一个jd_script 主要是京东的脚本可以操作，在加入 </p>
<p>fetchMetadata: sill mapToRegistry uri <a target="_blank" rel="noopener" href="https://registry.npm.taobao.org/got">https://registry.npm.taobao.org/got</a></p>
<p>JS_TOOL执行 jd panelon后执行如果报错 缺 /root/jd/config</p>
<p>那就新建 /root/jd/config 文件夹 然后将 /root/JS_TOOL/sample中的文件复制到/root/jd/config </p>
<p>最后来就可以新建</p>
<p>tips:</p>
<p>期间 npm  install 会出现</p>
<p>fetchMetadata: verb afterAdd /root/.npm/ee-first/1.1.1/package/package.json</p>
<p>这个是下载的过程比较耗时可能10分钟。</p>
<p>预先要求的条件</p>
<p>docker的环境</p>
<ol>
<li><code>npm config set registry http://registry.npmjs.org/ --global</code></li>
<li><code>npm cache clear --force</code></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash jd.sh panelon</span><br></pre></td></tr></table></figure>




               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hadoop-windows" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/77e0f92d.html" class="article-date">
      <time datetime="2021-05-26T06:53:02.000Z" itemprop="datePublished">2021-05-26</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/77e0f92d.html">hadoop_windows</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>Unable to find native drivers in HADOOP_HOME. Please, refer to Hadoop Wiki for more details.</p>
<p><a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/HADOOP2/WindowsProblems">link</a></p>
<p>配置环境变量 包括java和hadoop的注意一点尽量不要有空格否则在<br>java -version<br>hadoop version 的时候回报错 java_home  incorrect </p>
<p>
                              
                          
                    
              <!-- 
              
              <p>Unable to find native drivers in HADOOP_HOME. Please, refer to Hadoop Wiki for more details.</p>
<p><a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/HADOOP2/WindowsProblems">link</a></p>
<p>配置环境变量 包括java和hadoop的注意一点尽量不要有空格否则在<br>java -version<br>hadoop version 的时候回报错 java_home  incorrect </p>
<p><img src="../img/image-20210526145438386.png" alt="image-20210526145438386"></p>
<p>我这边没看到10 的版本就先使用了最近的</p>
<p><img src="../img/image-20210526145752361.png" alt="image-20210526145752361"></p>
<p><img src="../img/image-20210526145319973.png" alt="image-20210526145319973"></p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-idea2020-1-3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/47eff7d.html" class="article-date">
      <time datetime="2021-04-15T13:36:38.000Z" itemprop="datePublished">2021-04-15</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/47eff7d.html">idea2020.1.3</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>最新版的idea激活已经变了该为到期后接着试用,这个方法对于我这种激活到底的人非常不友好还是提供下载的链接</p>
<h2 id="介绍适用于idea2020-2-1-3及以下"><a href="#介绍适用于idea2020-2-1-3及以下" class="headerlink" title="介绍适用于idea2020.2.1.3及以下"></a>介绍适用于idea2020.2.1.3及以下</h2><p>本部分参考这篇文章</p>
<p><a target="_blank" rel="noopener" href="https://www.jiweichengzhu.com/article/7f4f3c9d095743908db6ec2648a59b3e">https://www.jiweichengzhu.com/article/7f4f3c9d095743908db6ec2648a59b3e</a></p>
<p>
                              
                          
                    
              <!-- 
              
              <p>最新版的idea激活已经变了该为到期后接着试用,这个方法对于我这种激活到底的人非常不友好还是提供下载的链接</p>
<h2 id="介绍适用于idea2020-2-1-3及以下"><a href="#介绍适用于idea2020-2-1-3及以下" class="headerlink" title="介绍适用于idea2020.2.1.3及以下"></a>介绍适用于idea2020.2.1.3及以下</h2><p>本部分参考这篇文章</p>
<p><a target="_blank" rel="noopener" href="https://www.jiweichengzhu.com/article/7f4f3c9d095743908db6ec2648a59b3e">https://www.jiweichengzhu.com/article/7f4f3c9d095743908db6ec2648a59b3e</a></p>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1nC060_Rv-_7tzRc1Be-dmg">https://pan.baidu.com/s/1nC060_Rv-_7tzRc1Be-dmg</a> 提取码: htpi </p>
<h3 id="jetbrains-agent这个要注意版本"><a href="#jetbrains-agent这个要注意版本" class="headerlink" title="jetbrains-agent这个要注意版本"></a>jetbrains-agent这个要注意版本</h3><p>我用的最近的 ChangeLogs.txt是</p>
<blockquote>
<p>v3.2.1 build date: 2020-04-11<br>    * 什么都没做。</p>
<p>v3.2.0 build date: 2020-04-10</p>
<ul>
<li>修复激活弹Activation code界面问题。<ul>
<li>现在离线模式已经不需要了。</li>
</ul>
</li>
</ul>
</blockquote>
<ul>
<li>lcoalidea初始化后保存的文件,如果要重置的话直接删除这个文件即可</li>
</ul>
<p><img src="../img/image-20210415215941559.png" alt="image-20210415215941559"></p>
<ul>
<li>roaming 下面有配置文件可以注意以下</li>
</ul>
<p><img src="../img/image-20210415220333316.png" alt="image-20210415220333316"></p>
<p>还有就是要注意jetbrains-agent.jar 版本一定要对应上 否则会出现 <strong>key is invalid</strong>,是同样的key </p>
<p><img src="../img/image-20210415220517692.png" alt="image-20210415220517692"></p>
<p>大概就是这样</p>
<h2 id="ide-eval-resetter-2-1-6来激活"><a href="#ide-eval-resetter-2-1-6来激活" class="headerlink" title="ide-eval-resetter-2.1.6来激活"></a>ide-eval-resetter-2.1.6来激活</h2><p>下面只提供下载链接不提供具体步骤</p>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1VWogd64sbzyagSx_vvKYyg">https://pan.baidu.com/s/1VWogd64sbzyagSx_vvKYyg</a> 提取码: zjga 复制这段内容后打开百度网盘手机App，操作更方便哦</p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Linux常用命令参考手册-转载" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/c66a3331.html" class="article-date">
      <time datetime="2021-03-25T14:06:10.000Z" itemprop="datePublished">2021-03-25</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/c66a3331.html">Linux常用命令参考手册</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>转载地址 : <a target="_blank" rel="noopener" href="https://github.com/xjh22222228/linux-manual/stargazers">https://github.com/xjh22222228/linux-manual/stargazers</a></p>
<p><strong>Linux 常用命令参考手册</strong></p>
<p>日常运维的最佳拍档 x 99</p>
<p>
                              
                          
                    
              <!-- 
              
              <p>转载地址 : <a target="_blank" rel="noopener" href="https://github.com/xjh22222228/linux-manual/stargazers">https://github.com/xjh22222228/linux-manual/stargazers</a></p>
<p><strong>Linux 常用命令参考手册</strong></p>
<p>日常运维的最佳拍档 x 99</p>
<p><a target="_blank" rel="noopener" href="https://github.com/xjh22222228/linux-manual/stargazers"><img src="https://img.shields.io/github/stars/xjh22222228/linux-manual" alt="Stars Badge"></a> <img src="https://img.shields.io/github/license/xjh22222228/linux-manual" alt="img"></p>
<hr>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ul>
<li>文件操作<ul>
<li><a href="#head">head</a></li>
<li><a href="#tail">tail</a></li>
<li><a href="#ls">ls</a></li>
<li><a href="#pwd">pwd</a></li>
<li><a href="#wc">wc</a></li>
<li><a href="#find">find</a></li>
<li><a href="#mkdir">mkdir</a></li>
<li><a href="#mktemp">mktemp</a></li>
<li><a href="#chattr">chattr</a></li>
<li><a href="#more">more</a></li>
<li><a href="#paste">paste</a></li>
<li><a href="#stat">stat</a></li>
<li><a href="#grep">grep</a></li>
<li><a href="#touch">touch</a></li>
<li><a href="#cd">cd</a></li>
<li><a href="#rm">rm</a></li>
<li><a href="#rmdir">rmdir</a></li>
<li><a href="#cp">cp</a></li>
<li><a href="#cat">cat</a></li>
<li><a href="#mv">mv</a></li>
<li><a href="#locate">locate</a></li>
<li><a href="#open">open</a></li>
<li><a href="#source">source</a></li>
<li><a href="#tree">tree</a></li>
<li><a href="#ln">ln</a></li>
<li><a href="#file">file</a></li>
</ul>
</li>
<li>系统管理<ul>
<li><a href="#top">top</a></li>
<li><a href="#nohup">nohup</a></li>
<li><a href="#watch">watch</a></li>
<li><a href="#ping">ping</a></li>
<li><a href="#which">which</a></li>
<li><a href="#shutdown">shutdown</a></li>
<li><a href="#reboot">reboot</a></li>
<li><a href="#ps">ps</a></li>
<li><a href="#uptime">uptime</a></li>
<li><a href="#crontab">crontab</a></li>
<li><a href="#uname">uname</a></li>
<li><a href="#ifconfig">ifconfig</a></li>
<li><a href="#whereis">whereis</a></li>
<li><a href="#kill">kill</a></li>
<li><a href="#killall">killall</a></li>
<li><a href="#chmod">chmod</a></li>
<li><a href="#lsof">lsof</a></li>
<li><a href="#netstat">netstat</a></li>
<li><a href="#chown">chown</a></li>
<li><a href="#systemctl">systemctl</a></li>
<li><a href="#service">service</a></li>
<li><a href="#free">free</a></li>
<li><a href="#jobs">jobs</a></li>
<li><a href="#type">type</a></li>
<li><a href="#printenv">printenv</a></li>
<li><a href="#set">set</a></li>
<li><a href="#export">export</a></li>
<li><a href="#unset">unset</a></li>
<li><a href="#alias">alias</a></li>
<li><a href="#time">time</a></li>
<li><a href="#clear">clear</a></li>
</ul>
</li>
<li>用户管理<ul>
<li><a href="#useradd">useradd</a></li>
<li><a href="#userdel">userdel</a></li>
<li><a href="#passwd">passwd</a></li>
<li><a href="#chpasswd">chpasswd</a></li>
<li><a href="#chsh">chsh</a></li>
<li><a href="#users">users</a></li>
<li><a href="#who">who</a></li>
<li><a href="#w">w</a></li>
<li><a href="#last">last</a></li>
<li><a href="#su">su</a></li>
<li><a href="#whoami">whoami</a></li>
</ul>
</li>
<li>压缩、解压<ul>
<li><a href="#zip">zip</a></li>
<li><a href="#unzip">unzip</a></li>
<li><a href="#gzip">gzip</a></li>
<li><a href="#bzip2">bzip2</a></li>
<li><a href="#tar">tar</a></li>
</ul>
</li>
<li>加解密<ul>
<li><a href="#md5sum">md5sum</a></li>
<li><a href="#base64">base64</a></li>
</ul>
</li>
<li>网络<ul>
<li><a href="#wget">wget</a></li>
<li><a href="#curl">curl</a></li>
<li><a href="#scp">scp</a></li>
</ul>
</li>
<li>磁盘<ul>
<li><a href="#df">df</a></li>
<li><a href="#du">du</a></li>
</ul>
</li>
<li>包管理<ul>
<li><a href="#yum">yum</a></li>
<li><a href="#apt-get">apt-get</a></li>
</ul>
</li>
<li>其他<ul>
<li><a href="#%E7%9B%AE%E5%BD%95%E5%90%8D%E7%A7%B0%E5%90%AB%E4%B9%89">目录名称含义</a></li>
<li><a href="#%E9%87%8D%E5%AE%9A%E5%90%91%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA">重定向输入和输出</a></li>
<li><a href="#%E7%AE%A1%E9%81%93">管道</a></li>
<li><a href="#echo">echo</a></li>
<li><a href="#date">date</a></li>
<li><a href="#man">man</a></li>
<li><a href="#sleep">sleep</a></li>
<li><a href="#history">history</a></li>
<li><a href="#xargs">xargs</a></li>
<li><a href="#cal">cal</a></li>
<li><a href="#expr">expr</a></li>
<li><a href="#bc">bc</a></li>
<li><a href="#timeout">timeout</a></li>
<li><a href="#exit">exit</a></li>
<li><a href="#vim">vim</a></li>
<li><a href="#basename">basename</a></li>
<li><a href="#read">read</a></li>
<li><a href="#tee">tee</a></li>
</ul>
</li>
</ul>
<h2 id="目录名称含义"><a href="#目录名称含义" class="headerlink" title="目录名称含义"></a>目录名称含义</h2><table>
<thead>
<tr>
<th>目录名</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>/</td>
<td>虚拟目录的根目录，通常不会在这里存储文件</td>
</tr>
<tr>
<td>/bin</td>
<td>二进制目录，存放许多用户级的GNU工具</td>
</tr>
<tr>
<td>/boot</td>
<td>启动目录，存放启动文件</td>
</tr>
<tr>
<td>/dev</td>
<td>设备目录，Linux在这里创建设备节点</td>
</tr>
<tr>
<td>/etc</td>
<td>系统配置文件目录</td>
</tr>
<tr>
<td>/home</td>
<td>主目录，Linux在这里创建用户目录</td>
</tr>
<tr>
<td>/lib</td>
<td>库目录，存放系统和应用程序的库文件</td>
</tr>
<tr>
<td>/media</td>
<td>媒体目录，可移动媒体设备的常用挂载点</td>
</tr>
<tr>
<td>/mnt</td>
<td>挂载目录，另一个可移动媒体设备的常用挂载点</td>
</tr>
<tr>
<td>/opt</td>
<td>可选目录，常用于存放第三方软件包和数据文件</td>
</tr>
<tr>
<td>/proc</td>
<td>进程目录，存放现有硬件及当期进程的相关信息</td>
</tr>
<tr>
<td>/root</td>
<td>ROOT用户的主目录</td>
</tr>
<tr>
<td>/sbin</td>
<td>系统二进制目录，存放许多GNU管理员级工具</td>
</tr>
<tr>
<td>/run</td>
<td>运行目录，存放系统运作时的运行时数据</td>
</tr>
<tr>
<td>/srv</td>
<td>服务目录，存放本地服务的相关文件</td>
</tr>
<tr>
<td>/sys</td>
<td>系统目录，存放系统硬件信息的相关文件</td>
</tr>
<tr>
<td>/tmp</td>
<td>临时目录，可以在该目录中创建和删除临时工作文件</td>
</tr>
<tr>
<td>/usr</td>
<td>用户二进制目录，大量用户级的GNU工具和数据文件都存储在这里</td>
</tr>
<tr>
<td>/var</td>
<td>可变目录，用以存放经常变化的文件，比如日志文件</td>
</tr>
</tbody></table>
<h2 id="重定向输入和输出"><a href="#重定向输入和输出" class="headerlink" title="重定向输入和输出"></a>重定向输入和输出</h2><h4 id="输出重定向"><a href="#输出重定向" class="headerlink" title="输出重定向"></a>输出重定向</h4><p>将命令输出的内容发送到一个文件中叫做 <code>输出重定向</code>。 使用 <code>&gt;</code> 大于号。</p>
<p>下面展示了几个例子</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span> &gt; log.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、</span></span><br><span class="line">ps -ef &gt; ps.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3、</span></span><br><span class="line"><span class="built_in">history</span> &gt; a.txt</span><br></pre></td></tr></table></figure>

<p>有时不想覆盖文件而是追加内容，比如日志，可以使用 <code>&gt;&gt;</code> 2个大于号。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;H&quot;</span> &gt;&gt; log.txt</span><br></pre></td></tr></table></figure>

<h4 id="输入重定向"><a href="#输入重定向" class="headerlink" title="输入重定向"></a>输入重定向</h4><p>和输出重定向正好相反，将文件的内容定向到命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计input.txt文本行数</span></span><br><span class="line">wc -l &lt; input.txt <span class="comment"># 等价于 wc -l input.txt</span></span><br></pre></td></tr></table></figure>

<p>还有一种叫内联重定向，比较少见，但也挺有用。 使用2个 <code>&lt;&lt;</code> 小于号。然后跟着一个开头标记和结尾标记。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计行数，输出2</span></span><br><span class="line">wc -l &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">第一行</span></span><br><span class="line"><span class="string">第二行</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<p>开头标记必须和结尾标记一致，标记名称可以是任何字符串。</p>
<p>下面这个也是可以的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出2</span></span><br><span class="line">wc -l &lt;&lt; <span class="string">Hello</span></span><br><span class="line"><span class="string">第一行</span></span><br><span class="line"><span class="string">第二行</span></span><br><span class="line"><span class="string">Hello</span></span><br></pre></td></tr></table></figure>

<h2 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h2><p>将一个命令的输出作为另一个命令的输入称为管道。 管道用 <code>|</code> 符号。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 ls 输出内容作为 wc 输入</span></span><br><span class="line">ls | wc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行一个脚本，这没有什么意义，只是一个例子</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;./bash.sh&quot;</span> | bash</span><br></pre></td></tr></table></figure>

<h2 id="head"><a href="#head" class="headerlink" title="head"></a>head</h2><p>显示文件的头部内容，如果不指定参数默认显示10行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示前10行内容</span></span><br><span class="line">head README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者显示多个文件</span></span><br><span class="line">head README.md package.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># -n 指定显示行数</span></span><br><span class="line">head -n 100 README.md</span><br></pre></td></tr></table></figure>

<h2 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h2><p>显示文件的末尾部分</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认显示末尾10行</span></span><br><span class="line">tail README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -n 指定显示末尾20行</span></span><br><span class="line">tail -n 20 README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实时监听README.md文件变化</span></span><br><span class="line">tail -f README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据文件名进行追踪, 如果删除后创建相同的文件名会继续追踪</span></span><br><span class="line">tail -F README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文件的最后10个字符</span></span><br><span class="line">tail -c README.md</span><br></pre></td></tr></table></figure>

<h2 id="top"><a href="#top" class="headerlink" title="top"></a>top</h2><p>实时查看系统执行中的程序, top 命令跟 <code>ps</code> 命令相似，但它是实时的。</p>
<p>默认情况下 <code>top</code> 命令启动时会按照 <code>%CPU</code> 值对进程排序。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>PID</td>
<td>进程的ID</td>
</tr>
<tr>
<td>USER</td>
<td>进程的优先级</td>
</tr>
<tr>
<td>PR</td>
<td>进程的优先级</td>
</tr>
<tr>
<td>NI</td>
<td>进程的谦让度值</td>
</tr>
<tr>
<td>VIRT</td>
<td>进程占用的虚拟内存总量</td>
</tr>
<tr>
<td>RES</td>
<td>进程占用的物理内存总量</td>
</tr>
<tr>
<td>SHR</td>
<td>进程和其他进程共享的内存总量</td>
</tr>
<tr>
<td>S</td>
<td>进程的状态（D=可中断的休眠状态，R在运行状态，S休眠状态，T跟踪状态或停止状态，Z=僵化状态）</td>
</tr>
<tr>
<td>%CPU</td>
<td>进程使用的CPU时间比例</td>
</tr>
<tr>
<td>%MEM</td>
<td>进程使用的内存占可用内存的比例</td>
</tr>
<tr>
<td>TIME+</td>
<td>自进程启动到目前为止的CPU时间总量</td>
</tr>
<tr>
<td>COMMAND</td>
<td>进程所对应的命令行名称，也就是启动的程序名</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 实时监听进程变化</span></span><br><span class="line"><span class="comment">#  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND                               </span></span><br><span class="line"><span class="comment">#    1 root      20   0  125124   3612   2428 S  0.0  0.2   0:04.88 systemd</span></span><br><span class="line">top</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示2条</span></span><br><span class="line">top -n 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示指定的进程信息</span></span><br><span class="line">top -pid &lt;pid&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看进程所有的线程</span></span><br><span class="line">top -H -p &lt;pid&gt;</span><br></pre></td></tr></table></figure>

<h2 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h2><p>显示当前目录下的文件和目录，输出的列表是按字母排序 (某些发行版可能不一样)。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示当前目录列表</span></span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示目录列表的详细信息</span></span><br><span class="line">ls -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示指定目录</span></span><br><span class="line">ls ./src</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示目录列表详细信息和大小</span></span><br><span class="line">ls -lh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出所有文件包括隐藏文件</span></span><br><span class="line">ls -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># -F 可以显示类型，用以区分是文件还是目录</span></span><br><span class="line">ls -F <span class="comment"># 后缀为 ”/“ 代表是目录，”*“ 为可执行文件，没有则为文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤文件列表, * 代表0个或多个字符， ? 代表一个字符</span></span><br><span class="line">ls javasc*</span><br><span class="line"></span><br><span class="line"><span class="comment"># -i 查看inode编号, 每一个文件或目录都有一个唯一的编号，这个数字由内核分配给文件系统中的每一个对象</span></span><br><span class="line">ls -i</span><br></pre></td></tr></table></figure>

<h2 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h2><p>显示当前工作目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure>

<h2 id="wc"><a href="#wc" class="headerlink" title="wc"></a>wc</h2><p>统计文件的行数、字数、字节数, 常见用于统计代码行数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计字节数</span></span><br><span class="line">wc -c README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计行数</span></span><br><span class="line">wc -l README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计字数</span></span><br><span class="line">wc -w README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计字符数</span></span><br><span class="line">wc -m README.md</span><br></pre></td></tr></table></figure>

<h2 id="whoami"><a href="#whoami" class="headerlink" title="whoami"></a>whoami</h2><p>显示自身的用户名称, 此命令等价于 <code>id -un</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% whoami <span class="comment"># xiejiahe</span></span><br></pre></td></tr></table></figure>

<h2 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h2><p>设置命令别名，用于简化较长的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出所有已设置的别名</span></span><br><span class="line"><span class="built_in">alias</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除所有别名</span></span><br><span class="line"><span class="built_in">unalias</span> -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置别名</span></span><br><span class="line"><span class="built_in">alias</span> ll=<span class="string">&#x27;ls -l&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h2><p>用于从网络下载文件到本地</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载某个文件</span></span><br><span class="line">wget https://www.xiejiahe.com/robots.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定下载后文件名</span></span><br><span class="line">wget -O ro.txt https://www.xiejiahe.com/robots.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 断开续传，一般用于大文件，防止重新下载</span></span><br><span class="line">wget -c https://www.xiejiahe.com/robots.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用后台下载, 对于大文件非常有用</span></span><br><span class="line">wget -b https://www.xiejiahe.com/robots.txt</span><br><span class="line">tail -f wget-log   <span class="comment"># 查看后台下载进度</span></span><br></pre></td></tr></table></figure>

<h2 id="df"><a href="#df" class="headerlink" title="df"></a>df</h2><p>查看已挂载的磁盘使用情况。</p>
<h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Filesystem</td>
<td>设备的设备位置文件</td>
</tr>
<tr>
<td>Size</td>
<td>能容纳多少个1024字节大小的块</td>
</tr>
<tr>
<td>Used</td>
<td>已用了多少个1024字节大小的块</td>
</tr>
<tr>
<td>Avail</td>
<td>还有多少个1024字节大小的块可用</td>
</tr>
<tr>
<td>Use%</td>
<td>已用空间所占的比例</td>
</tr>
<tr>
<td>Mounted on</td>
<td>设备挂载到了哪个挂载点上</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示每个有数据的已挂载文件系统</span></span><br><span class="line"><span class="comment"># Filesystem     1K-blocks    Used Available Use% Mounted on</span></span><br><span class="line"><span class="comment"># /dev/vda1       41151808 1853208  37185168   5% /</span></span><br><span class="line">df</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化大小，以kb以上进行显示</span></span><br><span class="line">df -h</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看全部文件系统信息</span></span><br><span class="line">df -a</span><br></pre></td></tr></table></figure>

<h2 id="du"><a href="#du" class="headerlink" title="du"></a>du</h2><p>显示文件或目录所占用的磁盘空间</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认显示当前目录的所有文件、目录、和子目录的磁盘使用情况</span></span><br><span class="line">du</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定文件所占用磁盘空间</span></span><br><span class="line">du README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定目录所占用磁盘空间, 输出的最后一行是累计总大小</span></span><br><span class="line">du src</span><br><span class="line"></span><br><span class="line"><span class="comment"># -h 以K，M，G为单位，提高信息的可读性。</span></span><br><span class="line">du -h src  <span class="comment"># 20K    src</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -s 只显示总大小，列出最后累计的值</span></span><br><span class="line">du -s src</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示当前所有已列出文件总大小</span></span><br><span class="line">du -c</span><br></pre></td></tr></table></figure>

<h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><p>指定某个目录下查找文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在当前目录递归搜索文件名为 README.md 文件</span></span><br><span class="line">find . -name README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过通配符进行查找, 必须用引号括着, 这里查找所有后缀为 .md 文件</span></span><br><span class="line">find . -name <span class="string">&quot;*.md&quot;</span></span><br><span class="line">find . -iname <span class="string">&quot;*.md&quot;</span>  <span class="comment"># 忽略文件大小写</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 排除文件，只要加 ! , 排除掉所有 .md 后缀的文件</span></span><br><span class="line">find . ! -name <span class="string">&quot;*.md&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据类型进行过滤搜索</span></span><br><span class="line"><span class="comment"># f 普通文件, l 符号连接</span></span><br><span class="line"><span class="comment"># d 目录, c 字符设备</span></span><br><span class="line"><span class="comment"># b 块设备, s 套接字, p Fifo</span></span><br><span class="line">find . -<span class="built_in">type</span> f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 限定目录递归深度</span></span><br><span class="line">find . -maxdepth 3  <span class="comment"># 最大为3个目录</span></span><br><span class="line">find . -mindepth 3  <span class="comment"># 最小为3个目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找文件大小大于 25k 文件 </span></span><br><span class="line">find /root -size +25k</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找10天前文件 -mtime 修改时间、 -ctime 创建时间、 -atime 访问时间</span></span><br><span class="line">find /root -mtime +10</span><br></pre></td></tr></table></figure>

<h2 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h2><p>创建目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在当前目录下创建 temp 目录</span></span><br><span class="line">mkdir temp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建多层目录</span></span><br><span class="line">mkdir -p temp/temp2/temp3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基于权限创建</span></span><br><span class="line">mkdir -m 777 temp</span><br></pre></td></tr></table></figure>

<h2 id="mktemp"><a href="#mktemp" class="headerlink" title="mktemp"></a>mktemp</h2><p>创建临时目录或文件，Linux使用 <code>/tmp</code> 目录来存放不需要永久保留的文件，大多数Linux发行版配置了系统在启动时自动删除 <code>/tmp</code> 目录的所有文件。</p>
<p>默认情况下， <code>mktemp</code> 会在本地目录中创建一个文件，只要指定一个文件名模板就行，模板可以包含任意文本文件名，在文件名末尾加上<strong>6</strong>个X就行了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建本地临时文件, 会在当前目录下创建一个叫 log.XXXXXX, XXXXXX是一个随机字符码，保证文件名在目录中是唯一的。</span></span><br><span class="line">mktemp log.XXXXXX  <span class="comment"># log.J3awfb</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -t, 在 /tmp 目录创建临时文件, 返回绝对路径地址</span></span><br><span class="line">mktemp -t log.XXXXXX <span class="comment"># /tmp/log.G5g9dX</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -d 创建临时目录, 这样就能用该目录进行任何需要的操作了，比如创建其他的临时文件</span></span><br><span class="line">mktemp -d dir.XXXXXX</span><br></pre></td></tr></table></figure>

<h2 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h2><p>创建一个空文件, 如果文件存在只会修改文件的创建时间</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch README.md</span><br></pre></td></tr></table></figure>

<h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><p>远程连接服务器工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 简单的连接, 省略了端口号,默认为22</span></span><br><span class="line">ssh root@192.168.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定端口号连接</span></span><br><span class="line">ssh -p 23 root@192.168.0.0</span><br></pre></td></tr></table></figure>

<h2 id="nohup"><a href="#nohup" class="headerlink" title="nohup"></a>nohup</h2><p>程序以挂起方式运行, 不会影响终端交互。</p>
<p>因为程序会以后台的方式运行，所以标准输出不会显示在屏幕上, 默认情况下会在当前目录生成一个叫 <code>nohup.out</code> 文件，里面包含了标准输出内容。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如运行一个 node.js 程序</span></span><br><span class="line">nohup node main.js</span><br><span class="line">nohup node main.js &amp; <span class="comment"># 可以在最后加 &amp; ，表示后台模式，让出CLI以供其他使用。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在当前目录会出现 nohup.out 文件，里面包含了 Hello World</span></span><br><span class="line">nohuo <span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h2><p>进入指定目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入当前 src 目录</span></span><br><span class="line"><span class="built_in">cd</span> src</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回到上一次目录</span></span><br><span class="line"><span class="built_in">cd</span> -</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回上一级目录</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> ../../..   <span class="comment"># 返回多级</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入家目录</span></span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line"><span class="built_in">cd</span>  <span class="comment"># 或者不带任何参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将上一个命令的参数作为cd参数使用</span></span><br><span class="line"><span class="built_in">cd</span> !$</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模糊匹配目录，有时目录名很长一个一个敲效率就很低</span></span><br><span class="line"><span class="comment"># * 代表0个或多个字符， ? 代表一个字符</span></span><br><span class="line"><span class="built_in">cd</span> javasc*</span><br></pre></td></tr></table></figure>

<h2 id="echo"><a href="#echo" class="headerlink" title="echo"></a>echo</h2><p>输出字符串或者变量</p>
<p>注: 一般情况下字符串不必加双引号, 如果包含转义字符就必须要加</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在终端输出 Hello World</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span><br><span class="line"><span class="built_in">echo</span> Hello World    <span class="comment"># 也可以不加双引号</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello\nWorld&quot;</span> <span class="comment"># 必须加双引号, 否则无法转义</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印系统环境变量，如果变量不存在输出为空</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &gt; 输出重定向，将内容输出到文件中</span></span><br><span class="line"><span class="built_in">echo</span> Hello World &gt; 1.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># -n 不换行, 默认情况下echo 是占一整行</span></span><br><span class="line"><span class="built_in">echo</span> -n Hello; <span class="built_in">echo</span> World</span><br></pre></td></tr></table></figure>

<h2 id="time"><a href="#time" class="headerlink" title="time"></a>time</h2><p>测试某条命令执行所需花费时间</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># time 后面跟着要测试的命令</span></span><br><span class="line"><span class="comment"># 输出:  0.02s user 0.01s system 0% cpu 6.233 total</span></span><br><span class="line">time curl https://github.com/xjh22222228/linux-manual</span><br></pre></td></tr></table></figure>

<h2 id="clear"><a href="#clear" class="headerlink" title="clear"></a>clear</h2><p>用于清除当前终端所有信息，本质上只是向后翻了一页，往上滚动还能看到之前的操作信息</p>
<p>注：笔者用得比较多的是 <code>command + K</code> 可以完全清除终端所有操作信息。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clear</span><br></pre></td></tr></table></figure>

<h1 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h1><p>删除指定目录或文件</p>
<p>注: 使用此命令需要非常小心, 一但删除无法恢复</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除当前 1.txt 文件</span></span><br><span class="line">rm 1.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># -i 删除前询问是否真的要删除，因为一旦删除无法恢复</span></span><br><span class="line">rm -i README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这条命令比较常用, 强制删除目录或文件</span></span><br><span class="line"><span class="comment"># -r 如果是目录递归删除, -f 强制删除 不发出任何警告</span></span><br><span class="line">rm -rf ./src</span><br></pre></td></tr></table></figure>

<h2 id="rmdir"><a href="#rmdir" class="headerlink" title="rmdir"></a>rmdir</h2><p>删除指定空目录</p>
<p>注：<code>rmdir</code> 实际上用得并不多，因为不是很灵活，基本上使用 <code>rm</code> 代替</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除当前 temp 空目录, 如果不是空目录会发出警告</span></span><br><span class="line">rmdir temp</span><br><span class="line"></span><br><span class="line"><span class="comment"># -p 参数可以删除多层空目录, 发现temp3是空目录删除掉，然后接着往父级找如果还是空目录继续删除...</span></span><br><span class="line">rmdir -p temp1/temp2/temp3</span><br><span class="line"></span><br><span class="line"><span class="comment"># -i 删除前询问确认删除</span></span><br><span class="line">rmdir -i temp</span><br></pre></td></tr></table></figure>

<h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><p>通常用于监听1个命令的运行结果、定时执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每5秒执行一次 tail 命令, 如果不指定-n 默认为2秒</span></span><br><span class="line">watch -n 5 <span class="string">&quot;tail README.md&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -d 高亮显示变化内容</span></span><br><span class="line">watch -n 5 -d <span class="string">&quot;tail README.md&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><p>测试目标地址是否可连接、延迟度</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试 github.com 连通性, 按 ctrl + C 停止 </span></span><br><span class="line">ping github.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># ping 5次后断开</span></span><br><span class="line">ping -c 5 xiejiahe.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每5秒ping 一次</span></span><br><span class="line">ping -i 5 xiejiahe.com</span><br></pre></td></tr></table></figure>

<h2 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h2><p>拷贝文件或目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将当前 README.md 文件拷贝到上一层</span></span><br><span class="line">cp ./README.md ../README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -a 将原文件属性一同拷贝</span></span><br><span class="line">cp -a ./README.md ../README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -r 拷贝目录</span></span><br><span class="line">cp -r home ../home</span><br><span class="line"></span><br><span class="line"><span class="comment"># -i 如果目标文件存在会询问用户是否需要覆盖</span></span><br><span class="line">cp -i README.md README.md</span><br></pre></td></tr></table></figure>

<h2 id="which"><a href="#which" class="headerlink" title="which"></a>which</h2><p>查找某个命令存储在哪个位置, 输出绝对路径, <code>which</code>会在环境变量 <code>$PATH</code> 设置的目录里去查找。</p>
<p>注: 可以通过 <code>echo $PATH</code> 查看设置的目录.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> top  <span class="comment"># /usr/bin/top</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找pwd发现会找不到，因为 pwd 是bash的内置命令</span></span><br><span class="line"><span class="built_in">which</span> <span class="built_in">pwd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印多个命令</span></span><br><span class="line"><span class="built_in">which</span> ls vi</span><br></pre></td></tr></table></figure>

<h2 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h2><p>查看指定整个文件内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 README.md 文件所有内容</span></span><br><span class="line">cat README.md</span><br><span class="line">cat README.md README2.md  <span class="comment"># 或者一次性显示多个文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -n 每一行显示行号</span></span><br><span class="line">cat -n README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -b 只给有内容的行显示行号</span></span><br><span class="line">cat -b README.md</span><br></pre></td></tr></table></figure>

<h2 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h2><p><code>mv</code> 有2个用途：</p>
<ul>
<li>将文件或目录移动到另一个位置</li>
<li>将文件或目录重命名</li>
</ul>
<p>注：实际上 <code>mv</code> 是用来移动文件或目录，只不过有类似重命名的功能而已。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 README.md 重命名为 README-2.md, 如果 README-2.md 存在会直接覆盖。</span></span><br><span class="line">mv README.md README-2.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 README.md 移动到上一层目录</span></span><br><span class="line">mv README.md ../README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -i 交互式操作，如果目标文件存在则进行询问是否覆盖</span></span><br><span class="line">mv -i README.md ../README.md</span><br></pre></td></tr></table></figure>

<h2 id="cal"><a href="#cal" class="headerlink" title="cal"></a>cal</h2><p>显示当前日历</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cal</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">     June 2020        </span><br><span class="line">Su Mo Tu We Th Fr Sa  </span><br><span class="line">    1  2  3  4  5  6  </span><br><span class="line"> 7  8  9 10 11 12 13  </span><br><span class="line">14 15 16 17 18 19 20  </span><br><span class="line">21 22 23 24 25 26 27  </span><br><span class="line">28 29 30</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示临近3个月, 只能是3个月</span></span><br><span class="line">cal -3</span><br></pre></td></tr></table></figure>

<h2 id="expr"><a href="#expr" class="headerlink" title="expr"></a>expr</h2><p>执行数学运算，expr 命令比较鸡助，通常在 shell 脚本当中看到。但在shell脚本也不建议用。</p>
<p>expr 后面每个表达式都要有一个空格，否则是不合法。</p>
<p>注：expr 只支持整数运算，这是一个限制。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3</span></span><br><span class="line">expr 1 + 2</span><br><span class="line">expr 1+2 <span class="comment"># 这样是不行的</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在浮点数计算时会丢失小数， 这里等于 2</span></span><br><span class="line">expr 5 / 2</span><br></pre></td></tr></table></figure>

<h2 id="bc"><a href="#bc" class="headerlink" title="bc"></a>bc</h2><p>bash计算器，用来执行数学运算， 与 <code>expr</code> 不同，因为 <code>expr</code> 命令不支持浮点数运算，所以可以用 <code>bc</code>命令替代。</p>
<p>bash计算器实际上是一种编程语言，它允许在命令行中输入浮点表达式，然后解释并计算该表达式。最后返回结果。</p>
<p><code>bc</code> 大多数情况下是在 shell 脚本中使用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 敲 bc 然后回车进入交互式， 输入 quit 退出</span></span><br><span class="line">bc</span><br><span class="line"></span><br><span class="line">scale=2  <span class="comment"># 保留几位小数，默认是0</span></span><br><span class="line">5 / 2</span><br><span class="line"><span class="comment"># 输出 2.50</span></span><br></pre></td></tr></table></figure>

<p><strong>在 shell 脚本使用</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配合管道</span></span><br><span class="line">n=$(<span class="built_in">echo</span> <span class="string">&quot;scale=2; 5 / 2&quot;</span> | bc)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$n</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二种, 内联重定向，解决第一种表达式过长问题</span></span><br><span class="line">n1=$(</span><br><span class="line">bc &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">scale=2</span></span><br><span class="line"><span class="string">5 / 2</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$n1</span></span><br></pre></td></tr></table></figure>

<h2 id="timeout"><a href="#timeout" class="headerlink" title="timeout"></a>timeout</h2><p>在指定时长范围内执行命令，并在规定时间结束后停止进程。</p>
<p>意思是在规定时间内必须完成，否则停止进程。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟超过3秒, 因为sleep阻塞5秒所以在3秒内无法完成，则停止进程</span></span><br><span class="line">time 3 sleep 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 比如打包, 1分钟内要打包完成，否则停止进程</span></span><br><span class="line">time 60 npm run build</span><br></pre></td></tr></table></figure>

<h2 id="exit"><a href="#exit" class="headerlink" title="exit"></a>exit</h2><p>退出当前登录Shell, 可以使用快捷键退出 <code>Ctrl + D</code>。</p>
<p>等价命令 <code>logout</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<h2 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h2><p>vi 编辑器是Unix系统最初的编辑器，在GNU项目将vi编辑器移植到开源世界时，他们决定对其做一些改进，开发人员也就将它重命名为 <code>vi improved</code>。</p>
<p><code>vim</code>(vi improved) 是 <code>vi</code> 的升级版，所以只需要知道 <code>vim</code> 即可， 是一个非强大的文本编辑器，学习成本不低，需要长期使用才能记牢每一个指令操作。</p>
<p>这是一份速查表，使用的时候注意区分大小写。</p>
<p>vim 的快捷键指令非常多，只列出一些实用性便于记忆。</p>
<p><strong>打开文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最简单的打开文件方式, 如果文件不存在会开辟一段新的缓冲区域来编辑。</span></span><br><span class="line">vim README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开文件并定位到最后一行</span></span><br><span class="line">vim + README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开文件并定位到某一行, +号后面指定行数</span></span><br><span class="line">vim +100 README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开多个文件</span></span><br><span class="line"><span class="comment"># :bn 切换下一个文件</span></span><br><span class="line"><span class="comment"># :bp 切换上一个文件</span></span><br><span class="line">vim 1.txt 2.txt</span><br></pre></td></tr></table></figure>

<p><strong>光标定位插入</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>i</td>
<td>在当前光标位置插入</td>
</tr>
<tr>
<td>I</td>
<td>在当前光标行第一个字符插入</td>
</tr>
<tr>
<td>a</td>
<td>在当前光标后一个字符插入</td>
</tr>
<tr>
<td>A</td>
<td>光标到当前行最后一个字符插入</td>
</tr>
<tr>
<td>H</td>
<td>光标到第一行第一个字符 (是以终端大小来计算，不是原文本的第一行)</td>
</tr>
<tr>
<td>M</td>
<td>光标到中间第一行 (是以终端大小来计算)</td>
</tr>
<tr>
<td>L</td>
<td>光标到最后行第一个字符 (是以终端大小来计算)</td>
</tr>
<tr>
<td>E</td>
<td>将光标定位到右边的空格</td>
</tr>
<tr>
<td>o</td>
<td>在当前光标下一行插入</td>
</tr>
<tr>
<td>O</td>
<td>在当前光标上一行插入</td>
</tr>
</tbody></table>
<p><strong>撤销</strong> | 快捷键 | 描述 | | ———- |—————– | | u | 撤销上一次编辑内容 | | U | 撤销当前光标整行内容 | | Ctrl + r | 还原初始文件状态 |</p>
<p><strong>删除</strong> | 快捷键 | 描述 | | ———- |—————– | | dd | 删除当前行 | | dj | 删除上一行 | | dk | 删除下一行 | | :1,$d | 删除所有行 |</p>
<p><strong>拷贝/粘贴</strong> | 快捷键 | 描述 | | ———- |—————– | | yy | 拷贝当前行 | | p | 在当前光标粘贴上一次拷贝的内容 |</p>
<p><strong>搜索</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>:/text</td>
<td>从上往下查找 text，按 <code>n</code> 向下搜索, 按 <code>N</code> 想前搜索</td>
</tr>
<tr>
<td>:?text</td>
<td>从下往上查找 text，按 <code>n</code> 向下搜索, 按 <code>N</code> 想前搜索</td>
</tr>
</tbody></table>
<p><strong>替换</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>:s/old/new</td>
<td>找到old第一次出现的地方并用new来替换</td>
</tr>
<tr>
<td>:s/old/new/g</td>
<td>找到所有old出现的地方并用new来替换(当前屏幕)</td>
</tr>
<tr>
<td>:%s/old/new/g</td>
<td>替换整个文件中的所有old</td>
</tr>
<tr>
<td>:%s/old/new/gc</td>
<td>替换整个文件中的所有old，但在每次出现时提示</td>
</tr>
<tr>
<td>:n,ms/old/new/g</td>
<td>替换行号n和m之间的所有old</td>
</tr>
</tbody></table>
<p><strong>退出</strong></p>
<p>先按 <code>ESC</code> 键然后再操作后面的快捷键。</p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>:w</td>
<td>写入但不退出</td>
</tr>
<tr>
<td>:q!</td>
<td>退出但不保存</td>
</tr>
<tr>
<td>:wq</td>
<td>保存写入内容并退出</td>
</tr>
</tbody></table>
<p><strong>设置</strong></p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>:set ignorecase</td>
<td>忽略大小写查找</td>
</tr>
<tr>
<td>:set noignorecase</td>
<td>不忽略大小写查找</td>
</tr>
<tr>
<td>:set hlsearch</td>
<td>高亮搜索结果</td>
</tr>
<tr>
<td>:set nohlsearch</td>
<td>关闭高亮搜索显示</td>
</tr>
<tr>
<td>:set hlsearch</td>
<td>高亮搜索结果</td>
</tr>
<tr>
<td>:set number</td>
<td>显示行号</td>
</tr>
<tr>
<td>:set nonumber</td>
<td>不显示行号</td>
</tr>
</tbody></table>
<h2 id="basename"><a href="#basename" class="headerlink" title="basename"></a>basename</h2><p>打印目录或者文件的基本名称。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出：index.html</span></span><br><span class="line">basename /www/index.html</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出 www</span></span><br><span class="line">basename /www/</span><br></pre></td></tr></table></figure>

<h2 id="read"><a href="#read" class="headerlink" title="read"></a>read</h2><p><code>read</code> 命令从标准输入（键盘）或另一个文件描述符中接收输入。 通常用在Shell脚本, 在收到输入后，read命令会将数据存放进一个变量。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最简单用法, data 是自定义变量名，用户输入内容并回车后结束</span></span><br><span class="line"><span class="built_in">read</span> data <span class="comment"># echo $data  会打印用户输入的内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -p 指定提示符</span></span><br><span class="line"><span class="built_in">read</span> -p 确认要删除吗？ data</span><br><span class="line"></span><br><span class="line"><span class="comment"># -t 指定超时（秒）</span></span><br><span class="line"><span class="built_in">read</span> -t 5 -p 确认要删除吗？ data</span><br><span class="line"></span><br><span class="line"><span class="comment"># —s 隐藏用户输入，比如密码，实际上是将文本颜色设置成背景颜色一样</span></span><br><span class="line"><span class="built_in">read</span> -s -p <span class="string">&quot;请输入您的密码：&quot;</span> data</span><br></pre></td></tr></table></figure>

<h2 id="tee"><a href="#tee" class="headerlink" title="tee"></a>tee</h2><p>tee命令相当于管道的一个T型接头，它将从<code>STDIN标准输入</code>过来的数据同时发往两处，一处是<code>STDOUT</code>，另一处是tee命令指定的文件名。</p>
<p>tee 命令通常用于 shell 脚本当中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># date内容打印到屏幕上并且重定向输出到 date.txt 文件中</span></span><br><span class="line">date | tee date.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># -a 以追加方式，默认情况下会覆盖输出文件内容</span></span><br><span class="line">date | tee -a date.txt</span><br></pre></td></tr></table></figure>

<p><code>tee</code> 命令只是一个语法糖，如果不用 <code>tee</code> 可以这样做：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、将date结果保存到 var 变量中</span></span><br><span class="line">var=$(date)</span><br><span class="line"><span class="comment"># 2、将结果打印到屏幕上 STDOUT</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$var</span></span><br><span class="line"><span class="comment"># 3、将结果重定向到文件</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$var</span> &gt; date.txt</span><br></pre></td></tr></table></figure>

<h2 id="last"><a href="#last" class="headerlink" title="last"></a>last</h2><p>显示用户最近登录信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">last <span class="comment"># root     pts/0        183.58.247.64    Sun Jan  5 13:57 - 14:28  (00:30)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定显示条目数</span></span><br><span class="line">last -n 1</span><br></pre></td></tr></table></figure>

<h2 id="shutdown"><a href="#shutdown" class="headerlink" title="shutdown"></a>shutdown</h2><p>将系统关机或重启操作。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 立即重启系统</span></span><br><span class="line">shutdown -r now</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭系统并切断电源</span></span><br><span class="line">shutdown -h now <span class="comment"># 立即关机, 实际上调用 init 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 把前一个关机或重启取消掉</span></span><br><span class="line">shutdown -c</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定一个时间关机,  &quot;&amp;&quot; 符号表示后台模式，让出CLI</span></span><br><span class="line">shutdown -h 05:33 &amp;</span><br><span class="line">shutdown +5 <span class="string">&quot;5分钟后关机&quot;</span> <span class="comment"># 5分钟后关机，同时送出警告信息给登入用户：</span></span><br></pre></td></tr></table></figure>

<h2 id="reboot"><a href="#reboot" class="headerlink" title="reboot"></a>reboot</h2><p>有点类似 <code>shutdown</code> 命令， 用于重新启动系统。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重启系统</span></span><br><span class="line">reboot</span><br><span class="line"></span><br><span class="line"><span class="comment"># -f 强制重启</span></span><br><span class="line">reboot -f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用于模拟重新启动系统，不会真实重启，数据会写入 /var/log/wtmp </span></span><br><span class="line">reboot -w</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在重新启动之前关闭所有网络界面</span></span><br><span class="line">reboot -i</span><br></pre></td></tr></table></figure>

<h2 id="uname"><a href="#uname" class="headerlink" title="uname"></a>uname</h2><p>打印系统信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不带任何参数打印当前操作系统内核名称</span></span><br><span class="line">uname <span class="comment"># Linux , 等价于 uname -s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印系统所有信息</span></span><br><span class="line">uname -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># -r 打印系统版本 , 如果次版本号都是偶数，说明是一个稳定版</span></span><br><span class="line">uname -r <span class="comment"># 3.10.0-514.26.2.el7.x86_64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印网络节点主机名称</span></span><br><span class="line">uname -n <span class="comment"># Yin.local</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印处理器名称</span></span><br><span class="line">uname -p <span class="comment"># i386</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印主机的硬件架构名称</span></span><br><span class="line">uname -m <span class="comment"># x86_64</span></span><br></pre></td></tr></table></figure>

<h2 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h2><p>配置或显示系统网卡的网络参数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示所有网络参数信息</span></span><br><span class="line">ifconfig</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置网卡IP地址</span></span><br><span class="line">ifconfig eth0 192.168.1.111</span><br></pre></td></tr></table></figure>

<h2 id="who"><a href="#who" class="headerlink" title="who"></a>who</h2><p>显示当前所有用户登录信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示当前登录系统的用户</span></span><br><span class="line">who</span><br><span class="line">xiejiahe console  Jun 15 21:38</span><br><span class="line">xiejiahe ttys001  Jun 15 21:44</span><br><span class="line">xiejiahe ttys002  Jun 15 21:44</span><br><span class="line">xiejiahe ttys003  Jun 15 21:44</span><br><span class="line">xiejiahe ttys004  Jun 15 21:44</span><br><span class="line">xiejiahe ttys005  Jun 15 21:44</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示登录账号名和总人数</span></span><br><span class="line">who -q</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示上次系统启动时间</span></span><br><span class="line">who -b  <span class="comment"># reboot   ~        Jun 15 21:38</span></span><br></pre></td></tr></table></figure>

<h2 id="whereis"><a href="#whereis" class="headerlink" title="whereis"></a>whereis</h2><p>用来定位指令的二进制程序、源代码文件和man手册页等相关文件的路径。</p>
<p>注意：<code>whereis</code> 是从数据库里查找的，因此特别快，默认情况下一星期更新一次数据，所以有时会查找删除的数据或者刚建立的数据无法找到问题。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找 nginx</span></span><br><span class="line">whereis nginx <span class="comment"># nginx: /usr/sbin/nginx /usr/lib64/nginx /etc/nginx /usr/share/nginx /usr/share/man/man8/nginx.8.gz /usr/share/man/man3/nginx.3pm.gz</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -b 指定只查找二进制</span></span><br><span class="line"><span class="built_in">where</span> -b nginx <span class="comment"># nginx: /usr/sbin/nginx /usr/lib64/nginx /etc/nginx /usr/share/nginx</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -m 指定查找说明文件 man</span></span><br><span class="line">whereis -m nginx <span class="comment"># nginx: /usr/share/man/man8/nginx.8.gz /usr/share/man/man3/nginx.3pm.gz</span></span><br></pre></td></tr></table></figure>

<h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><p>归档数据，将目录或文件归档为 <code>.zip</code> 格式， zip 不是Linux中的标准归档工具。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 归档文件</span></span><br><span class="line">zip README.zip README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 归档目录需要 -r 递归处理</span></span><br><span class="line">zip -r temp.zip temp</span><br><span class="line"></span><br><span class="line"><span class="comment"># -S 包含系统隐藏文件</span></span><br><span class="line">zip -r -S temp.zip temp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定归档效率 1-9</span></span><br><span class="line">zip -r -9 temp.zip temp </span><br></pre></td></tr></table></figure>

<h2 id="unzip"><a href="#unzip" class="headerlink" title="unzip"></a>unzip</h2><p>提取 <code>zip</code> 归档的文件或目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 demo.zip 提取到当前目录下</span></span><br><span class="line">unzip demo.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表 demo.zip 文件内容，但不提取</span></span><br><span class="line">unzip -v demo.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># -d 指定将文件提取到 src 目录下</span></span><br><span class="line">unzip demo.zip -d src</span><br></pre></td></tr></table></figure>

<h2 id="locate"><a href="#locate" class="headerlink" title="locate"></a>locate</h2><p>搜索文件，与 <code>find</code> 命令很像，但更快，因为是从数据库里查找, 通常每天会进行数据更新。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 搜索 README.md 相关文件</span></span><br><span class="line">locate README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略大小写</span></span><br><span class="line">locate -i README.md</span><br></pre></td></tr></table></figure>

<h2 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h2><p>结束程序，kill 命令只支持进程id杀死，不支持进程名称。</p>
<h4 id="进程信号"><a href="#进程信号" class="headerlink" title="进程信号"></a>进程信号</h4><table>
<thead>
<tr>
<th>信号</th>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>HUP</td>
<td>挂起</td>
</tr>
<tr>
<td>2</td>
<td>INT</td>
<td>中断</td>
</tr>
<tr>
<td>3</td>
<td>QUIT</td>
<td>结束运行</td>
</tr>
<tr>
<td>9</td>
<td>KILL</td>
<td>无条件终止</td>
</tr>
<tr>
<td>11</td>
<td>SEGV</td>
<td>段错误</td>
</tr>
<tr>
<td>15</td>
<td>TERM</td>
<td>尽可能终止</td>
</tr>
<tr>
<td>17</td>
<td>STOP</td>
<td>无条件停止运行，但不终止</td>
</tr>
<tr>
<td>18</td>
<td>TSTP</td>
<td>停止或暂停，但继续在后台运行</td>
</tr>
<tr>
<td>19</td>
<td>CONT</td>
<td>在STOP或TSTP之后恢复执行</td>
</tr>
</tbody></table>
<p>注：程序进程 id 可通过 <code>top</code> 等命令查看。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 杀死 pid 为88 进程，不带参数默认等价 kill -15</span></span><br><span class="line"><span class="built_in">kill</span> 88</span><br><span class="line"></span><br><span class="line"><span class="comment"># 无条件终止进程，以下是等价，可以用进程名称信号</span></span><br><span class="line"><span class="built_in">kill</span> -KILL 88</span><br><span class="line"><span class="built_in">kill</span> -9 88</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示信号</span></span><br><span class="line"><span class="built_in">kill</span> -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 杀死指定用户的所有进程</span></span><br><span class="line"><span class="built_in">kill</span> -u nginx</span><br></pre></td></tr></table></figure>

<h2 id="killall"><a href="#killall" class="headerlink" title="killall"></a>killall</h2><p>杀死进程，可以杀死多个进程，比 <code>kill</code> 要强大, 支持通过进程名称杀死, 还支持通配符。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 杀死以tcp进程名称开头的所有进程</span></span><br><span class="line">killall tcp*</span><br></pre></td></tr></table></figure>

<h2 id="chmod"><a href="#chmod" class="headerlink" title="chmod"></a>chmod</h2><p>修改文件或目录权限</p>
<p>chmod [参数选项] [mode, 八进制或符号表示] files…</p>
<ul>
<li><code>u</code> 符号代表当前用户。</li>
<li><code>g</code> 符号代表和当前用户在同一个组的用户，以下简称组用户。</li>
<li><code>o</code> 符号代表其他用户。</li>
<li><code>a</code> 符号代表所有用户。</li>
<li><code>r</code> 符号代表读权限以及八进制数4。</li>
<li><code>w</code> 符号代表写权限以及八进制数2。</li>
<li><code>x</code> 符号代表执行权限以及八进制数1。</li>
<li><code>X</code> 符号代表如果目标文件是可执行文件或目录，可给其设置可执行权限。</li>
<li><code>s</code> 符号代表设置权限suid和sgid，使用权限组合u+s设定文件的用户的ID位，g+s设置组用户ID位。</li>
<li><code>t</code> 符号代表只有目录或文件的所有者才可以删除目录下的文件。</li>
<li><code>+</code> 符号代表添加目标用户相应的权限。</li>
<li><code>-</code> 符号代表删除目标用户相应的权限。</li>
<li><code>=</code> 符号代表添加目标用户相应的权限，删除未提到的权限。</li>
</ul>
<h4 id="文件权限码"><a href="#文件权限码" class="headerlink" title="文件权限码"></a>文件权限码</h4><table>
<thead>
<tr>
<th>权限</th>
<th>二进制值</th>
<th>八进制值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>—</td>
<td>000</td>
<td>0</td>
<td>没有任何权限</td>
</tr>
<tr>
<td>–x</td>
<td>001</td>
<td>1</td>
<td>只有执行权限</td>
</tr>
<tr>
<td>-w-</td>
<td>010</td>
<td>2</td>
<td>只有写入权限</td>
</tr>
<tr>
<td>-wx</td>
<td>011</td>
<td>3</td>
<td>有写入和执行权限</td>
</tr>
<tr>
<td>r–</td>
<td>100</td>
<td>4</td>
<td>只有读取权限</td>
</tr>
<tr>
<td>r-x</td>
<td>101</td>
<td>5</td>
<td>有读取和执行权限</td>
</tr>
<tr>
<td>rw-</td>
<td>110</td>
<td>6</td>
<td>有读取和写入权限</td>
</tr>
<tr>
<td>rwx</td>
<td>111</td>
<td>7</td>
<td>有全部权限</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># README.md 文件设为所有用户可读取</span></span><br><span class="line">chmod a+r README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -R 递归目录下所有文件</span></span><br><span class="line">chmod a+r src/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以用八进制符号表示</span></span><br><span class="line"><span class="comment"># 3个数字分别为 x,y,z 表示User、Group、及Other的权限。</span></span><br><span class="line"><span class="comment"># r=4, w=2, x=1</span></span><br><span class="line">chmod 777 README.md <span class="comment"># 等价于 chmod a=rwx README.md</span></span><br></pre></td></tr></table></figure>

<h2 id="lsof"><a href="#lsof" class="headerlink" title="lsof"></a>lsof</h2><p>列出当前系统打开文件的工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 打印所有打开文件的的列表</span></span><br><span class="line">lsof</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定端口被占用情况</span></span><br><span class="line">lsof -i:8080</span><br><span class="line"></span><br><span class="line"><span class="comment"># -p 列出指定进程号所打开的文件</span></span><br><span class="line">lsof -p 6112</span><br></pre></td></tr></table></figure>

<h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><p>查看当前系统进程状态。</p>
<p><code>ps</code> 命令非常复杂，且参数极多，由于 <code>ps</code> 历史问题，参数风格支持了三种 <code>UNIX</code>/<code>BSD</code>/``GNU` 这里不详细的介绍，感兴趣可以自行了解。</p>
<ul>
<li>Unix 风格参数 - 前面加单破折线</li>
<li>BSD 风格的参数 - 前面不加破折线</li>
<li>GNU 风格长参数 - 前面加双破折线</li>
</ul>
<h4 id="Unix-风格参数"><a href="#Unix-风格参数" class="headerlink" title="Unix 风格参数"></a>Unix 风格参数</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>-A</td>
<td>显示所有进程</td>
</tr>
<tr>
<td>-N</td>
<td>显示与指定参数不符的所有进程</td>
</tr>
<tr>
<td>-a</td>
<td>显示除控制进程和无终端进程外的所有进程</td>
</tr>
<tr>
<td>-d</td>
<td>显示除控制进程外的所有进程</td>
</tr>
<tr>
<td>-e</td>
<td>显示所有进程</td>
</tr>
<tr>
<td>-C cmdlist</td>
<td>显示包含在cmdlist列表中的进程</td>
</tr>
<tr>
<td>-G grplist</td>
<td>显示组ID在grplist列表中的进程</td>
</tr>
<tr>
<td>-U userlist</td>
<td>显示属主的用户ID在userlist列表中的进程</td>
</tr>
<tr>
<td>-g grplist</td>
<td>显示会话或组ID在grplist列表中的进程</td>
</tr>
<tr>
<td>-p pidlist</td>
<td>显示PID在pidlist列表中的进程</td>
</tr>
<tr>
<td>-s sesslist</td>
<td>显示会话ID在sesslist列表中的进程</td>
</tr>
<tr>
<td>-t ttylist</td>
<td>显示终端ID在ttylist列表中的进程</td>
</tr>
<tr>
<td>-u userlist</td>
<td>显示有效用户ID在userlist列表中的进程</td>
</tr>
<tr>
<td>-F</td>
<td>显示更多额外输出（相对-f参数而言）</td>
</tr>
<tr>
<td>-O format</td>
<td>显示默认的输出列以及format列表指定的特定列</td>
</tr>
<tr>
<td>-M</td>
<td>显示进程的安全信息</td>
</tr>
<tr>
<td>-c</td>
<td>显示进程的额外条调度器信息</td>
</tr>
<tr>
<td>-l</td>
<td>显示长列表</td>
</tr>
<tr>
<td>-o format</td>
<td>仅显示由format指定的列表</td>
</tr>
<tr>
<td>-y</td>
<td>不要显示进程标记（process tag, 表明进程状态的标记）</td>
</tr>
<tr>
<td>-Z</td>
<td>显示安全标签（security context）信息</td>
</tr>
<tr>
<td>-H</td>
<td>用层级格式来显示进程（树状，用来显示父进程）</td>
</tr>
<tr>
<td>-n namelist</td>
<td>定义了WCHAN列显示的值</td>
</tr>
<tr>
<td>-w</td>
<td>采用宽输出模式，不限宽显示</td>
</tr>
<tr>
<td>-L</td>
<td>显示进程中的线程</td>
</tr>
<tr>
<td>-V</td>
<td>显示PS命令的版本号</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示所有进程信息</span></span><br><span class="line">ps -A</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示指定用户进程信息</span></span><br><span class="line">ps -u root</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有进程信息包括命令行</span></span><br><span class="line">ps -ef  <span class="comment"># -e 等价于 -A  , 即等价于 ps -Af</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这是 BSD 风格参数，列出所有正在内存中的进程</span></span><br><span class="line">ps aux</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配合 grep 查询指定进程</span></span><br><span class="line">ps -ef | grep nginx</span><br></pre></td></tr></table></figure>

<h2 id="open"><a href="#open" class="headerlink" title="open"></a>open</h2><p><code>open</code> 命令可在 <code>linux</code> / <code>mac</code> 具有可视化界面下进行文本编辑、打开应用程序等功能。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在mac下用Finder打开当前目录</span></span><br><span class="line">open .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用默认应用程序打开文件</span></span><br><span class="line">open README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用默认编辑器打开文件</span></span><br><span class="line">open -e README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果是一个URL用默认浏览器打开页面</span></span><br><span class="line">open https://github.com/xjh22222228/linux-manual.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定某个应用程序打开某个文件, 如果不指定文件默认直接打开程序</span></span><br><span class="line">open -a /Applications/Google\ Chrome.app README.md</span><br></pre></td></tr></table></figure>

<h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p><code>curl</code> 是一个非常强大的网络传输工具, 利用URL规则在命令行下工作的文件传输工具。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看HTTP响应</span></span><br><span class="line">curl https://github.com/xjh22222228/linux-manual</span><br><span class="line"></span><br><span class="line"><span class="comment"># -s 不输出错误和进度信息, 只显示正常结果</span></span><br><span class="line">curl -s https://github.com/xjh22222228/linux-manual</span><br><span class="line"></span><br><span class="line"><span class="comment"># -o 指定文件名下载到本地，等价于 wget</span></span><br><span class="line">curl https://github.com/xjh22222228/linux-manual -o 1.txt <span class="comment"># 1.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -O 下载文件到本地, 并将URL最后部分当做文件名</span></span><br><span class="line">curl https://github.com/xjh22222228/linux-manual -O <span class="comment"># linux-manual</span></span><br><span class="line">curl https://github.com/xjh22222228/linux-manual -O --progress <span class="comment"># 显示下载进度条</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -L HTTP请求跟随服务器重定向</span></span><br><span class="line">curl -L https://github.com/xjh22222228/linux-manual</span><br><span class="line"></span><br><span class="line"><span class="comment"># -I 或 -head 显示HTTP响应报文</span></span><br><span class="line">curl https://github.com/xjh22222228/linux-manual -I</span><br><span class="line"></span><br><span class="line"><span class="comment"># -H 设置请求头</span></span><br><span class="line">curl -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> https://github.com/xjh22222228/linux-manual</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过POST请求发送JSON数据, -X 指明HTTP请求方法, -d 实体内容</span></span><br><span class="line">curl -H <span class="string">&quot;Content-type: application/json&quot;</span> -X POST -d <span class="string">&#x27;&#123;&quot;age&quot;:&quot;18&quot;&#125;&#x27;</span> https://github.com/xjh22222228/linux-manual</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送时携带 cookie</span></span><br><span class="line">curl https://github.com/xjh22222228/linux-manual --cookie <span class="string">&quot;age=18;name=xjh&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -v 查看整个传输过程</span></span><br><span class="line">curl https://github.com/xjh22222228/linux-manual -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># -F(--form) 利用POST上传文件, file 是字段名, =@ 必须存在</span></span><br><span class="line">curl https://example.com/upload -F <span class="string">&quot;file=@/home/demo.png&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -u 指定提供用户名密码进行授权，通常Ftp等服务</span></span><br><span class="line">curl -u admin:123123 ftp://demo/README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载并执行脚本</span></span><br><span class="line">curl -fsSL https://deno.land/x/install/install.sh | sh</span><br></pre></td></tr></table></figure>

<h2 id="date"><a href="#date" class="headerlink" title="date"></a>date</h2><p>显示或设置系统时间日期</p>
<p>格式化符号</p>
<ul>
<li><code>%%</code> 百分号</li>
<li><code>%a</code> 当地缩写的工作日名称（例如，Sun）</li>
<li><code>%A</code> 当地完整的工作日名称（例如，Sunday）</li>
<li><code>%b</code> 当地缩写的月份名称（例如，Jan）</li>
<li><code>%B</code> 当地完整的月份名称（例如，January）</li>
<li><code>%c</code> 当地的日期和时间（例如，Thu Mar 3 23:05:25 2005）</li>
<li><code>%C</code> 世纪，和%Y类似，但是省略后两位（例如，20）</li>
<li><code>%d</code> 一月中的一天（例如，01）</li>
<li><code>%D</code> 日期，等价于%m/%d/%y</li>
<li><code>%e</code> 一月中的一天，格式使用空格填充，等价于%_d</li>
<li><code>%F</code> 完整的日期；等价于%+4Y-%m-%d</li>
<li><code>%g</code> ISO标准计数周的年份的最后两位数字</li>
<li><code>%G</code> ISO标准计数周的年份，通常只对%V有用</li>
<li><code>%h</code> 等价于%b</li>
<li><code>%H</code> 小时，范围（00..23）</li>
<li><code>%I</code> 小时，范围（00..23）</li>
<li><code>%j</code> 一年中的一天，范围（001..366）</li>
<li><code>%k</code> 小时，使用空格填充，范围（0..23），等价于%_H</li>
<li><code>%l</code> 小时，使用空格填充，范围（1..12），等价于%_I</li>
<li><code>%m</code> 月，范围（01..12）</li>
<li><code>%M</code> 分钟，范围（00..59）</li>
<li><code>%n</code> 换行符</li>
<li><code>%N</code> 纳秒，范围（000000000..000000000）</li>
<li><code>%p</code> 用于表示当地的AM或PM，如果未知则为空白</li>
<li><code>%P</code> 类似于%p，但用小写表示</li>
<li><code>%q</code> 季度，范围（1..4）</li>
<li><code>%r</code> 当地以12小时表示的时钟时间（例如，11:11:04 PM）</li>
<li><code>%R</code> 24小时每分钟；等价于%H:%M</li>
<li><code>%s</code> 自协调世界时1970年01月01日00时00分以来的秒数</li>
<li><code>%S</code> 秒数，范围（00..60）</li>
<li><code>%t</code> 水平制表符</li>
<li><code>%T</code> 时间；等价于%H:%M:%S</li>
<li><code>%u</code> 一周中的一天（1..7），1代表星期一</li>
<li><code>%U</code> 一年中的第几周，周日作为一周的起始（00..53）</li>
<li><code>%V</code> ISO标准计数周，该方法将周一作为一周的起始（01..53）</li>
<li><code>%w</code> 一周中的一天（0..6），0代表星期天</li>
<li><code>%W</code> 一年中的第几周，周一作为一周的起始（00..53）</li>
<li><code>%x</code> 当地的日期表示（例如，12/31/99）</li>
<li><code>%X</code> 当地的时间表示（例如，23:13:48）</li>
<li><code>%y</code> 年份后两位数字，范围（00..99）</li>
<li><code>%Y</code> 年份</li>
<li><code>%z</code> +hhmm格式的数值化时区格式（例如，-0400）</li>
<li><code>%:z</code> +hh:mm格式的数值化时区格式（例如，-04:00）</li>
<li><code>%::z</code> +hh:mm:ss格式的数值化时区格式（例如，-04:00:00）</li>
<li><code>%:::z</code> 数值化时区格式，相比上一个格式增加’:’以显示必要的精度（例如，-04，+05:30）</li>
<li><code>%Z</code> 时区缩写（如EDT）</li>
<li><code>-</code> (连字符) 不要填充相应的字段。</li>
<li><code>_</code> (下划线) 使用空格填充相应的字段。</li>
<li><code>0</code> (数字0) 使用数字0填充相应的字段。</li>
<li><code>+</code> 用数字0填充，未来年份大于4位数字则在前面加上’+’号。</li>
<li><code>^</code> 允许的情况下使用大写。</li>
<li><code>#</code> 允许的情况下将默认的大写转换为小写，默认的小写转换为大写。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示当前时间</span></span><br><span class="line">date</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化当前时间</span></span><br><span class="line">date +<span class="string">&quot;%Y-%m-%d %H:%M.%S&quot;</span> <span class="comment"># 2020-07-01 00:00.00</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置系统时间</span></span><br><span class="line">date -s  <span class="comment"># 设置当前时间, 须root</span></span><br><span class="line">date -s <span class="string">&quot;2020-07-01 00:00:00&quot;</span> <span class="comment"># 设置全部时间</span></span><br></pre></td></tr></table></figure>

<h2 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h2><p>查看网络系统状态信息</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>a或–all</td>
<td>显示所有连线中的Socket</td>
</tr>
<tr>
<td>A&lt;网络类型&gt;或–&lt;网络类型&gt;</td>
<td>列出该网络类型连线中的相关地址</td>
</tr>
<tr>
<td>c或–continuous</td>
<td>持续列出网络状态</td>
</tr>
<tr>
<td>C或–cache</td>
<td>显示路由器配置的快取信息</td>
</tr>
<tr>
<td>e或–extend</td>
<td>显示网络其他相关信息</td>
</tr>
<tr>
<td>F或–fib</td>
<td>显示FIB</td>
</tr>
<tr>
<td>g或–groups</td>
<td>显示多重广播功能群组组员名单</td>
</tr>
<tr>
<td>h或–help</td>
<td>在线帮助</td>
</tr>
<tr>
<td>i或–interfaces</td>
<td>显示网络界面信息表单</td>
</tr>
<tr>
<td>l或–listening</td>
<td>显示监控中的服务器的Socket</td>
</tr>
<tr>
<td>M或–masquerade</td>
<td>显示伪装的网络连线</td>
</tr>
<tr>
<td>n或–numeric</td>
<td>直接使用IP地址，而不通过域名服务器</td>
</tr>
<tr>
<td>N或–netlink或–symbolic</td>
<td>显示网络硬件外围设备的符号连接名称</td>
</tr>
<tr>
<td>o或–timers</td>
<td>显示计时器</td>
</tr>
<tr>
<td>p或–programs</td>
<td>显示正在使用Socket的程序识别码和程序名称</td>
</tr>
<tr>
<td>r或–route</td>
<td>显示Routing Table</td>
</tr>
<tr>
<td>s或–statistics</td>
<td>显示网络工作信息统计表</td>
</tr>
<tr>
<td>t或–tcp</td>
<td>显示TCP传输协议的连线状况</td>
</tr>
<tr>
<td>u或–udp</td>
<td>显示UDP传输协议的连线状况</td>
</tr>
<tr>
<td>v或–verbose</td>
<td>显示指令执行过程</td>
</tr>
<tr>
<td>V或–version</td>
<td>显示版本信息</td>
</tr>
<tr>
<td>w或–raw</td>
<td>显示RAW传输协议的连线状况</td>
</tr>
<tr>
<td>x或–unix</td>
<td>此参数的效果和指定”-A unix”参数相同</td>
</tr>
<tr>
<td>-ip或–inet</td>
<td>此参数的效果和指定”-A inet”参数相同</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出所有占用端口</span></span><br><span class="line">netstat -ntlp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有网络状况</span></span><br><span class="line">netstat -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有tcp网络状况</span></span><br><span class="line">netstat -at</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有udp网络状况</span></span><br><span class="line">netstat -au</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配合grep命令查看某个端口被占用情况</span></span><br><span class="line">netstat -ap | grep 8080</span><br></pre></td></tr></table></figure>

<h2 id="w"><a href="#w" class="headerlink" title="w"></a>w</h2><p>查看当前登入系统的用户信息, 有哪些用户正在登陆, 以及他们正在执行的程序。</p>
<p>此命令与 <code>who</code> 相似，默认情况下比 <code>who</code> 命令输出内容更详细。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">w</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"> 22:44:33 up 748 days, 14:16,  1 user,  load average: 0.04, 0.03, 0.05</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     pts/0    183.11.111.11    22:40    1.00s  0.03s  0.00s w</span><br></pre></td></tr></table></figure>

<h2 id="chown"><a href="#chown" class="headerlink" title="chown"></a>chown</h2><p>用来变更文件或目录的拥有者或所属群组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 README.md 文件拥有者设为 byroot</span></span><br><span class="line">chown byroot README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-R递归处理文件</span></span><br><span class="line">chown -R byroot src/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 改变所属群组, 拥有者设为 byroot 群组设为 byrootgroup</span></span><br><span class="line">chown byroot:byrootgroup README.md</span><br></pre></td></tr></table></figure>

<h2 id="uptime"><a href="#uptime" class="headerlink" title="uptime"></a>uptime</h2><p>查看系统负载信息， 此命令非常简单，没有太多的参数。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 21:51:53 当前时间</span></span><br><span class="line"><span class="comment"># up 750 days, 13:24  当前系统运行的天数，小时，分钟 （从上次开机起计算）</span></span><br><span class="line"><span class="comment"># 1 user 当前系统登录用户数</span></span><br><span class="line"><span class="comment"># load average: 0.08, 0.07, 0.06    一分钟、5分钟、15分钟平均负载, 这3个值不能大于CPU个数，如果大于了说明系统负载高，性能低。</span></span><br><span class="line">uptime <span class="comment"># 21:51:53 up 750 days, 13:24,  1 user,  load average: 0.08, 0.07, 0.06</span></span><br></pre></td></tr></table></figure>

<h2 id="chattr"><a href="#chattr" class="headerlink" title="chattr"></a>chattr</h2><p>用于修改文件属性</p>
<p>参数:</p>
<ul>
<li>a：让文件或目录仅供附加用途</li>
<li>b：不更新文件或目录的最后存取时间</li>
<li>c：将文件或目录压缩后存放</li>
<li>d：将文件或目录排除在倾倒操作之外</li>
<li>i：不得任意更动文件或目录</li>
<li>s：保密性删除文件或目录</li>
<li>S：即时更新文件或目录</li>
<li>u：预防意外删除</li>
<li>-R：递归处理，将指令目录下的所有文件及子目录一并处理</li>
<li>-v&lt;版本编号&gt;：设置文件或目录版本</li>
<li>-V：显示指令执行过程</li>
<li>+&lt;属性&gt;：开启文件或目录的该项属性</li>
<li>-&lt;属性&gt;：关闭文件或目录的该项属性</li>
<li>=&lt;属性&gt;：指定文件或目录的该项属性</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 锁定该文件, 防止文件被修改或删除</span></span><br><span class="line">chattr +i README.md  <span class="comment"># chattr -i README.md  解锁</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以使用 lsattr 查看赋予的属性</span></span><br><span class="line">lsattr README.md</span><br></pre></td></tr></table></figure>

<h2 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h2><p>GNU 压缩/解压工具，用 Lempel-Ziv编码，格式为 <code>.gz</code>, 压缩后原文件将被删除</p>
<p>注意：gzip 不能用于压缩整个目录, 只能用于压缩文件, 如果需要压缩整个目录可以考虑使用 <a href="#zip">zip</a> 命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 压缩 README.md 文件, 压缩完成后 README.md 文件会被删除</span></span><br><span class="line">gzip README.md <span class="comment"># README.md.gz</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归压缩目录下的所有文件</span></span><br><span class="line">gzip -r ./logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加 -v 显示压缩执行过程</span></span><br><span class="line">gzip -rv ./logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># 压缩 .tar 后缀文件</span></span><br><span class="line">gzip -r src.tar  <span class="comment"># 压缩后为 src.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -d 解压之前gzip压缩后的文件</span></span><br><span class="line">gzip -d README.md</span><br><span class="line">gzip -dr ./logs <span class="comment"># 或者递归解压目录下的所有文件</span></span><br></pre></td></tr></table></figure>

<h2 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2"></a>bzip2</h2><p>采用 Burrows-Wheeler块排序文本压缩算法和霍夫曼编码，将文件压缩成 <code>.bz2</code> 格式，也可用于解压 <code>.bz2</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 压缩 README.md 文件</span></span><br><span class="line">bzip2 README.md     <span class="comment"># 不保留源文件 README.md.bz2</span></span><br><span class="line">bzip2 -k README.md  <span class="comment"># -k 保留源文件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">bzip2 -d README.md.bz2  <span class="comment"># 源文件将被删除</span></span><br><span class="line">bzip2 -dk README.md.bz2  <span class="comment"># -k 保留源文件</span></span><br><span class="line">bzip -dt README.md.bz2 <span class="comment"># -t --test 测试解压, 实际不解压，模拟整个解压过程</span></span><br></pre></td></tr></table></figure>

<h2 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h2><p>归档数据，是Linux中标准归档工具。</p>
<p>参数：</p>
<ul>
<li>-A - 将一个已有tar归档文件追加到另一个已有tar归档文件</li>
<li>-c 创建一个新的tar归档文件</li>
<li>-d 检查归档文件和文件系统的不同之处</li>
<li>-r 追加文件到已有tar归档文件结尾</li>
<li>-t 列出已有tar归档文件的内容</li>
<li>-u 将比tar归档文件中已有的同名文件新的文件追加到该tar归档文件中</li>
<li>-x 从已有的tar归档文件中提取文件</li>
<li>-f 输出结果到文件或设备file</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -c 创建一个归档文件</span></span><br><span class="line">tar -cvf demo.tar src/</span><br><span class="line"></span><br><span class="line"><span class="comment"># -x 提取归档文件内容</span></span><br><span class="line">tar -xvf demo.tar</span><br></pre></td></tr></table></figure>

<h2 id="more"><a href="#more" class="headerlink" title="more"></a>more</h2><p>分页查看文件内容, 每次查看一屏, 每屏能显示多少内容取决于终端大小。</p>
<p>与 <code>cat</code> 命令不同，<code>cat</code> 只能一次显示全部内容，如果内容太多部分会被截取掉。</p>
<p>快捷键：</p>
<ul>
<li><code>空格</code>或<code>PageUp</code> - 查看下一屏内容</li>
<li><code>B</code>或<code>PageDown</code> - 查看上一屏内容</li>
<li><code>回车</code> - 查看下一行内容</li>
<li><code>Q</code> - 退出</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">more README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从第10行开始显示</span></span><br><span class="line">more +10 README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示查看进度</span></span><br><span class="line">more -d README.md <span class="comment"># --More--(17%)[Press space to continue, &#x27;q&#x27; to quit.]</span></span><br></pre></td></tr></table></figure>

<h2 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h2><p>周期性执行任务, 通常用于定时备份。</p>
<p><code>* * * * *</code> 分别含义：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">*    *    *    *    *</span><br><span class="line">┬    ┬    ┬    ┬    ┬</span><br><span class="line">│    │    │    │    │</span><br><span class="line">│    │    │    │    │</span><br><span class="line">│    │    │    │    └───── 一周中的某一天 (0 - 7)  0或7代表是星期日</span><br><span class="line">│    │    │    └────────── 月份 (1 - 12)</span><br><span class="line">│    │    └─────────────── 一个月的某一天 (1 - 31)</span><br><span class="line">│    └──────────────────── 小时 (0 - 23)</span><br><span class="line">└───────────────────────── 分钟 (0 - 59)</span><br><span class="line"><span class="comment"># 列出该用户设置</span></span><br><span class="line">crontab -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑该用户设置</span></span><br><span class="line">crontab -e</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除该用户设置</span></span><br><span class="line">crontab -r</span><br><span class="line">* * * * * 命令</span><br><span class="line"><span class="comment"># 每天18点18分执行 echo `date` &gt; README.md</span></span><br><span class="line">18 18 * * * <span class="built_in">echo</span> `date` &gt; README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每一分钟执行</span></span><br><span class="line">* * * * */1 <span class="built_in">echo</span> `date` &gt; README.md</span><br></pre></td></tr></table></figure>

<h2 id="man"><a href="#man" class="headerlink" title="man"></a>man</h2><p>查看指令帮助手册</p>
<p><strong>man 信息说明</strong></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>NAME</td>
<td>显示命令名和一段简短的描述</td>
</tr>
<tr>
<td>SYNOPSIS</td>
<td>命令的语法</td>
</tr>
<tr>
<td>CONFI GURATION</td>
<td>命令配置信息</td>
</tr>
<tr>
<td>DESCRIPTION</td>
<td>命令的一般性描述</td>
</tr>
<tr>
<td>OPTIONS</td>
<td>命令选项描述</td>
</tr>
<tr>
<td>EXIT STATUS</td>
<td>命令的退出状态指示</td>
</tr>
<tr>
<td>RETURN VALUE</td>
<td>命令的返回值</td>
</tr>
<tr>
<td>ERRORS</td>
<td>命令的错误消息</td>
</tr>
<tr>
<td>ENVIRONMENT</td>
<td>描述所使用的环境变量</td>
</tr>
<tr>
<td>FILES</td>
<td>命令用到的文件</td>
</tr>
<tr>
<td>VERSIONS</td>
<td>命令的版本信息</td>
</tr>
<tr>
<td>CONFORMING TO</td>
<td>命令所遵从的标准</td>
</tr>
<tr>
<td>NOTES</td>
<td>其他有帮助的资料</td>
</tr>
<tr>
<td>BUGS</td>
<td>提供提交BUG的途径</td>
</tr>
<tr>
<td>EXAMPLE</td>
<td>展示命令的用法</td>
</tr>
<tr>
<td>AUTHORS</td>
<td>命令开发人员的信息</td>
</tr>
<tr>
<td>COPYRIGHT</td>
<td>命令源代码的版权状况</td>
</tr>
<tr>
<td>SEE ALSO</td>
<td>与该命令类型的其他命令</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 ls 指令帮助手册</span></span><br><span class="line">man ls</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以通过数字来阅读某一部分内容, 比如阅读第一部分</span></span><br><span class="line">man 1 ls</span><br><span class="line"></span><br><span class="line"><span class="comment"># -a 在所有手册中查找</span></span><br><span class="line">man -a ls</span><br><span class="line"></span><br><span class="line"><span class="comment"># -k, 搜索关键字, 如果忘记了完整的命令可以通过关键字搜索出来，比如 nginx</span></span><br><span class="line">man -k ngi</span><br></pre></td></tr></table></figure>

<h2 id="sleep"><a href="#sleep" class="headerlink" title="sleep"></a>sleep</h2><p>将目前动作延迟一段时间, 通常用于脚本当中</p>
<p>时间参数, 这是可选的，默认s：</p>
<ul>
<li>s 秒</li>
<li>m 分钟</li>
<li>h 小时</li>
<li>d 天</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5秒后输出 Hello</span></span><br><span class="line">sleep 5s; <span class="built_in">echo</span> Hello</span><br></pre></td></tr></table></figure>

<p>下面是一段 Shell 脚本， 延迟10秒后再去请求</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">sleep 10s</span><br><span class="line"></span><br><span class="line">curl https://www.xiejiahe.com/</span><br></pre></td></tr></table></figure>

<h2 id="source"><a href="#source" class="headerlink" title="source"></a>source</h2><p>在当前Shell环境中从指定文件读取和执行命令， 通常用于重新执行环境。</p>
<p>别名 <code>.</code> 点符号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bash_profile  <span class="comment"># 等价 . ~/.bash_profile</span></span><br></pre></td></tr></table></figure>

<h2 id="paste"><a href="#paste" class="headerlink" title="paste"></a>paste</h2><p>合并N个文件的列，相当于追加文件内容。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.txt 和 2.txt 合并输出</span></span><br><span class="line">paste 1.txt 2.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.txt 2.txt 合并后保存为 3.txt</span></span><br><span class="line">paste 1.txt 2.txt &gt; 3.txt</span><br></pre></td></tr></table></figure>

<h2 id="stat"><a href="#stat" class="headerlink" title="stat"></a>stat</h2><p>用于显示文件或目录的状态信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stat</span> logs</span><br><span class="line"><span class="comment"># File: ‘logs/’</span></span><br><span class="line"><span class="comment"># Size: 16384           Blocks: 32         IO Block: 4096   directory</span></span><br><span class="line"><span class="comment"># Device: fd01h/64769d    Inode: 669067      Links: 5</span></span><br><span class="line"><span class="comment"># Access: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)</span></span><br><span class="line"><span class="comment"># Access: 2020-07-07 17:24:23.941816812 +0800</span></span><br><span class="line"><span class="comment"># Modify: 2020-07-12 11:46:55.567707577 +0800</span></span><br><span class="line"><span class="comment"># Change: 2020-07-12 11:46:55.567707577 +0800</span></span><br><span class="line"><span class="comment"># Birth: -</span></span><br></pre></td></tr></table></figure>

<h2 id="tree"><a href="#tree" class="headerlink" title="tree"></a>tree</h2><p>生成目录树结构, 通常用于描述项目结构。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 递归当前目录下所有文件并生成目录树</span></span><br><span class="line">tree</span><br><span class="line"><span class="comment"># .</span></span><br><span class="line"><span class="comment"># ├── LICENSE</span></span><br><span class="line"><span class="comment"># ├── README.md</span></span><br><span class="line"><span class="comment"># ├── b.md</span></span><br><span class="line"><span class="comment"># └── media</span></span><br><span class="line"><span class="comment">#     └── poster.jpg</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -I 忽略某些目录</span></span><br><span class="line">tree -I <span class="string">&quot;node_modules|.git|.svn&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只显示目录</span></span><br><span class="line">tree -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定要递归的目录层级</span></span><br><span class="line">tree -L 3</span><br></pre></td></tr></table></figure>

<h2 id="yum"><a href="#yum" class="headerlink" title="yum"></a>yum</h2><p>基于RPM的软件包管理器, 特点安装快捷，命令简洁好记。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装nginx</span></span><br><span class="line">yum install nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定 -y 安装时自动全部 yes</span></span><br><span class="line">yum -y install nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找包</span></span><br><span class="line">yum search nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有已安装的包</span></span><br><span class="line">yum list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 升级包</span></span><br><span class="line">yum -y update nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除包</span></span><br><span class="line">yum -y remove nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清除缓存</span></span><br><span class="line">yum clean all</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示安装包信息</span></span><br><span class="line">yum info nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查可更新的包程序</span></span><br><span class="line">yum check-update</span><br></pre></td></tr></table></figure>

<h2 id="history"><a href="#history" class="headerlink" title="history"></a>history</h2><p>列出当前系统使用过的命令，默认保存1000条, 通常保存在 <code>~/.bash_history</code> 文件中，注意的是只有在Shell退出时才写入到文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出当前使用过的命令</span></span><br><span class="line"><span class="built_in">history</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定要显示的条数</span></span><br><span class="line"><span class="built_in">history</span> 50</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清空历史命令</span></span><br><span class="line"><span class="built_in">history</span> -c</span><br><span class="line"></span><br><span class="line"><span class="comment"># -a 强制写入到 ~/.bash_history 文件中而不用等shell退出才写入</span></span><br><span class="line"><span class="built_in">history</span> -a</span><br></pre></td></tr></table></figure>

<h2 id="md5sum"><a href="#md5sum" class="headerlink" title="md5sum"></a>md5sum</h2><p>计算和校验文件报文摘要</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算文件md5</span></span><br><span class="line">mmd5sum README.md <span class="comment"># d41d8cd98f00b204e9800998ecf8427e  README.md</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 校验文件, 查看文件是否被篡改过</span></span><br><span class="line">md5sum README.md &gt; README.md5 <span class="comment"># 计算文件md5并保存在 README.md5 , 保存的文件名和后缀可以随意命名</span></span><br><span class="line">md5sum -c README.md5 <span class="comment"># -c 从指定的文件读取md5并校验, 会从当前目录寻找 README.md</span></span><br></pre></td></tr></table></figure>

<h2 id="su"><a href="#su" class="headerlink" title="su"></a>su</h2><p>切换到其他用户。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换到 admin 身份</span></span><br><span class="line">su admin</span><br><span class="line"></span><br><span class="line"><span class="comment"># -c 执行完指令后切换回原身份</span></span><br><span class="line">su -c ls admin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以通过以下查找当前系统用户列表</span></span><br><span class="line">cat /etc/passwd</span><br></pre></td></tr></table></figure>

<h2 id="xargs"><a href="#xargs" class="headerlink" title="xargs"></a>xargs</h2><p>给命令传递参数的一个过滤器，也是组合多个命令的一个工具, <code>将左侧的标准输出放进右侧标准输入</code>。</p>
<p>此命令可以将多次操作简便为一次操作。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计代码</span></span><br><span class="line">find -name <span class="string">&quot;*.js&quot;</span> | xargs wc -l <span class="comment"># 等价于 wc -l a.js b.js c.js ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量下载文件</span></span><br><span class="line">cat download.txt | xargs wget</span><br></pre></td></tr></table></figure>

<h2 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h2><p>加密的方式在本地主机和远程主机之间复制文件</p>
<p>注：需要有读写权限，否则会无法操作。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从远程主机下载文件到本地</span></span><br><span class="line">scp root@192.168.0.100:/root/file.zip /home/file.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从远程主机下载目录到本地，需要 -r 递归</span></span><br><span class="line">scp -r root@192.168.0.100:/root/dir  /home/dir</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从本地主机上传文件到远程主机</span></span><br><span class="line">scp /home/file.zip root@192.168.0.100:/root/file.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 从本地主机上传目录到远程主机，需要 -r 递归</span></span><br><span class="line">scp -r /home/dir root@192.168.0.100:/root/dir</span><br></pre></td></tr></table></figure>

<h2 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h2><p>强大的文本搜索工具，被称为Linux命令三剑客。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从 README.md 文件中搜索 linux 关键字</span></span><br><span class="line">grep <span class="string">&quot;linux&quot;</span> README.md</span><br><span class="line">grep <span class="string">&quot;linux&quot;</span> README.md README2.md <span class="comment"># 多个文件搜索</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出时高亮显示</span></span><br><span class="line">grep <span class="string">&quot;linux&quot;</span> README.md --color</span><br><span class="line"></span><br><span class="line"><span class="comment"># -o 只输出匹配部分</span></span><br><span class="line">grep -o <span class="string">&quot;linux&quot;</span> README.md --color</span><br><span class="line"></span><br><span class="line"><span class="comment"># -n 输出到匹配的行数</span></span><br><span class="line">grep -n <span class="string">&quot;linux&quot;</span> README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -c 输出到匹配次数</span></span><br><span class="line">grep -c <span class="string">&quot;linux&quot;</span> README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -r 递归目录文件搜索</span></span><br><span class="line">grep -r <span class="string">&quot;linux&quot;</span> ./src</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 glob 风格表达式搜索</span></span><br><span class="line">egrep <span class="string">&quot;[0-9]&quot;</span> <span class="comment"># 等价于 grep -E &quot;[0-9]&quot; README.md</span></span><br></pre></td></tr></table></figure>

<h2 id="systemctl"><a href="#systemctl" class="headerlink" title="systemctl"></a>systemctl</h2><p>系统服务管理器指令, 通常用来设置某个服务器默认开机启动或关闭。</p>
<p>命令：<code>systemctl [command] [unit]</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 立即启动服务</span></span><br><span class="line">systemctl start nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 立即停止服务</span></span><br><span class="line">systemctl stop nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启服务，stop 后 start</span></span><br><span class="line">systemctl restart nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新载入服务, 一般情况下重新载入新的配置</span></span><br><span class="line">systemctl reload nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下次开机时默认启动服务</span></span><br><span class="line">systemctl <span class="built_in">enable</span> nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下次开机时不会启动服务</span></span><br><span class="line">systemctl <span class="built_in">disable</span> nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看某个服务状态信息</span></span><br><span class="line">systemctl status nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前服务是否正在运行中</span></span><br><span class="line">systemctl is-active nginx.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务开机有没有默认启动</span></span><br><span class="line">systemctl is-enable nginx.service</span><br></pre></td></tr></table></figure>

<h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><p>base64 编码/解码文件或标准输入输出</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编码字符串</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;hello world&quot;</span>|base64 <span class="comment"># aGVsbG8gd29ybGQ=</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解码字符串</span></span><br><span class="line"><span class="built_in">printf</span> aGVsbG8gd29ybGQ=|base64 -d <span class="comment"># hello world</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编码文件, 将结果保存在 decode.txt</span></span><br><span class="line">base64 README.md &gt; decode.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从标准输入中读取已经进行base64编码的内容进行解码</span></span><br><span class="line">base64 -d decode.txt</span><br></pre></td></tr></table></figure>

<h2 id="ln"><a href="#ln" class="headerlink" title="ln"></a>ln</h2><p>将某一个文件在另外一个位置建立并产生同步的链接。 当不同的2个目录需要同时引用某一个文件时此命令就派上用场了。</p>
<p>软链接也可以叫符号链接：</p>
<ul>
<li>软链接，以路径的形式存在。类似于Windows操作系统中的快捷方式</li>
<li>软链接可以 跨文件系统 ，硬链接不可以</li>
<li>软链接可以对一个不存在的文件名进行链接</li>
<li>软链接可以对目录进行链接</li>
</ul>
<p>硬链接：</p>
<ul>
<li>硬链接，以文件副本的形式存在。但不占用实际空间, 从根本上而言就是同一个文件。</li>
<li>不允许给目录创建硬链接</li>
<li>硬链接只有在同一个文件系统中才能创建</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认创建硬链接，修改 README.md 内容， a.md 也会同步修改, 修改a.md  README.md 也会同步修改</span></span><br><span class="line">ln README.md a.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># -s 创建软链接</span></span><br><span class="line">ln -s README.md a.md <span class="comment"># 如果删除了 README.md  a.md 将失效</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -f 强制执行</span></span><br><span class="line">ln -f README.md ./src/a.md</span><br></pre></td></tr></table></figure>

<h2 id="service"><a href="#service" class="headerlink" title="service"></a>service</h2><p>管理操作系统服务的命令, 是Redhat Linux兼容的发行版中用来控制系统服务的实用工具，它以启动、停止、重新启动和关闭系统服务，还可以显示所有系统服务的当前状态。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动 docker 服务</span></span><br><span class="line">service docker start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 docker 状态</span></span><br><span class="line">service docker status</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止 docker 服务</span></span><br><span class="line">service docker stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新启动 docker 服务</span></span><br><span class="line">service docker restart</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有服务状态</span></span><br><span class="line">service --status-all</span><br></pre></td></tr></table></figure>

<h2 id="free"><a href="#free" class="headerlink" title="free"></a>free</h2><p>显示内存使用情况</p>
<p>选项</p>
<ul>
<li>b 字节单位显示</li>
<li>k KB单位显示</li>
<li>m MB单位显示</li>
<li>g GB单位显示</li>
<li>s&lt;秒&gt; 每S秒监控内存使用情况</li>
</ul>
<p>解释：</p>
<ul>
<li>total 内存总数</li>
<li>used 已使用内存</li>
<li>free 空闲内存</li>
<li>shared 当前已废弃内存</li>
<li>buff/cache 缓存内存数</li>
<li>1204660 可用内存数</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">free</span><br><span class="line"><span class="comment"># 输出以下, 默认以字节为单位</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:        1882192      485312      448424         704      948456     1204660</span><br><span class="line">Swap:             0           0           0</span><br><span class="line"></span><br><span class="line"><span class="comment"># MB单位显示</span></span><br><span class="line">free - m</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10秒执行一次查询</span></span><br><span class="line">free -s 10</span><br></pre></td></tr></table></figure>

<h2 id="apt-get"><a href="#apt-get" class="headerlink" title="apt-get"></a>apt-get</h2><p><strong>apt-get命令</strong> 是Debian Linux发行版中的APT软件包管理工具。所有基于Debian的发行都使用这个包管理系统。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装一个docker软件</span></span><br><span class="line">apt-get install docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 卸载软件，保留配置文件</span></span><br><span class="line">apt-get remove docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 卸载软件并删除配置文件</span></span><br><span class="line">apt-get –purge remove docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新所有已安装的软件包</span></span><br><span class="line">apt-get upgrade</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除软件备份，主要用来释放空间</span></span><br><span class="line">apt-get clean</span><br></pre></td></tr></table></figure>

<h2 id="file"><a href="#file" class="headerlink" title="file"></a>file</h2><p>查看文件类型, 比如文件、目录、二进制、符号链接等</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出 README.md: ASCII text</span></span><br><span class="line">file README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># index.html: HTML document, UTF-8 Unicode text, with very long lines, with no line terminators</span></span><br><span class="line">file index.html</span><br></pre></td></tr></table></figure>

<h2 id="jobs"><a href="#jobs" class="headerlink" title="jobs"></a>jobs</h2><p>显示当前运行在后台模式中的所有用户的进程（作业）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先来启一个后台进程, 比如启一个sleep命令进程， &amp; 符号表示后台运行</span></span><br><span class="line">sleep 3 &amp;</span><br><span class="line"><span class="comment"># 查看后台进程</span></span><br><span class="line"><span class="built_in">jobs</span> <span class="comment"># 输出：[1]+  Running       sleep 3 &amp;</span></span><br></pre></td></tr></table></figure>

<h2 id="type"><a href="#type" class="headerlink" title="type"></a>type</h2><p><code>type</code> 命令有2个作用：</p>
<ul>
<li>用来查找命令的位置，类似 which 命令</li>
<li>检测某个命令是内建命令还是外部命令</li>
</ul>
<p>普及：内建命令和外部命令的区别：内建命令不会衍生出子进程，而外部命令会衍生出一个子进程然后执行命令, 所以内建命令执行效率要高。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd is a shell builtin  表示这是shell内建命令</span></span><br><span class="line"><span class="built_in">type</span> <span class="built_in">cd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ps is hashed (/usr/bin/ps)  表示这是一个外部命令</span></span><br><span class="line"><span class="built_in">type</span> ps</span><br></pre></td></tr></table></figure>

<h2 id="printenv"><a href="#printenv" class="headerlink" title="printenv"></a>printenv</h2><p>列出全局环境变量, 有个 <code>env</code> 命令很像，但 <code>printenv</code> 可以打印变量的值。</p>
<p>普及：所有系统环境变量都是大写字母，用于区分普通用户的环境变量。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出所有全局环境变量</span></span><br><span class="line">printenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以显示指定全局环境变量的值, 等价于 echo $HOME</span></span><br><span class="line">printenv HOME <span class="comment"># /root</span></span><br></pre></td></tr></table></figure>

<h2 id="set"><a href="#set" class="headerlink" title="set"></a>set</h2><p>列出所有全局变量、局部变量和普通用户定义的变量，按照字母顺序对结果进行排序。</p>
<p>注意：所有系统全局变量都是大写，用户定义的环境变量全部采用小写，这是标准规范。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span></span><br><span class="line"><span class="comment"># OPTIND=1</span></span><br><span class="line"><span class="comment"># OSTYPE=linux-gnu</span></span><br><span class="line"><span class="comment"># PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span></span><br><span class="line"><span class="comment"># PIPESTATUS=([0]=&quot;0&quot;)</span></span><br><span class="line"><span class="comment"># ...</span></span><br></pre></td></tr></table></figure>

<h2 id="export"><a href="#export" class="headerlink" title="export"></a>export</h2><p>导出环境变量, 可以把一个局部变量导出成全局环境变量</p>
<p>注意：export 只有在当前Shell有效，退出后将失效</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先声明一个局部环境变量</span></span><br><span class="line">my_var=<span class="string">&#x27;Hello&#x27;</span></span><br><span class="line"><span class="comment"># 然后将其导出全局环境变量</span></span><br><span class="line"><span class="built_in">export</span> my_var</span><br></pre></td></tr></table></figure>

<h2 id="unset"><a href="#unset" class="headerlink" title="unset"></a>unset</h2><p>删除环境变量</p>
<p>注意：unset 只在当前shell删除环境变量，假如环境变量设置在 <code>~/.bash_profile</code> 等文件中用户重新启动依然生效。如果是在子进程删除全局环境变量只在子进程有效，不会影响父进程。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除 HOME 环境变量，前面不需要带 $ 符号</span></span><br><span class="line"><span class="built_in">unset</span> HOME</span><br></pre></td></tr></table></figure>

<h2 id="useradd"><a href="#useradd" class="headerlink" title="useradd"></a>useradd</h2><p>给系统添加新用户</p>
<p>注：</p>
<ul>
<li>在创建新用户时如果不指定具体的值，就会使用系统那些默认值。</li>
<li>在创建新用户时如果未指定密码，需要使用 <code>passwd</code> 命令进行更改。</li>
</ul>
<h4 id="useradd-命令行参数"><a href="#useradd-命令行参数" class="headerlink" title="useradd 命令行参数"></a>useradd 命令行参数</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>-c comment</td>
<td>给新用户添加备注</td>
</tr>
<tr>
<td>-d home_dir</td>
<td>为主目录指定一个名字（如果不想用登录名作为主目录名的话）</td>
</tr>
<tr>
<td>-e expire_date</td>
<td>用YYYY-MM-DD格式指定一个账户过期的日期</td>
</tr>
<tr>
<td>-f inactive_days</td>
<td>指定这个账户密码过期后多少天这个账户被禁用；0表示密码已过期就立即禁用，1表示禁用这个功能</td>
</tr>
<tr>
<td>-g initial_group</td>
<td>指定用户登录组的GID或组名</td>
</tr>
<tr>
<td>-G group</td>
<td>指定用户除登录组之外所属的一个或多个附加组</td>
</tr>
<tr>
<td>-k</td>
<td>必须和-m一起使用，将/etc/skel目录的内容复制到用户的HOME目录</td>
</tr>
<tr>
<td>-m</td>
<td>创建用户的HOME目录</td>
</tr>
<tr>
<td>-M</td>
<td>不创建用户的HOME目录（当默认设置里要求创建时才使用这个选项）</td>
</tr>
<tr>
<td>-n</td>
<td>创建一个与用户登录名同名的新租</td>
</tr>
<tr>
<td>-r</td>
<td>创建系统账户</td>
</tr>
<tr>
<td>-p passwd</td>
<td>为用户账户指定默认密码 (需要使用openssl把明文进行加密后设置，否则无效)</td>
</tr>
<tr>
<td>-s shell</td>
<td>指定默认的登录shell</td>
</tr>
<tr>
<td>-u uid</td>
<td>为账户指定唯一的UID</td>
</tr>
</tbody></table>
<h4 id="更改默认值参数"><a href="#更改默认值参数" class="headerlink" title="更改默认值参数"></a>更改默认值参数</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>-b default_home</td>
<td>更改默认的创建用户HOME目录的位置</td>
</tr>
<tr>
<td>-e expiration_date</td>
<td>更改默认的心账户的过期日期</td>
</tr>
<tr>
<td>-f inactive</td>
<td>更改默认的心用户从密码过期到账户被禁用的天数</td>
</tr>
<tr>
<td>-g group</td>
<td>更改默认的组名称或GID</td>
</tr>
<tr>
<td>-s shell</td>
<td>更改默认的登录shell</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -D, 查看默认值</span></span><br><span class="line">useradd -D</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line">GROUP=100                <span class="comment"># 新用户会被添加到GID为100的公共组</span></span><br><span class="line">HOME=/home               <span class="comment"># 新用户的HOME目录将位于 /home/loginname</span></span><br><span class="line">INACTIVE=-1              <span class="comment"># 新用户账户密码在过期后不会被禁用</span></span><br><span class="line">EXPIRE=                  <span class="comment"># 新用户账户未被设置过期日期</span></span><br><span class="line">SHELL=/bin/bash          <span class="comment"># 新用户账户将bash shell作为默认shell</span></span><br><span class="line">SKEL=/etc/skel           <span class="comment"># 系统会将/etc/skel目录下的内容复制到用户的HOME目录下</span></span><br><span class="line">CREATE_MAIL_SPOOL=yes    <span class="comment"># 系统为该用户账户在mail目录下创建一个用于接收邮件的文件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个 test 用户, -m 创建 /home/test 目录</span></span><br><span class="line">useradd -m <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个用户并设置密码</span></span><br><span class="line">useradd -m <span class="built_in">test</span> <span class="comment"># 不指定-p，因为需要加密那样很麻烦</span></span><br><span class="line">passwd <span class="built_in">test</span> <span class="comment"># 通过passwd修改指定用户密码</span></span><br></pre></td></tr></table></figure>

<p>添加新用户后可以执行 <code>cat /etc/passwd</code> 查看用户列表。</p>
<h2 id="userdel"><a href="#userdel" class="headerlink" title="userdel"></a>userdel</h2><p>删除用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除用户，默认会从 /etc/passwd 文件中删除用户信息，而不会删除系统中属于该账户的任何文件</span></span><br><span class="line">userdel 用户名</span><br><span class="line"></span><br><span class="line"><span class="comment"># -r 用来删除用户目录， 之前创建的 /home/用户名 就不存在了, 使用-r参数需要小心，要检查是否有重要文件。</span></span><br><span class="line">userdel -r 用户名</span><br></pre></td></tr></table></figure>

<h2 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h2><p>修改用户密码, 只有 <code>root</code> 用户才有权限修改别人的密码。</p>
<p>使用 <code>passwd</code> 一般用于修改单个用户密码，如果想批量修改那么需要 <code>chpasswd</code> 命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果不指定用户名，修改的是自己当前用户密码， 回车后输入新密码</span></span><br><span class="line">passwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改指定用户密码，比如test用户</span></span><br><span class="line">passwd <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<h2 id="chpasswd"><a href="#chpasswd" class="headerlink" title="chpasswd"></a>chpasswd</h2><p>类似 <code>passwd</code> 命令也是用于修改用户密码，但它支持批量修改用户。</p>
<p><code>chpasswd</code> 命令从标准输入自动读取登录名和密码对（由冒号分割）列表，给密码加密。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用输入重定向从文本中读取</span></span><br><span class="line">chpasswd &lt; users.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从标准输入读取</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;test:fff33300..a&#x27;</span> | chpasswd</span><br></pre></td></tr></table></figure>

<p>user.txt 内容：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test:helloworld0123..</span><br><span class="line">test1:fff33300..</span><br><span class="line">admin:youyouyou00..11</span><br></pre></td></tr></table></figure>

<h2 id="chsh"><a href="#chsh" class="headerlink" title="chsh"></a>chsh</h2><p>修改默认用户登录 shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 必须使用完整路径，不能使用shell名</span></span><br><span class="line">chsh -s /bin/sh</span><br></pre></td></tr></table></figure>

<h2 id="users"><a href="#users" class="headerlink" title="users"></a>users</h2><p>显示当前登录系统的所有用户的用户列表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">users</span><br><span class="line"><span class="comment"># xiejiahe</span></span><br><span class="line"><span class="comment"># root</span></span><br><span class="line"><span class="comment"># admin</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h2><p>感谢 《Linux命令行与Shell脚本编程大全》 一书，以上部分命令从这本书进行整理出来， 如有错误，欢迎指正，谢谢！</p>
<p><a href="#">⬆ 回顶部</a></p>

               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-log-drive一次 java.io.IOException Connection reset by peer 故障排查" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/f85e694a.html" class="article-date">
      <time datetime="2021-03-14T00:29:46.000Z" itemprop="datePublished">2021-03-14</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/f85e694a.html">log-drive一次 java.io.IOException Connection reset by peer 故障排查</a>
    </h1>
  

      </header>
      
    
        <div class="article-entry" itemprop="articleBody">
          
                
                            
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                                  
                            
                                
                                <p><p>转载地址: <a target="_blank" rel="noopener" href="https://mengkang.net/1118.html">https://mengkang.net/1118.html</a></p>
<p>我的弹幕服务，代码换了个环境运行，虽然服务可用，但是发现出现了如下情况，基本1秒输出来一次：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">java.io.IOException: Connection reset by peer</span><br><span class="line">  at sun.nio.ch.FileDispatcherImpl.read0(Native Method)</span><br><span class="line">  at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)</span><br><span class="line">  at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)</span><br><span class="line">  at sun.nio.ch.IOUtil.read(IOUtil.java:192)</span><br><span class="line">  at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)</span><br><span class="line">  at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:311)</span><br><span class="line">  at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:853)</span><br><span class="line">  at io.netty.buffer.WrappedByteBuf.writeBytes(WrappedByteBuf.java:641)</span><br><span class="line">  at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:240)</span><br><span class="line">  at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:115)</span><br><span class="line">  at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:514)</span><br><span class="line">  at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:471)</span><br><span class="line">  at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:385)</span><br><span class="line">  at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:351)</span><br><span class="line">  at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1412)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinTask.doExec(ForkJoinTask.java:280)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:877)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinPool.scan(ForkJoinPool.java:1706)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinPool.runWorker(ForkJoinPool.java:1661)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:126)</span><br></pre></td></tr></table></figure>
<p>
                              
                          
                    
              <!-- 
              
              <p>转载地址: <a target="_blank" rel="noopener" href="https://mengkang.net/1118.html">https://mengkang.net/1118.html</a></p>
<p>我的弹幕服务，代码换了个环境运行，虽然服务可用，但是发现出现了如下情况，基本1秒输出来一次：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">java.io.IOException: Connection reset by peer</span><br><span class="line">  at sun.nio.ch.FileDispatcherImpl.read0(Native Method)</span><br><span class="line">  at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)</span><br><span class="line">  at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)</span><br><span class="line">  at sun.nio.ch.IOUtil.read(IOUtil.java:192)</span><br><span class="line">  at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)</span><br><span class="line">  at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:311)</span><br><span class="line">  at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:853)</span><br><span class="line">  at io.netty.buffer.WrappedByteBuf.writeBytes(WrappedByteBuf.java:641)</span><br><span class="line">  at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:240)</span><br><span class="line">  at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:115)</span><br><span class="line">  at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:514)</span><br><span class="line">  at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:471)</span><br><span class="line">  at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:385)</span><br><span class="line">  at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:351)</span><br><span class="line">  at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1412)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinTask.doExec(ForkJoinTask.java:280)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:877)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinPool.scan(ForkJoinPool.java:1706)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinPool.runWorker(ForkJoinPool.java:1661)</span><br><span class="line">  at io.netty.util.internal.chmv8.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:126)</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/netty/netty/issues/5936">https://github.com/netty/netty/issues/5936</a><br><code>Connection reset by peer</code> is typically a result of your peer sending a TCP RST to you.</p>
</blockquote>
<h1 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h1><p>既然是网络故障，tcpdump 是否可用呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$sudo netstat -lnp|grep 8657</span><br><span class="line">tcp        0      0 0.0.0.0:443                 0.0.0.0:*                   LISTEN      8657&#x2F;java</span><br></pre></td></tr></table></figure>

<p>没有列出全部的 socket 连接，从当前进程监听的端口入手试试。<code>ifconfig</code>可以看到这台机器有两个网卡（eth0 内网 ip，eth1 公网 ip）。</p>
<h2 id="tcpdump-下的-tcp-ip-协议解析"><a href="#tcpdump-下的-tcp-ip-协议解析" class="headerlink" title="tcpdump 下的 tcp/ip 协议解析"></a>tcpdump 下的 tcp/ip 协议解析</h2><p>先看下 tcpdump 输出tcp/ip 数据的大致格式</p>
<blockquote>
<p>参考 <a target="_blank" rel="noopener" href="http://www.tcpdump.org/tcpdump_man.html">http://www.tcpdump.org/tcpdump_man.html</a> 中关于 tcp 协议的描述，我整理了下格式</p>
</blockquote>
<p>The general format of a TCP protocol line is</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src &gt; dst: Flags [tcpflags], seq data-seqno, ack ackno, win window, urg urgent, options [opts], length len</span><br></pre></td></tr></table></figure>

<ol>
<li><code>src</code> and <code>dst</code> are the source and destination IP addresses and ports.</li>
<li><code>tcpflags</code> are some combination of <code>S</code> (SYN), <code>F</code> (FIN), <code>P</code> (PUSH), <code>R</code> (RST), <code>U</code> (URG), <code>W</code> (ECN CWR), <code>E</code> (ECN-Echo) or <code>.</code> (ACK), or <code>none</code> if no flags are set.</li>
<li><code>data-seqno</code> describes the portion of sequence space covered by the data in this packet.</li>
<li><code>ackno</code> is sequence number of the next data expected the other direction on this connection.</li>
<li><code>window</code> is the number of bytes of receive buffer space available the other direction on this connection.</li>
<li><code>urg</code> indicates there is <code>urgent</code> data in the packet.</li>
<li><code>opts</code> are TCP options (e.g., mss 1024).</li>
<li><code>len</code> is the length of payload data.</li>
</ol>
<h2 id="抓包数据"><a href="#抓包数据" class="headerlink" title="抓包数据"></a>抓包数据</h2><p>通过<code>tcpdump</code>查看下443 端口的网络情况。与上面的格式略有不同。因为我有两个网卡，请求是从 eth0 进，从 eth1 出，我尝试使用<code>tcpdump -i any</code> 发现第三次握手输出的 askno 数据不对。（<strong>为什么会这样呢，还不知道，谁知道请告知下</strong>）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$sudo tcpdump -i any -nn port 443</span><br><span class="line"></span><br><span class="line">16:18:41.553460 IP xxx.xxx.238.110.5745 &gt; xxx.xxx.198.40.443: S 806033:806033(0) win 14600 &lt;mss 1460,sackOK,timestamp 2230744217 0,nop,wscale 8&gt;</span><br><span class="line">16:18:41.553483 IP xxx.xxx.198.40.443 &gt; xxx.xxx.238.110.5745: S 1720728675:1720728675(0) ack 806034 win 14480 &lt;mss 1460,sackOK,timestamp 2425389802 2230744217,nop,wscale 7&gt;</span><br><span class="line">16:18:41.553647 IP xxx.xxx.238.110.5745 &gt; xxx.xxx.198.40.443: . ack 1 win 58 &lt;nop,nop,timestamp 2230744217 2425389802&gt;</span><br><span class="line">16:18:41.553677 IP xxx.xxx.238.110.5745 &gt; xxx.xxx.198.40.443: R 1:1(0) ack 1 win 58 &lt;nop,nop,timestamp 2230744217 2425389802&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>但是如果你要导出<code>*.pcap</code>文件然后用<code>wireshark</code>来查看，还是得将两个网卡的流量合并到一起才行。</p>
</blockquote>
<p>两个网卡分开抓</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 合并到一起写</span><br><span class="line">$sudo tcpdump -i eth0 -nn port 443</span><br><span class="line">$sudo tcpdump -i eth1 -nn port 443</span><br><span class="line"></span><br><span class="line">16:51:16.073956 IP xxx.xxx.238.2.61835 &gt; xxx.xxx.198.40.443: S 2659415794:2659415794(0) win 14600 &lt;mss 1460,sackOK,timestamp 2328745293 0,nop,wscale 8&gt;</span><br><span class="line">16:51:16.073985 IP xxx.xxx.198.40.443 &gt; xxx.xxx.238.2.61835: S 955422999:955422999(0) ack 2659415795 win 14480 &lt;mss 1460,sackOK,timestamp 2427344323 2328745293,nop,wscale 7&gt;</span><br><span class="line">16:51:16.074147 IP xxx.xxx.238.2.61835 &gt; xxx.xxx.198.40.443: . ack 955423000 win 58 &lt;nop,nop,timestamp 2328745293 2427344323&gt;</span><br><span class="line">16:51:16.074192 IP xxx.xxx.238.2.61835 &gt; xxx.xxx.198.40.443: R 0:0(0) ack 1 win 58 &lt;nop,nop,timestamp 2328745293 2427344323&gt;</span><br></pre></td></tr></table></figure>

<p>上面的握手比较简单对应着</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">时间 协议 src &gt; dst tcpflags data-seqno ack ackno win window &lt;opts&gt;</span><br></pre></td></tr></table></figure>

<h2 id="握手逻辑"><a href="#握手逻辑" class="headerlink" title="握手逻辑"></a>握手逻辑</h2><p>一次连接建立的三次握手的步骤：</p>
<ol>
<li>Caller sends SYN</li>
<li>Recipient responds with SYN, ACK</li>
<li>Caller sends ACK</li>
</ol>
<h2 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h2><ol>
<li>src 发送的 tcpflags = S，也就是说发送的SYN请求，随机产生一个值 data-seqno = J(<code>2659415794</code>)，并将该数据包发送给 dst</li>
<li>dst 发送的 tcpflags = S，实际发送的时候 SYN 和 ACK 标志位都置1了，返回一个 ackno=<code>J</code> + 1，也就是<code>2659415795</code>，然后随机生成一个新的 data-seqno = K(<code>955422999</code>) 发送给 src</li>
<li>src 检查收到的 ackno 是不是等于<code>J</code>+<code>1</code>，然后再发送一个 ackno = <code>K</code>+1，也就是<code>955423000</code>，前面的文档中说道<code>tcpflags</code>为<code>.</code>的时候也表示<code>ACK</code></li>
<li>src 最后为什么又给 dst 发送一个 tcpflags = R 的请求呢？</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://mengkang.net/upload/image/2017/1221/1513846681114601.png"><img src="https://mengkang.net/upload/image/2017/1221/1513846681114601.png" alt="一次 java.io.IOException: Connection reset by peer 故障排查"></a></p>
<h2 id="为什么会出现-RST"><a href="#为什么会出现-RST" class="headerlink" title="为什么会出现 RST"></a>为什么会出现 RST</h2><p>因为具有周期性，我大概猜到了，是 lvs 对我的后端服务的健康检查导致的，联系了网络运营服务客服人员，我把<code>.pcap</code>给他们</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump -i any port 443 -c 3 -w log.pcap</span><br></pre></td></tr></table></figure>

<p>他们确认源地址就是LVS的local地址。<br>健康检查的机制就是建立成功后就 RST 掉，就不占用 session 了。这是公司的规范，问题算是定位了。既然公司的规范，那么我们这边需要定制修改下，针对 vip 发送的 RST 不处理。</p>
<p>其他参考</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/netty/netty/issues/6029">https://github.com/netty/netty/issues/6029</a><br><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc793">https://tools.ietf.org/html/rfc793</a><br><a target="_blank" rel="noopener" href="https://my.oschina.net/costaxu/blog/127394">https://my.oschina.net/costaxu/blog/127394</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>




               -->
        </div>
        
    
    <div class="article-info article-info-index">
      
      

      <!--  -->


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/13/"> 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><a class="page-number" href="/page/16/">16</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/15/">下一页 </a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2025 leek
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by leek <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//lf6-cdn-tos.bytecdntp.com/cdn/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-144246563-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
             tags: ".article-tag a", 
             categories: ".article-category a, a.tag-list-link", 
            
            
            
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "(つェ⊂) 我藏好了哦~ " + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "(*´∇｀*) 被你发现啦~ " + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>